var COMPILED=!0,goog=goog||{};goog.global=this;goog.DEBUG=!0;goog.LOCALE="en";goog.evalWorksForGlobals_=null;goog.provide=function(a){if(!COMPILED){if(goog.getObjectByName(a)&&!goog.implicitNamespaces_[a])throw Error('Namespace "'+a+'" already declared.');for(var b=a;b=b.substring(0,b.lastIndexOf("."));)goog.implicitNamespaces_[b]=!0}goog.exportPath_(a)};COMPILED||(goog.implicitNamespaces_={});
goog.exportPath_=function(a,b,d){a=a.split(".");d=d||goog.global;!(a[0]in d)&&d.execScript&&d.execScript("var "+a[0]);for(var e;a.length&&(e=a.shift());)!a.length&&goog.isDef(b)?d[e]=b:d=d[e]?d[e]:d[e]={}};goog.getObjectByName=function(a,b){for(var d=a.split("."),e=b||goog.global,f;f=d.shift();)if(e[f])e=e[f];else return null;return e};goog.globalize=function(a,b){var d=b||goog.global,e;for(e in a)d[e]=a[e]};
goog.addDependency=function(a,b,d){if(!COMPILED){for(var e,a=a.replace(/\\/g,"/"),f=goog.dependencies_,g=0;e=b[g];g++)f.nameToPath[e]=a,a in f.pathToNames||(f.pathToNames[a]={}),f.pathToNames[a][e]=!0;for(e=0;b=d[e];e++)a in f.requires||(f.requires[a]={}),f.requires[a][b]=!0}};
goog.require=function(a){if(!COMPILED&&!goog.getObjectByName(a)){var b=goog.getPathFromDeps_(a);if(b)goog.included_[b]=!0,goog.writeScripts_();else throw a="goog.require could not find: "+a,goog.global.console&&goog.global.console.error(a),Error(a);}};goog.basePath="";goog.nullFunction=function(){};goog.identityFunction=function(a){return a};goog.abstractMethod=function(){throw Error("unimplemented abstract method");};
goog.addSingletonGetter=function(a){a.getInstance=function(){return a.instance_||(a.instance_=new a)}};
COMPILED||(goog.included_={},goog.dependencies_={pathToNames:{},nameToPath:{},requires:{},visited:{},written:{}},goog.inHtmlDocument_=function(){var a=goog.global.document;return"undefined"!=typeof a&&"write"in a},goog.findBasePath_=function(){if(goog.inHtmlDocument_()){var a=goog.global.document;if(goog.global.CLOSURE_BASE_PATH)goog.basePath=goog.global.CLOSURE_BASE_PATH;else for(var a=a.getElementsByTagName("script"),b=a.length-1;0<=b;--b){var d=a[b].src,e=d.length;if("base.js"==d.substr(e-7)){goog.basePath=
d.substr(0,e-7);break}}}},goog.writeScriptTag_=function(a){goog.inHtmlDocument_()&&!goog.dependencies_.written[a]&&(goog.dependencies_.written[a]=!0,goog.global.document.write('<script type="text/javascript" src="'+a+'"><\/script>'))},goog.writeScripts_=function(){function a(g){if(!(g in e.written)){if(!(g in e.visited)&&(e.visited[g]=!0,g in e.requires))for(var f in e.requires[g])if(f in e.nameToPath)a(e.nameToPath[f]);else if(!goog.getObjectByName(f))throw Error("Undefined nameToPath for "+f);g in
d||(d[g]=!0,b.push(g))}}var b=[],d={},e=goog.dependencies_,f;for(f in goog.included_)e.written[f]||a(f);for(f=0;f<b.length;f++)if(b[f])goog.writeScriptTag_(goog.basePath+b[f]);else throw Error("Undefined script input");},goog.getPathFromDeps_=function(a){return a in goog.dependencies_.nameToPath?goog.dependencies_.nameToPath[a]:null},goog.findBasePath_(),goog.global.CLOSURE_NO_DEPS||goog.writeScriptTag_(goog.basePath+"deps.js"));
goog.typeOf=function(a){var b=typeof a;if("object"==b)if(a){if(a instanceof Array||!(a instanceof Object)&&"[object Array]"==Object.prototype.toString.call(a)||"number"==typeof a.length&&"undefined"!=typeof a.splice&&"undefined"!=typeof a.propertyIsEnumerable&&!a.propertyIsEnumerable("splice"))return"array";if(!(a instanceof Object)&&("[object Function]"==Object.prototype.toString.call(a)||"undefined"!=typeof a.call&&"undefined"!=typeof a.propertyIsEnumerable&&!a.propertyIsEnumerable("call")))return"function"}else return"null";
else if("function"==b&&"undefined"==typeof a.call)return"object";return b};goog.propertyIsEnumerableCustom_=function(a,b){if(b in a)for(var d in a)if(d==b&&Object.prototype.hasOwnProperty.call(a,b))return!0;return!1};goog.propertyIsEnumerable_=function(a,b){return a instanceof Object?Object.prototype.propertyIsEnumerable.call(a,b):goog.propertyIsEnumerableCustom_(a,b)};goog.isDef=function(a){return void 0!==a};goog.isNull=function(a){return null===a};
goog.isDefAndNotNull=function(a){return null!=a};goog.isArray=function(a){return"array"==goog.typeOf(a)};goog.isArrayLike=function(a){var b=goog.typeOf(a);return"array"==b||"object"==b&&"number"==typeof a.length};goog.isDateLike=function(a){return goog.isObject(a)&&"function"==typeof a.getFullYear};goog.isString=function(a){return"string"==typeof a};goog.isBoolean=function(a){return"boolean"==typeof a};goog.isNumber=function(a){return"number"==typeof a};
goog.isFunction=function(a){return"function"==goog.typeOf(a)};goog.isObject=function(a){a=goog.typeOf(a);return"object"==a||"array"==a||"function"==a};goog.getUid=function(a){if(a.hasOwnProperty&&a.hasOwnProperty(goog.UID_PROPERTY_))return a[goog.UID_PROPERTY_];a[goog.UID_PROPERTY_]||(a[goog.UID_PROPERTY_]=++goog.uidCounter_);return a[goog.UID_PROPERTY_]};goog.removeUid=function(a){"removeAttribute"in a&&a.removeAttribute(goog.UID_PROPERTY_);try{delete a[goog.UID_PROPERTY_]}catch(b){}};
goog.UID_PROPERTY_="closure_uid_"+Math.floor(2147483648*Math.random()).toString(36);goog.uidCounter_=0;goog.getHashCode=goog.getUid;goog.removeHashCode=goog.removeUid;goog.cloneObject=function(a){var b=goog.typeOf(a);if("object"==b||"array"==b){if(a.clone)return a.clone();var b="array"==b?[]:{},d;for(d in a)b[d]=goog.cloneObject(a[d]);return b}return a};
goog.bind=function(a,b,d){var e=b||goog.global;if(2<arguments.length){var f=Array.prototype.slice.call(arguments,2);return function(){var b=Array.prototype.slice.call(arguments);Array.prototype.unshift.apply(b,f);return a.apply(e,b)}}return function(){return a.apply(e,arguments)}};goog.partial=function(a,b){var d=Array.prototype.slice.call(arguments,1);return function(){var b=Array.prototype.slice.call(arguments);b.unshift.apply(b,d);return a.apply(this,b)}};
goog.mixin=function(a,b){for(var d in b)a[d]=b[d]};goog.now=Date.now||function(){return+new Date};
goog.globalEval=function(a){if(goog.global.execScript)goog.global.execScript(a,"JavaScript");else if(goog.global.eval)if(null==goog.evalWorksForGlobals_&&(goog.global.eval("var _et_ = 1;"),"undefined"!=typeof goog.global._et_?(delete goog.global._et_,goog.evalWorksForGlobals_=!0):goog.evalWorksForGlobals_=!1),goog.evalWorksForGlobals_)goog.global.eval(a);else{var b=goog.global.document,d=b.createElement("script");d.type="text/javascript";d.defer=!1;d.appendChild(b.createTextNode(a));b.body.appendChild(d);
b.body.removeChild(d)}else throw Error("goog.globalEval not available");};goog.typedef=!0;goog.getCssName=function(a,b){var d=a+(b?"-"+b:"");return goog.cssNameMapping_&&d in goog.cssNameMapping_?goog.cssNameMapping_[d]:d};goog.setCssNameMapping=function(a){goog.cssNameMapping_=a};goog.getMsg=function(a,b){var d=b||{},e;for(e in d)a=a.replace(RegExp("\\{\\$"+e+"\\}","gi"),d[e]);return a};goog.exportSymbol=function(a,b,d){goog.exportPath_(a,b,d)};goog.exportProperty=function(a,b,d){a[b]=d};
goog.inherits=function(a,b){function d(){}d.prototype=b.prototype;a.superClass_=b.prototype;a.prototype=new d;a.prototype.constructor=a};
goog.base=function(a,b,d){var e=arguments.callee.caller;if(e.superClass_)return e.superClass_.constructor.apply(a,Array.prototype.slice.call(arguments,1));for(var f=Array.prototype.slice.call(arguments,2),g=!1,h=a.constructor;h;h=h.superClass_&&h.superClass_.constructor)if(h.prototype[b]===e)g=!0;else if(g)return h.prototype[b].apply(a,f);if(a[b]===e)return a.constructor.prototype[b].apply(a,f);throw Error("goog.base called from a method of one name to a method of a different name");};var Banana={Util:{}};Banana.Util.NameSpace={};var namespace=function(a,b,d){var a=a.split(b||"."),d=d||window,e,b=0;for(e=a.length;b<e;b++)d=d[a[b]]=d[a[b]]||{};return d};Banana.Util.Base={};
(function(){var a=!1,b=/xyz/.test(function(){xyz})?/\b_super\b/:/.*/;this.Class=function(){};Class.extend=function(d){function e(){!a&&this.init&&this.init.apply(this,arguments)}var f=this.prototype;a=!0;var g=new this;a=!1;for(var h in d)g[h]="function"==typeof d[h]&&"function"==typeof f[h]&&b.test(d[h])?function(a,b){return function(){var d=this._super;this._super=f[a];var e=b.apply(this,arguments);this._super=d;return e}}(h,d[h]):d[h];e.prototype=g;e.prototype.constructor=e;e.extend=arguments.callee;
return e}})();Banana.Control={};namespace("Banana").Control=Class.extend({init:function(){this.generateUniqueId();this.customId=!1;this.binds=[];this.controls=[];this.debug=!1},createComponents:function(){},updateDisplay:function(){},onPreInvalidateContents:function(){},unload:function(){},onWindowResize:function(){}});Banana.Control.prototype.applyToChildren=function(a){var b=this.applyToChildren.arguments;b.shift();var d;d=0;for(len=this.controls.length;d<len;d++)a.apply(this,b)};
Banana.Control.prototype.setId=function(a){this.id=a;this.customId=!0;return this};Banana.Control.prototype.getId=function(){return this.id};Banana.Control.prototype.setClientId=function(a){this.clientId=a};Banana.Control.prototype.getClientId=function(){return this.clientId};Banana.Control.prototype.generateUniqueId=function(){this.id=Banana.Util.generateUniqueId()};Banana.Control.prototype.render=function(a){this.getPage().initRender(a,this,null,null,!1)};
Banana.Control.prototype.setPage=function(a){this.page=a};Banana.Control.prototype.getPage=function(){return this.page};Banana.Control.prototype.getProxy=function(a){return jQuery.proxy(a,this)};Banana.Control.prototype.setParent=function(a){this.parent=a};Banana.Control.prototype.getParent=function(){return this.parent};Banana.Control.prototype.getEnabled=function(){};Banana.Control.prototype.addControl=function(a){this.controls.push(a);return this};Banana.Control.prototype.getControls=function(){return this.controls};
Banana.Control.prototype.findControl=function(a){if(a===this.getId())return this;var b=this.getControls();if(!b)return null;var d,e;d=0;for(e=b.length;d<e;d++)if(b[d]instanceof Banana.Control){var f=b[d].findControl(a);if(f)return f}return null};Banana.Control.prototype.remove=function(){this.getPage()instanceof Banana.UiControl?this.getPage().removeControl(this):this.unregisterEvents()};
Banana.Control.prototype.clear=function(){this.getPage()instanceof Banana.UiControl&&this.getPage().clearControl(this);this.controls=[]};Banana.Control.prototype.invalidateDisplay=function(){var a=this.getPage();a&&a.isRendered&&a.rerender(this.getFirstUiControl())};Banana.Control.prototype.triggerEvent=function(a,b){jQuery(this).trigger(a,b)};Banana.Control.prototype.getDomEventTypes=function(){return"mousedown mousemove resize mouseup ready click dblclick error ready select submit focusin focusout blur focus change mouseover mouseleave mouseenter mouseout keypress keyup keydown".split(" ")};
Banana.Control.prototype.bind=function(a,b,d){this.binds||(this.binds=[]);if(this.hasBind(a,b))return!1;-1!==this.getDomEventTypes().indexOf(a)?(this.binds.push({name:a,func:b,data:d,type:Banana.Controls.EventTypes.DOM_EVENT}),this.debugEvent(Banana.Controls.EventTypes.DOM_EVENT,a,"Bind normal"),this.isRendered&&jQuery("#"+this.getClientId()).bind(a,d,b)):(this.debugEvent(Banana.Controls.EventTypes.CUSTOM_EVENT,a,"Bind directly"),this.binds.push({name:a,func:b,data:d,type:Banana.Controls.EventTypes.CUSTOM_EVENT}),
jQuery(this).bind(a,d,b));return this};Banana.Control.prototype.hasBind=function(a,b){this.binds||(this.binds=[]);var d,e;d=0;for(e=this.binds.length;d<e;d++){var f=this.binds[d];if(b){if(f.name===a&&(b.guid===f.func.guid||f.func===b))return!0}else if(f.name===a)return!0}return!1};
Banana.Control.prototype.unbind=function(a,b){var d,e;d=0;for(e=this.binds.length;d<e;d++){var f=this.binds[d];this.debugEvent(3,a,"Unbind");if(b){if(f.name===a&&(b.guid===f.func.guid||f.func===b))-1!==this.getDomEventTypes().indexOf(a)?jQuery("#"+this.getClientId()).unbind(a,b):jQuery(this).unbind(a,b),jQuery(this).unbind(a,b),this.binds.splice(d,1)}else-1!==this.getDomEventTypes().indexOf(a)?jQuery("#"+this.getClientId()).unbind(a):jQuery(this).unbind(a),this.binds.splice(d,1)}};
Banana.Control.prototype.registerEvents=function(){if(this.binds){var a,b;a=0;for(b=this.binds.length;a<b;a++){var d=this.binds[a].name,e=this.binds[a].func,f=this.binds[a].data,g=this.binds[a].type;g===Banana.Controls.EventTypes.CUSTOM_EVENT&&this.getPage().isRerendering?(this.debugEvent(g,d,"Register event"),f?jQuery(this).bind(d,f,e):jQuery(this).bind(d,e)):this.debugEvent(g,d,"Ignore register event")}}};
Banana.Control.prototype.unregisterEvents=function(){this.binds&&(this.debugEvent(3,"","Unregister all events CONTROL"),jQuery(this).unbind())};Banana.Control.prototype.getHtml=function(a){var b="",d=this.getControls(),e,f;e=0;for(f=d.length;e<f;e++)d[e]instanceof Banana.Control?b+=d[e].getHtml(a):"string"===typeof d[e]&&(b+=d[e]);return b};
Banana.Control.prototype.debugEvent=function(a,b,d){this.debug&&"debugme"===this.id&&(a===Banana.Controls.EventTypes.DOM_EVENT?console.log(d,"dom",b,this.id):a===Banana.Controls.EventTypes.CUSTOM_EVENT?console.log(d,"customevent",b,this.id):3===a&&console.log(d,"all events",b,this.id))};Banana.Control.prototype.getFirstUiControl=function(){return this instanceof Banana.UiControl&&!this.markAsNonRender?this:this.parent?this.parent.getFirstUiControl():null};Banana.Util.ArrayUniCollection=function(){this.data={};this.indexKey=[];this.addItem=function(a,b){this.data[a]=b;this.indexKey[this.indexKey.length]=a};this.alterItem=function(a,b){this.data[a]&&(this.data[a]=b)};this.getItem=function(a){return this.data[a]};this.getArray=function(){var a=[];this.each(function(b,d){a.push(d)});return a};this.getItems=function(){return this.data};this.getItemByIndex=function(a){return this.getItem(this.indexKey[a])};this.getKeyByIndex=function(a){return this.indexKey[a]};
this.getLength=function(){return this.indexKey.length};this.removeByIndex=function(a){delete this.data[this.indexKey[a]];this.indexKey.splice(a,1)};this.isset=function(a){return void 0!=this.data[a]};this.clone=function(){c=new MFArrayUniCollection;c.data=eval(uneval(this.data));c.indexKey=this.indexKey.slice();return c};this.sortedKeys=function(a){var a=a||function(a,b){return parseInt(a)>parseInt(b)},b=this.indexKey.slice();b.sort(a);return b};this.each=function(a,b){for(var d=this.getLength(),
e=0;e<d;e++)a(e,this.getItemByIndex(e),b)};this.remove=function(){}};Banana.Util.ArrayBiCollection=function(){this.keyIndex=new Banana.Util.ArrayUniCollection;this.keyData=new Banana.Util.ArrayUniCollection;this.clone=function(){var a=new Banana.Util.ArrayBiCollection;a.keyIndex=this.keyIndex.clone();a.keyData=this.keyData.clone();return a};this.getArray=function(){var a=[];this.each(function(b,d){a.push(d)});return a};this.addItem=function(a,b){this.remove(a);this.keyIndex.addItem(a,this.keyIndex.getLength());this.keyData.addItem(a,b)};this.getItem=function(a){return this.keyData.getItem(a)};
this.getItemByIndex=function(a){return this.keyData.getItemByIndex(a)};this.getKeyByIndex=function(a){return this.keyIndex.getKeyByIndex(a)};this.getItemByKey=function(a){return this.getItemByIndex(this.getIndex(a))};this.getIndex=function(a){return this.keyIndex.getItem(a)};this.getLength=function(){return this.keyIndex.getLength()};this.isset=function(a){return void 0!=this.getItem(a)};this.remove=function(a){if(this.isset(a)){var b=this.keyIndex.getItem(a);this.keyIndex.removeByIndex(b);this.keyData.removeByIndex(b);
for(a=this.getLength();b<a;b++)this.keyIndex.alterItem(this.getKeyByIndex(b),b)}};this.clear=function(){this.keyIndex=new Banana.Util.ArrayUniCollection;this.keyData=new Banana.Util.ArrayUniCollection};this.sort=function(a){var a=this.keyIndex.sortedKeys(a),b=this.keyData;this.clear();for(var d=0;d<a.length;d++)this.addItem(a[d],b.getItem(a[d]));return this};this.each=function(a,b){for(var d=this.getLength(),e=0;e<d;e++)a(e,this.getItemByIndex(e),b)}};Banana.thirdParty={};Banana.thirdParty.OWLClone={};
owl=function(){function a(){}function b(b){return"object"==typeof b?(a.prototype=b,new a):b}function d(a){for(var b in a)this[b]=a[b]}function e(){this.copiedObjects=[];thisPass=this;this.recursiveDeepCopy=function(a){return thisPass.deepCopy(a)};this.depth=0}function f(a,b){var d=new e;b&&(d.maxDepth=b);return d.deepCopy(a)}var g=[];d.prototype={constructor:d,canCopy:function(){return!1},create:function(){},populate:function(){}};e.prototype={constructor:e,maxDepth:256,cacheResult:function(a,b){this.copiedObjects.push([a,
b])},getCachedResult:function(a){for(var b=this.copiedObjects,d=b.length,e=0;e<d;e++)if(b[e][0]===a)return b[e][1]},deepCopy:function(a){if(null===a)return null;if("object"!==typeof a)return a;var b=this.getCachedResult(a);if(b)return b;for(b=0;b<g.length;b++){var d=g[b];if(d.canCopy(a))return this.applyDeepCopier(d,a)}throw Error("no DeepCopier is able to copy "+a);},applyDeepCopier:function(a,b){var d=a.create(b);if(b instanceof Banana.Data.BaseObject){var e=Banana.Data.ObjectMapper.getObject(b.getClass()),
g;for(g in d)e[g]=d[g];d=e}this.cacheResult(b,d);this.depth++;if(this.depth>this.maxDepth)throw Error("Exceeded max recursion depth in deep copy.");a.populate(this.recursiveDeepCopy,b,d);this.depth--;return d}};f.DeepCopier=d;f.deepCopiers=g;f.register=function(a){a instanceof d||(a=new d(a));g.unshift(a)};f.register({canCopy:function(){return!0},create:function(a){return a instanceof a.constructor?b(a.constructor.prototype):{}},populate:function(a,b,d){for(var e in b)b.hasOwnProperty(e)&&(d[e]=a(b[e]));
return d}});f.register({canCopy:function(a){return a instanceof Array},create:function(a){return new a.constructor},populate:function(a,b,d){for(var e=0;e<b.length;e++)d.push(a(b[e]));return d}});f.register({canCopy:function(a){return a instanceof Date},create:function(a){return new Date(a)}});f.register({canCopy:function(a){a=window.Node?a instanceof Node:a===document?!0:"number"===typeof a.nodeType&&a.attributes&&a.childNodes&&a.cloneNode;return a},create:function(a){return a===document?document:
a.cloneNode(!1)},populate:function(a,b,d){if(b===document)return document;if(b.childNodes&&b.childNodes.length)for(var e=0;e<b.childNodes.length;e++){var g=a(b.childNodes[e]);d.appendChild(g)}}});return{DeepCopyAlgorithm:e,copy:function(a){if("object"!==typeof a)return a;if(null===a)return null;var d=a.valueOf();if(a!=d)return new a.constructor(d);if(a instanceof a.constructor&&a.constructor!==Object){var d=b(a.constructor.prototype),e;for(e in a)a.hasOwnProperty(e)&&(d[e]=a[e])}else for(e in d={},
a)d[e]=a[e];return d},clone:b,deepCopy:f}}();Banana.Util.Utils={};
Banana.Util.NaturalSort=function(a,b){var d=/(^-?[0-9]+(\.?[0-9]*)[df]?e?[0-9]?$|^0x[0-9a-f]+$|[0-9]+)/gi,e=/(^[ ]*|[ ]*$)/g,f=/(^([\w ]+,?[\w ]+)?[\w ]+,?[\w ]+\d+:\d+(:\d+)?[\w ]?|^\d{1,4}[\/\-]\d{1,4}[\/\-]\d{1,4}|^\w+, \w+ \d+, \d{4})/,g=/^0x[0-9a-f]+$/i,h=/^0/,j=(Banana.Util.NaturalSort.insensitive&&(""+a).toLowerCase()||""+a).replace(e,"")||"",m=(Banana.Util.NaturalSort.insensitive&&(""+b).toLowerCase()||""+b).replace(e,"")||"",e=j.replace(d,"\x00$1\x00").replace(/\0$/,"").replace(/^\0/,"").split("\x00"),
d=m.replace(d,"\x00$1\x00").replace(/\0$/,"").replace(/^\0/,"").split("\x00"),j=parseInt(j.match(g))||1!=e.length&&j.match(f)&&Date.parse(j);if(f=parseInt(m.match(g))||j&&m.match(f)&&Date.parse(m)||null){if(j<f)return-1;if(j>f)return 1}j=0;for(m=Math.max(e.length,d.length);j<m;j++){f=!(e[j]||"").match(h)&&parseFloat(e[j])||e[j]||0;g=!(d[j]||"").match(h)&&parseFloat(d[j])||d[j]||0;if(isNaN(f)!==isNaN(g))return isNaN(f)?1:-1;typeof f!==typeof g&&(f+="",g+="");if(f<g)return-1;if(f>g)return 1}return 0};
Banana.Util.serialize=function(a){return JSON.stringify(a)};Banana.Util.unserialize=function(a){return JSON.parse(a)};Banana.Util.NamespaceToFunction=function(a){for(var a=a.split("."),b=window,d=0,e=a.length;d<e;d++)if(b=b[a[d]],!b)return null;return b};Banana.Util.getDataByPath=function(a,b){for(var b=b.split("."),d=a,e=0,f=b.length;e<f;e++)if(d=d[b[e]],void 0==d)return null;return d};Banana.Util.Clone=function(a,b){return b?owl.deepCopy(a):owl.clone(a)};
Banana.Util.FindByField=function(a,b,d){for(var e=0,f=a.length;e<f;e++)if(a[e][b]==d)return a[e];return null};Banana.Util.CombineArrayByField=function(a,b){if(a instanceof Array){if(!b)return log.error("Banana.Util.CombineArrayByField - No field given"),a}else return log.error("Banana.Util.CombineArrayByField - List should be of type Array"),a;for(var d={},e=0;e<a.length;e++)d[a[e][b]]||(d[a[e][b]]=[]),d[a[e][b]].push(a[e]);var e=[],f;for(f in d)e.push(d[f]);return e};
Banana.Util.CopyTo=function(a,b,d,e){if(a instanceof Array&&b instanceof Array)for(var f=b.splice(0,b.length),g=0,h=a.length;g<h;g++)if(e=a[g],"object"==typeof e){var j=e||e[d];if(j){for(var m=!1,p=0,n=f.length;p<n;p++){var q=f[p],r=q[d];if(r&&r==j){m=!0;b.push(q);Banana.Util.CopyTo(e,q,d,{ref:b,prop:g});break}}m||b.push(e)}else b.push(e)}else b[g]=e;else if(a instanceof Array)if(e)e.ref[e.prop]=a;else throw"Unable to assign property to object (missing reference)";else if("object"==typeof a){f=[];
for(g in b)"function"!=typeof b[g]&&f.push(g);for(g in a)e=a[g],"function"!=typeof e&&(h=f.indexOf(g),0<=h&&f.splice(h,1),"object"==typeof a[g]&&b[g]?Banana.Util.CopyTo(a[g],b[g],d,{ref:b,prop:g}):b[g]=e);for(g=0;g<f.length;g++)delete b[f[g]]}return b};Banana.Util.ObjectsAreEqual=function(a,b,d){return Banana.Util.ObjectPropsSameTo(a,b,d)&&Banana.Util.ObjectPropsSameTo(b,a,d)};
Banana.Util.ObjectPropsSameTo=function(a,b,d){if(!b||!a)return!1;d||(d=[]);for(var e in a)if("function"!=typeof a[e])if("object"==typeof a[e]&&null!==b[e])if("object"==typeof b[e]){if(!Banana.Util.ObjectsAreEqual(a[e],b[e],d))return!1}else return!1;else if(("string"==typeof a[e]||"number"==typeof a[e]||"boolean"==typeof a[e])&&-1==d.indexOf(e)&&b[e]!=a[e])return!1;return!0};
Banana.Util.sortObjectKeys=function(a,b){var d=[],e;for(e in a)d.push(e);b?d.sort(b):d.sort();for(var f={},g=0;g<d.length;g++)e=d[g],f[e]=a[e];return f};Banana.Util.generateUniqueId=function(){return(68719476736*(1+Math.random())|0).toString(16).substring(1)};Banana.Util.flattenTreeDepthFirst=function(a,b,d){d||(d=[]);if(!a)return d;if(a[b]){var e,f;e=0;for(f=a[b].length;e<f;e++)Banana.Util.flattenTreeDepthFirst(a[b][e],b,d)}d.push(a);return d};
Banana.Util.arrayInteratorAsync=function(a,b,d,e,f){function g(){j++;if(m>j){for(var p=0;p<=h;p++){j++;if(j>m)return e();b(a[j],j)}f&&f();var n=g;setTimeout(function(){n()},d)}else if(e)return e()}if("function"!=typeof b)return log.error("No callback specified for async iterator");var d=d||0,h=10<a.length?a.length/10:1,j=-1,m=a.length;g()};Banana.Util.ValidationManager=function(){var a=[];return{addValidator:function(b){var d;a:{i=0;for(len=a.length;i<len;i++)if(a[i].id==b.id){d=!0;break a}d=!1}d||a.push(b)},hasValidator:function(b){return-1==a.indexOf(b)?!1:!0},removeValidator:function(b){b=a.indexOf(b);a.splice(b,i)},removeValidators:function(){a=[]},validate:function(a){return a.isValid()},validateAll:function(){var b=!0;i=0;for(len=a.length;i<len;i++)a[i]&&a[i].id&&(a[i].isValid()||(b=!1));return b}}}();Banana.Util.UrlManager=function(){var a={},b={},d={},e=!1,f=function(){for(var a=g(),b={},d,e,a=a.split("&"),f=a.length-1;0<=f;f--)e=a[f].split("="),d=e[0],b[d]=e.slice(1).join("=");return b},g=function(){return"Microsoft Internet Explorer"==navigator.appName&&document.getElementById("URLFrame")?(location.hash=document.frames.URLFrame.location.search.slice(1),document.frames.URLFrame.location.search.slice(1)):location.hash.slice(1)},h=function(){var a="";d=Banana.Util.sortObjectKeys(d);for(var b in d)d[b].bhmValue&&
(a+=0===a.length?"":"&",a=a+b+"="+d[b].bhmValue);a!=g()&&("Microsoft Internet Explorer"==navigator.appName&&document.getElementById("URLFrame")&&(document.frames.URLFrame.location.replace(document.frames.URLFrame.location.pathname+"?"+location.hash.slice(1)),document.getElementById("URLFrame").setAttribute("src",document.frames.URLFrame.location.pathname+"?"+a)),location.hash=a)},j=function(){stopHandler=!1;e||(e=!0,$(window).bind("hashchange",function(){if(e){for(var a=event.target.location.hash.substring(1),
b={},g,f=/\+/g,h=/([^&;=]+)=?([^&;]*)/g;g=h.exec(a);)b[decodeURIComponent(g[1].replace(f," "))]=decodeURIComponent(g[2].replace(f," "));$.each(b,function(a,b){d[a]&&d[a].bhmValue!=b&&(d[a].bhmValue=b,jQuery(document).trigger("url."+a,[b,a]))})}}))},m=function(){e=!1;$(window).unbind("hashchange")};return{registerModule:function(a){d[a]||(d[a]={});d[a].bhmValue=f()[a]?f()[a]:""},autoRegisterModules:function(){params=f();for(param in params)param&&this.registerModule(param)},stopChecking:function(){m()},
startChecking:function(){j()},removeModules:function(){for(var a in d)m(),this.unlistenModule(a);d={}},clearUrl:function(){this.removeModules();this.removeListeners()},removeModule:function(a,b){m();b?d[a].bhmValue="":(this.unlistenModule(a),delete d[a]);h();for(var e in d)return j()},setModule:function(a,b,e){if(a){e=e||!1;if(!d[a])return!1;m();d[a].bhmValue=b;!e&&(d[a]&&this.getModule[a]!=b)&&(h(),jQuery(document).trigger("url."+a,[b,a]));j()}},updateUrl:function(){h()},getModule:function(a){return d[a]&&
d[a].bhmValue?d[a].bhmValue:f()[a]?f()[a]:null},saveModuleHistory:function(){b[this.getModule("section")]=f()},getModuleHistory:function(a){return b[a]},getBrowserUrl:function(){return g()},getHistory:function(){return b},listenModule:function(b,d,e){e||(e={});m(b);jQuery(document).bind("url."+b,e,d);a[b]=!0;j(b)},unlistenModule:function(b){jQuery(document).unbind("url."+b);delete a[b]},removeListeners:function(){for(l in a)"function"!=typeof a[l]&&this.unlistenModule(l);a=[]},getURLObject:function(){return f()},
createUrlString:function(a,b){if(b){b.section=a;var b=Banana.Util.sortObjectKeys(b),d="",e;for(e in b)d+="&"+e+"="+b[e];return d.substr(1,d.length)}return"section="+a}}}();Banana.Util.StateManager=function(){function a(a,d,e,f,g,h){a=a+"="+escape(d)+(e?"; expires="+e.toGMTString():"")+(f?"; path="+f:"")+(g?"; domain="+g:"")+(h?"; secure":"");document.cookie=a}return{setState:function(b,d){a(b,d)},getState:function(a){a=(a=document.cookie.match("(^|;) ?"+a+"=([^;]*)(;|$)"))?unescape(a[2]):null;return"false"==a?!1:"true"==a?!0:a},removeState:function(b){a(b,"")}}}();Banana.Util.DomHelper={};
namespace("Banana.Util").DomHelper={render:function(a,b){"string"===typeof b?jQuery("#"+b).append(a):jQuery("#"+b.getClientId()).append(a)},replace:function(a,b){"string"===typeof b?jQuery(b).replaceWith(a):jQuery("#"+b.getClientId()).replaceWith(a)},renderHtml:function(a,b,d){"body"===b.getClientId()?d?jQuery("body").html(a):jQuery("body").append(a):d?jQuery("#"+b.getClientId()).html(a):jQuery("#"+b.getClientId()).append(a)},clear:function(a){jQuery("#"+a.getClientId()).empty()},remove:function(a){"string"===
typeof a?jQuery("#"+a).remove():jQuery("#"+a.getClientId()).remove()},setData:function(a,b){jQuery("#"+b.getClientId()).val(a)},setTextData:function(a,b){jQuery("#"+b.getClientId()).text(a)},setCheckBoxData:function(a,b){a?jQuery("#"+b.getClientId()).prop({checked:!0}):jQuery("#"+b.getClientId()).prop("checked",!1)},getData:function(a){return jQuery("#"+a.getClientId()).val()},getCheckBoxData:function(a){return jQuery("#"+a.getClientId()).prop("checked")},clearIdsFrom:function(a){jQuery("#"+a+" *").attr({id:"cleared"});
jQuery("#"+a).attr({id:"cleared"})}};Banana.Util.DateTimecode=function(a,b){var d=new Date;this.getTimecode=function(){return d.getTime()};this.setTimecode=function(a){d.setTime(a);return this};var e=function(a){return(10>a?"0":"")+a};this.getLocalDateTime=function(a){var a=a||"%d-%m-%Y %H:%M:%S:%F",b={H:e(d.getHours()),M:e(d.getMinutes()),S:e(d.getSeconds()),F:e(Math.round(25*(d.getMilliseconds()/1E3))),d:e(d.getDate()),m:e(d.getMonth()+1),Y:d.getFullYear(),w:d.getWeek()},f;for(f in b)a=a.replace("%"+f,b[f]);return a};this.getLocalTime=
function(a){return this.getLocalDateTime(a||"%H:%M:%S:%F")};this.getLocalDate=function(a){return this.getLocalDateTime(a||"%d-%m-%Y")};this.getDateTime=function(a){var a=a||"%d-%m-%Y %H:%M:%S:%F",b={H:e(d.getUTCHours()),M:e(d.getUTCMinutes()),S:e(d.getUTCSeconds()),F:e(Math.round(25*(d.getUTCMilliseconds()/1E3))),d:e(d.getUTCDate()),m:e(d.getUTCMonth()+1),Y:d.getUTCFullYear()},f;for(f in b)a=a.replace("%"+f,b[f]);return a};this.getTime=function(a){return this.getDateTime(a||"%H:%M:%S:%F")};this.getDate=
function(a){return this.getDateTime(a||"%d-%m-%Y")};var f=function(a){a=a.split(/[-: ]/);3==a.length&&(a.push("0"),a.push("0"),a.push("0"),a.push("0"));4==a.length&&(a.unshift("1970"),a.unshift("1"),a.unshift("1"));return a};this.setYear=function(a){d.setFullYear(a);return this};this.setUTCYear=function(a){d.setUTCFullYear(a);return this};this.getYear=function(){return d.getFullYear()};this.getUTCYear=function(){return d.getUTCFullYear()};this.setTime=function(a){a=f(a);d.setUTCDate(1);d.setUTCFullYear(a[2]);
d.setUTCMonth(a[1]-1);d.setUTCDate(a[0]);d.setUTCHours(a[3]);d.setUTCMinutes(a[4]);d.setUTCSeconds(a[5]);d.setUTCMilliseconds(1E3*(a[6]/25));return this};this.setLocalDate=this.setLocalDateTime=this.setLocalTime=function(a){a=f(a);d.setDate(1);d.setFullYear(a[2]);d.setMonth(a[1]-1);d.setDate(a[0]);d.setHours(a[3]);d.setMinutes(a[4]);d.setSeconds(a[5]);d.setMilliseconds(1E3*(a[6]/25));return this};this.add=function(a){this.setTimecode(this.getTimecode()+a.getTimecode());return this};this.sub=function(a){this.setTimecode(this.getTimecode()-
a.getTimecode());return this};this.compareTo=function(a){return this.getTimecode()-a.getTimecode()};this.getWeek=function(){return d.getWeek()};this.getDay=function(){return d.getDay()};this.getMonth=function(){return d.getUTCMonth()+1};this.getLocalMonth=function(){return d.getMonth()+1};this.getMonthDay=function(){return d.getUTCDate()};this.getLocalMonthDay=function(){return d.getDate()};this.addMonth=function(a,b){var d=this.getMonth()+1,e=this.getYear();b||(b=a?this.getLocalMonthDay():this.getMonthDay());
13==d&&(d=1,e++);a?this.setLocalTime(b+"-"+d+"-"+e+" "+this.getLocalTime()):this.setTime(b+"-"+d+"-"+e+" "+this.getTime())};a&&(isNaN(a)?b?this.setLocalTime(a):this.setTime(a):this.setTimecode(a))};
Date.prototype.getWeek=function(a){var a="int"==typeof a?a:0,b=new Date(this.getFullYear(),0,1),d=b.getDay()-a,d=0<=d?d:d+7,b=Math.floor((this.getTime()-b.getTime()-6E4*(this.getTimezoneOffset()-b.getTimezoneOffset()))/864E5)+1;4>d?(d=Math.floor((b+d-1)/7)+1,52<d&&(nYear=new Date(this.getFullYear()+1,0,1),nday=nYear.getDay()-a,nday=0<=nday?nday:nday+7,d=4>nday?1:53)):d=Math.floor((b+d-1)/7);return d};Banana.Util.Color=function(a,b,d){var e;this.getR=function(){return this.r};this.setR=function(a){this.r=a;this.computeHSV()};this.getG=function(){return this.g};this.setG=function(a){this.g=a;this.computeHSV()};this.getB=function(){return this.b};this.setB=function(a){this.b=a;this.computeHSV()};this.getH=function(){return this.h};this.setH=function(a){this.h=a;this.computeRGB()};this.getS=function(){return this.s};this.setS=function(a){this.s=a;this.computeRGB()};this.getV=function(){return this.v};
this.setV=function(a){this.v=a;this.computeRGB()};var f=function(a){return parseInt(a,16)};this.setValue=function(a){"#"===a.substr(0,1)?(this.r=f(a.substr(1,2)),this.g=f(a.substr(3,2)),this.b=f(a.substr(5,2))):(a=/^rgb\((\d{1,3}),\s*(\d{1,3}),\s*(\d{1,3})\)$/.exec(a),this.r=parseInt(a[1]),this.g=parseInt(a[2]),this.b=parseInt(a[3]));this.computeHSV()};this.getValue=function(){return"#"+((16>this.r?"0":"")+this.r.toString(16))+((16>this.g?"0":"")+this.g.toString(16))+((16>this.b?"0":"")+this.b.toString(16))};
this.computeHSV=function(){var a=this.r/255,b=this.g/255,d=this.b/255,e=Math.min(a,b,d),f=Math.max(a,b,d),e=f-e,n=0,q=0;0!=f?(q=e/f,n=60*(e?a==f?(b-d)/e:b==f?2+(d-a)/e:4+(a-b)/e:0),0>n&&(n+=360)):(q=0,n=-1);this.h=n;this.s=q;this.v=f};this.computeRGB=function(){var a=this.h,b=this.s,d=this.v,f=0,p=0,n=0,q=0,f=n=p=0;if(0==b)e=f=n=d;else switch(a=a%360/60,f=Math.floor(a),p=a-f,n=d*(1-b),q=d*(1-b*p),p=d*(1-b*(1-p)),f){case 0:e=d;f=p;break;case 1:e=q;f=d;break;case 2:e=n;f=d;n=p;break;case 3:e=n;f=q;
n=d;break;case 4:e=p;f=n;n=d;break;default:e=d,f=n,n=q}this.r=Math.round(255*e);this.g=Math.round(255*f);this.b=Math.round(255*n)};"string"==typeof a?this.setValue(a):("number"==typeof a?(this.r=a,this.g=b,this.b=d):this.b=this.g=this.r=0,this.computeHSV())};/*
   xxx
 @version   0.0.1
 @package   Banana

 Logger Object

 The Logger object is the base object for all different Loggers

*/
namespace("Banana.Util");Banana.Util.Logger=function(){this.id="Base"};Banana.Util.Logger.prototype.write=function(){throw Error("Logger::write should be overloaded!");};/*
   xxx
 @version   0.0.1
 @package   Banana

 Console Logger Object

 The Console logger logs its messages to the console

*/
namespace("Banana.Util.Logger");Banana.Util.Logger.Console=function(){this.id="Console";window.console||(window.console={log:function(){},error:function(){},time:function(){},timeEnd:function(){}})};Banana.Util.Logger.Console.prototype=new Banana.Util.Logger;Banana.Util.Logger.Console.prototype.write=function(a){console.log(a)};namespace("Banana.Util");Banana.Util.LogManager=function(){this.loggers=[];this.errorData=[];this.levels={};this.levels.debug=!1;this.levels.notice=!1;this.levels.warning=!1;this.levels.error=!1;this.levels.route=!1;this.showTime=!0};Banana.Util.LogManager.prototype.addLogger=function(a){"string"==typeof a&&(a=eval("new Banana.Util.Logger."+a));this.loggers.push(a)};
Banana.Util.LogManager.prototype.getInfo=function(){var a="";if(this.loggers.length)for(var a=a+"Banana is using loggers:\r\n",b=0;b<this.loggers.length;b++)a+=this.loggers[b].id+"\r\n";else a+="No loggers are defined\r\n";var a=a+"\r\nLogger is showing messages:\r\n",d;for(d in this.levels)this.levels[d]&&(a+=d+"\r\n");alert(a)};Banana.Util.LogManager.prototype.setLevel=function(a,b){this.levels[a]=b};Banana.Util.LogManager.prototype.showTimes=function(a){this.showTime=a};
Banana.Util.LogManager.prototype.addErrorData=function(a,b){b||(b=window.location.href);var d={};d.page=b;d.data=a;this.errorData.push(d)};Banana.Util.LogManager.prototype.getErrorData=function(){return this.errorData};Banana.Util.LogManager.prototype.resetErrorData=function(){this.errorData=[]};
Banana.Util.LogManager.prototype.write=function(a,b){b&&(a="["+b+"]\t"+a);if(this.showTime)var d=new Date,e=d.getHours(),f=d.getMinutes(),g=d.getSeconds(),d=d.getMilliseconds(),a=e+":"+f+":"+g+":"+d+" | "+a;for(e=0;e<this.loggers.length;e++)this.loggers[e].write(a)};Banana.Util.LogManager.prototype.debug=function(a){this.levels.debug&&this.write(a,"DEBUG")};Banana.Util.LogManager.prototype.notice=function(a){this.levels.notice&&this.write(a,"NOTICE")};
Banana.Util.LogManager.prototype.warning=function(a){this.levels.warning&&this.write(a,"WARNING")};Banana.Util.LogManager.prototype.error=function(a){this.levels.error&&this.write(a,"ERROR")};Banana.Util.LogManager.prototype.route=function(a){this.levels.route&&this.write(a,"ROUTE")};Banana.Data={};Banana.Data.DataSet={};
namespace("Banana.Data").DataSet=Banana.Control.extend({init:function(){this.dataKey="id";this.controlRegisterModified=this.isChanged=!1},setDataKey:function(a){this.dataKey=a},clear:function(){this.unregisterEvents();this.oldData=this.data=this.registeredDataControls=this.registeredDataSourceControls=void 0},bind:function(a,b){"controlDataChanged"==a&&(this.enableControlChangeEvent=!0);return this._super(a,b)},clearControlData:function(){for(id in this.registeredDataSourceControls){var a=this.registeredDataSourceControls[id];
a.bindedDataSource&&a.bindedDataSource[1]&&a.setDataSource(null,!0)}for(id in this.registeredDataControls)a=this.registeredDataControls[id],a.bindedData&&a.bindedData[1]&&a.setData(null,!0);this.oldData=void 0;jQuery(this).trigger("dataChanged",this.data)},setData:function(a,b){this.allowControlUpdate=!0;this.data!=a&&this.data&&!this.controlRegisterModified?b||!Banana.Util.ObjectsAreEqual(a,this.data)?(Banana.Util.CopyTo(a,this.data,this.dataKey),this.triggerEvent("dataChanged")):(this.allowControlUpdate=
!1,this.triggerEvent("dataUnchanged")):(this.data=a,this.triggerEvent("dataChanged"));return this},resetControls:function(){this.getData()&&(this.allowControlUpdate=!0,this.clientUpdate())},getData:function(){return this.data},getIsChanged:function(){return this.isChanged},clientUpdate:function(){if(!this.allowControlUpdate)return!1;for(id in this.registeredDataSourceControls){var a=this.registeredDataSourceControls[id];a.bindedDataSource&&this.setControlDataSource(a)}for(id in this.registeredDataControls)a=
this.registeredDataControls[id],a.bindedData&&a.bindedData[1]&&this.setControlData(a);this.isChanged=this.controlRegisterModified=!1},getControlData:function(a){var b={},d;for(d in this.registeredDataControls){var e=this.registeredDataControls[d],f=e.getData();if(e.id||e instanceof Banana.Controls.DataControl){if(a)g=void 0===f?null:f;else{var g={originalData:null,isDataChanged:!0};this.getData()&&(g.originalData=this.getDataByPath(e.bindedData[1])||null,g.isDataChanged=this.getDataByPath(e.bindedData[1])!=
f);g.data=void 0===f?null:f}this.ensureObjectFromPath(b,e.bindedData[1],g)}}return b},getChangedDataSet:function(){var a=this.getData()||{},b;for(b in this.registeredDataControls){var d=this.registeredDataControls[b];if(d instanceof Banana.Controls.DataControl){var e=d.bindedData[1];e.split(".");this.ensureObjectFromPath(a,e);this.setDataByPath(d.getData(),e)}}return a},commitControlData:function(){var a={},b;for(b in this.registeredDataControls){var d=this.registeredDataControls[b];d instanceof Banana.Controls.DataControl&&
(a=this.ensureObjectFromPath(a,d.bindedData[1],d.getData()))}this.setData(a);return this},ensureObjectFromPath:function(a,b,d,e,f){if(b){var g=b.split("."),f=a;a[g[0]]||(a[g[0]]={});var h=g[0];g.splice(0,1);e=b;b=g.join(".");this.ensureObjectFromPath(a[h],b,d,e,f);return a}f[e]=d},setControlData:function(a){var b=null===this.getData()?null:this.getDataByPath(a.bindedData[1]);a.setData(b);a.triggerEvent("controlDataBinded",b)},setControlDataSource:function(a){if(a.bindedDataSource[1]){var b=this.getDataByPath(a.bindedDataSource[1]);
a.setDataSource(b)}else a.setDataSource(this.getData());a.triggerEvent("controlDataSourceBinded")},getDataByPath:function(a){var a=a.split("."),b=this.getData();if(!b)return b;for(var d=0,e=a.length;d<e;d++)if(b=b[a[d]],void 0==b)return null;return b},setDataByPath:function(a,b){var b=b.split("."),d=this.getData(),e=null;if(1==b.length)e=b;else{for(var d=this.getData(),e=0,f=b.length;e<f-1;e++)d=d[b[e]];e=b[b.length-1]}d[e]=a;return d},bindControlToDataSource:function(a){this.controlRegisterModified=
!0;this.registeredDataSourceControls||(this.registeredDataSourceControls={});this.registeredDataSourceControls[a.getId()]||(this.getData()&&this.setControlDataSource(a),this.registeredDataSourceControls[a.getId()]=a)},bindControlToData:function(a){this.controlRegisterModified=!0;this.registeredDataControls||(this.registeredDataControls={});this.registeredDataControls[a.getId()]||(this.getData()&&this.setControlData(a),this.enableControlChangeEvent&&a.bind("dataChanged",this.getProxy(this.controlChangedHandler)),
this.registeredDataControls[a.getId()]=a)},controlChangedHandler:function(a){this.controlChecks||(this.controlChecks={});var b=a.currentTarget,b=null===this.getData()?"":this.getDataByPath(b.bindedData[1]);this.controlChecks[a.currentTarget.id]=(b||"")!=a.currentTarget.data?!1:!0;for(index in this.controlChecks)if(!1==this.controlChecks[index]){this.triggerEvent("controlDataChanged");return}this.triggerEvent("controlDataRestored")},unBindControl:function(a){this.controlRegisterModified=!0;delete this.registeredDataControls[a.getId()]},
unBindDataSourceControl:function(a){this.registeredDataSourceControls&&(this.controlRegisterModified=!0,delete this.registeredDataSourceControls[a.getId()])}});Banana.UiControl={};namespace("Banana").UiControl=Banana.Control.extend({init:function(){this._super();this.css={};this.style="";this.isRendered=!1;this.enabled=this.visible=!0},addControl:function(a,b){this.isInitialized&&(b?(this.getPage().initializeControl(a,this,!1,this.controls.length+1),this.render(a)):this.getPage().initializeControl(a,this,!1,this.controls.length+1));return this._super(a)}});Banana.UiControl.prototype.getDomWriter=function(){return jQuery("#"+this.getClientId())};
Banana.UiControl.prototype.getTagName=function(){return""};Banana.UiControl.prototype.getDimensions=function(){var a={};a.height=jQuery("#"+this.getClientId()).height();a.width=jQuery("#"+this.getClientId()).width();a.offset=jQuery("#"+this.getClientId()).offset();a.position=jQuery("#"+this.getClientId()).position();return a};Banana.UiControl.prototype.setClientId=function(a){this.clientId=a};Banana.UiControl.prototype.getClientId=function(){return this.clientId};
Banana.UiControl.prototype.triggerEvent=function(a,b){-1!==this.getDomEventTypes().indexOf(a)?this.isRendered&&jQuery("#"+this.clientId).trigger(a,b):jQuery(this).trigger(a,b)};Banana.UiControl.prototype.setState=function(a,b){var d=Banana.Util.UrlManager.getModule("section"),e=this.getClientId();this.customId&&(e=this.getId());Banana.Util.StateManager.setState(d+"-"+e+"-"+a,b);return this};
Banana.UiControl.prototype.getState=function(a){var b=Banana.Util.UrlManager.getModule("section"),d=this.getClientId();this.customId&&(d=this.getId());return Banana.Util.StateManager.getState(b+"-"+d+"-"+a)};Banana.UiControl.prototype.removeState=function(a){var b=Banana.Util.UrlManager.getModule("section"),d=this.getClientId();this.customId&&(d=this.getId());return Banana.Util.StateManager.removeState(b+"-"+d+"-"+a)};
Banana.UiControl.prototype.getAttributes=function(){var a={};this.attributes&&(a=this.attributes);a.id=this.getClientId();a.style=this.getStyle();if(this.getCss()){var b=[];for(prop in this.getCss())cssPart=prop+":"+this.getCss()[prop]+";",b.push(cssPart);a.style+=b.join("")}0<this.getCssClass().length&&(a["class"]=this.getCssClass().join(" "));return a};
Banana.UiControl.prototype.setAttribute=function(a,b){if(this.isRendered)switch(a){case "async":case "autofocus":case "checked":case "location":case "multiple":case "readOnly":case "selected":case "autoplay":case "controls":case "defer":case "disabled":case "hidden":case "loop":case "open":case "scoped":jQuery("#"+this.getClientId()).prop(a,b);break;default:jQuery("#"+this.getClientId()).attr(a,b)}var d=this.getAttributes();d[a]=b;this.attributes=d;return this};
Banana.UiControl.prototype.removeAttribute=function(a){if(this.isRendered)switch(a){case "async":case "autofocus":case "checked":case "location":case "multiple":case "readOnly":case "selected":case "autoplay":case "controls":case "defer":case "disabled":case "hidden":case "loop":case "open":case "scoped":jQuery("#"+this.getClientId()).removeProp(a);break;default:jQuery("#"+this.getClientId()).attr(a,"")}this.attributes&&this.attributes[a]&&delete this.attributes[a];return this};
Banana.UiControl.prototype.getAttribute=function(a){return!this.attributes?null:this.attributes[a]};Banana.UiControl.prototype.setStyle=function(a){this.style=a;return this};Banana.UiControl.prototype.getStyle=function(){return this.style};Banana.UiControl.prototype.addCss=function(a){var b={};for(prop in this.getCss())b[prop]=this.getCss()[prop];for(prop in a)b[prop]=a[prop];this.css=b};
Banana.UiControl.prototype.setCss=function(a){this.addCss(a);this.isRendered&&jQuery("#"+this.getClientId()).css(this.css);return this};Banana.UiControl.prototype.getCss=function(){return this.css};Banana.UiControl.prototype.getStyleProperty=function(a){return this.css[a]||jQuery("#"+this.getClientId()).css(a)};Banana.UiControl.prototype.getCssClass=function(){this.cssClass||(this.cssClass=[]);return this.cssClass};
Banana.UiControl.prototype.addCssClass=function(a){this.cssClass||(this.cssClass=[]);this.hasCssClass(a)||(this.cssClass.push(a),this.isRendered&&jQuery("#"+this.getClientId()).addClass(a));return this};Banana.UiControl.prototype.removeCssClass=function(a){if(!this.cssClass)return this;var b=this.cssClass.indexOf(a);-1!=b&&(this.cssClass.splice(b,1),this.isRendered&&jQuery("#"+this.getClientId()).removeClass(a));return this};
Banana.UiControl.prototype.switchCssClass=function(a,b){this.removeCssClass(a);this.addCssClass(b);return this};Banana.UiControl.prototype.hasCssClass=function(a){return this.isRendered?jQuery("#"+this.getClientId()).hasClass(a):0<=jQuery.inArray(a,this.getCssClass())?!0:!1};Banana.UiControl.prototype.getHtmlAttributes=function(){var a=this.getAttributes(),b="",d;for(d in a)a[d]&&"undefined"!=a[d]&&(b+=d+'="'+a[d]+'" ');return b};
Banana.UiControl.prototype.setVisible=function(a,b,d,e){this.triggerEvent("onSetVisible",a);this.visible=a;var f=!1;a?(this.isRendered&&("fadeIn"===d?(this.getDomWriter().fadeIn(b,this.getProxy(function(){this.setCss({display:""});e&&e()})),f=!0):this.getDomWriter().show(b,this.getProxy(function(){this.setCss({display:""});e&&e()}))),f||this.setCss({display:""})):(this.isRendered&&("fadeOut"===d?(f=!0,this.getDomWriter().fadeOut(b,this.getProxy(function(){this.setCss({display:"none"});e&&e()}))):
this.getDomWriter().hide(b,this.getProxy(function(){this.setCss({display:"none"});e&&e()}))),f||this.setCss({display:"none"}));return this};Banana.UiControl.prototype.getVisible=function(){return this.isRendered?jQuery("#"+this.getClientId()).is(":visible"):this.visible};
Banana.UiControl.prototype.registerEvents=function(){if(this.binds||this.binds.length){var a,b;a=0;for(b=this.binds.length;a<b;a++){var d=this.binds[a].name,e=this.binds[a].func,f=this.binds[a].data,g=this.binds[a].type;g===Banana.Controls.EventTypes.DOM_EVENT?(this.debugEvent(g,d,"Register event"),f?jQuery("#"+this.getClientId()).bind(d,f,e):jQuery("#"+this.getClientId()).bind(d,e)):g===Banana.Controls.EventTypes.CUSTOM_EVENT&&this.getPage().isRerendering&&(f?jQuery(this).bind(d,f,e):jQuery(this).bind(d,
e))}}};Banana.UiControl.prototype.unregisterEvents=function(){this.binds&&this.binds.length&&(this.debugEvent(3,name,"Unregister all event"),jQuery("#"+this.getClientId()).unbind(),jQuery(this).unbind())};
Banana.UiControl.prototype.setEnabled=function(a,b){this.triggerEvent("onSetEnabled",a);a?(this.enabled=!0,this.isRendered&&jQuery("#"+this.getClientId()).prop("disabled",!1)):(this.enabled=!1,this.isRendered&&jQuery("#"+this.getClientId()).prop("disabled",!0));if(b){var d=this.getControls(),e,f;e=0;for(f=d.length;e<f;e++)d[e].setEnabled&&d[e].setEnabled(a,b)}return this};Banana.UiControl.prototype.getEnabled=function(){return this.enabled};
Banana.UiControl.prototype.getHtml=function(a){var b;b=""+("<"+this.getTagName()+" ");b+=this.getHtmlAttributes();b+=">";var d=this.getControls(),e,f;e=0;for(f=d.length;e<f;e++)d[e]instanceof Banana.Control?b+=d[e].getHtml(a):"string"===typeof d[e]&&(b+=d[e]);this instanceof Banana.UiControl&&(b+="</"+this.getTagName()+">");a&&(this.isRendered=!0);return b};Banana.Controls={};Banana.Controls.Panel={};namespace("Banana.Controls").Panel=Banana.UiControl.extend({init:function(){this._super()}});Banana.Controls.Panel.prototype.getTagName=function(){return"div"};Banana.Page={};namespace("Banana").Page=Banana.Controls.Panel.extend({init:function(){this.triggerEvent("onInit");this.addCssClass("BPage");this._super();this.uniqueId=0;this.validators=[];this.dataSets=[];this.resizefunc||(this.resizefunc=this.getProxy(function(){this.onWindowResize(this)}));jQuery(window).bind("resize",this.resizefunc)}});Banana.Page.prototype.setApplication=function(a){this.application=a};Banana.Page.prototype.getApplication=function(){return this.application};
Banana.Page.prototype.run=function(a){this.validationControls={};this.initRender(this,a||this.getApplication().settings.renderTarget)};
Banana.Page.prototype.initRender=function(a,b,d,e,f){this.rendering=!0;e?(this.renderControl(a,b,d),this.rendering=!1,this.recursiveRegisterEvents(a)):(this.isRendered=!1,this.initializeControl(a,b),this.renderControl(a,b,d),this.isRendered=!0,this.setVisible(!0),a&&a.triggerEvent&&a.triggerEvent("renderComplete",this),f||(this.recursiveRegisterEvents(a),this.parentFirstTimeRendering=this.rendering=!1),this.recursiveUpdateDisplay(a))};
Banana.Page.prototype.rerender=function(a){var b=this.isRerendering,d=this.rendering;d&&!b&&(this.parentFirstTimeRendering=!0);this.isRerendering=!0;d||this.recursiveUnRegisterEvents(a);var e=a.getFirstUiControl(),f=e.getParent();this.initRender(a,f,e,b,d);this.isRerendering=b};Banana.Page.prototype.setContentPlaceHolder=function(a){this.contentPlaceHolder=a};Banana.Page.prototype.getContentPlaceHolder=function(){return this.contentPlaceHolder};
Banana.Page.prototype.setPageTemplate=function(a){this.contentPlaceHolder=a};Banana.Page.prototype.getPageTemplate=function(){return this.contentPlaceHolder};Banana.Page.prototype.hideLoader=function(){this.loader&&this.loader.hide()};Banana.Page.prototype.addDataSet=function(a,b){this.dataSets[a]?log.warning('Dataset id "'+a+'" already exists'):(b.id=a,this.dataSets[a]=b)};Banana.Page.prototype.getDataSet=function(a){return this.dataSets[a]};
Banana.Page.prototype.removeDataSets=function(){for(var a in this.dataSets)"function"!==typeof this.dataSets[a]&&this.dataSets[a].clear();this.dataSets=[]};Banana.Page.prototype.isValid=function(){return Banana.Util.ValidationManager.validateAll()};
Banana.Page.prototype.initializeControl=function(a,b){if(a instanceof Banana.Control){if(b instanceof Banana.Control)a.clientId||a.setClientId(b.getClientId()+"-"+this.uniqueId++);else{var d=this.getApplication().settings.applicationName;d?a.setClientId(d+this.uniqueId++):a.setClientId(this.uniqueId++)}a.setParent(b);a.setPage(this);a.isInitialized||(a.createComponents(),a.isInitialized=!0,(d=a.bindedDataSource)&&this.getDataSet(d[0])&&this.getDataSet(d[0]).bindControlToDataSource(a),(d=a.bindedData)&&
this.getDataSet(d[0])&&this.getDataSet(d[0]).bindControlToData(a));var d=a.getControls(),e,f;e=0;for(f=d.length;e<f;e++)this.initializeControl(d[e],a)}};Banana.Page.prototype.renderControl=function(a,b,d){a=a instanceof Banana.Control?a.getHtml(!0):a;d?Banana.Util.DomHelper.replace(a,d):Banana.Util.DomHelper.render(a,b)};Banana.Page.prototype.recursiveUpdateDisplay=function(a){if(a instanceof Banana.Control){a.isRendered=!0;a.updateDisplay();var a=a.getControls(),b,d;b=0;for(d=a.length;b<d;b++)this.recursiveUpdateDisplay(a[b])}};
Banana.Page.prototype.recursiveRegisterEvents=function(a){if(a instanceof Banana.Control){a.registerEvents();var a=a.getControls(),b,d;b=0;for(d=a.length;b<d;b++)this.recursiveRegisterEvents(a[b])}};Banana.Page.prototype.recursiveUnRegisterEvents=function(a){if(a instanceof Banana.Control&&(a.onPreInvalidateContents(),a.unregisterEvents(),a instanceof Banana.Control)){var a=a.getControls(),b,d;b=0;for(d=a.length;b<d;b++)this.recursiveUnRegisterEvents(a[b])}};
Banana.Page.prototype.removeControl=function(a,b){if(a instanceof Banana.Control){var d=a.controls.slice(),e;for(e=d.length-1;0<=e;e--)this.removeControl(d[e],!0),d.pop();a.unregisterEvents();a.unload();b||Banana.Util.DomHelper.remove(a);if(d=a.parent)e=d.controls.indexOf(a),d.controls.splice(e,1)}};Banana.Page.prototype.clearControl=function(a){var b=a.getControls().slice(),d=0,e,f;e=0;for(f=b.length;e<f;e++)d++,this.removeControl(b[e],!0);a.controls=null;jQuery("#"+a.getClientId()).empty()};
Banana.Page.prototype.remove=function(a,b){var d=Banana.Util.flattenTreeDepthFirst(this,"controls");d.pop();Banana.Util.arrayInteratorAsync(d,this.getProxy(function(a){if(a instanceof Banana.Control){a.unregisterEvents();a.unload();var b=a.parent;b&&b.controls&&b.controls.splice(b.controls.indexOf(a),1)}}),0,this.getProxy(function(){this.unload();Banana.Util.ValidationManager.removeValidators();this.clearIds();jQuery(window).unbind();this.unbind();this.removeDataSets();clearTimeout(this.timer);a||
Banana.Util.DomHelper.remove(this);jQuery("#debug").remove();clearTimeout(this.debugTimer);b&&b()}),this.getProxy(function(){}))};Banana.Page.prototype.removeDom=function(){jQuery("#cleared").remove()};Banana.Page.prototype.clearProps=function(){};Banana.Page.prototype.onWindowResize=function(a){if(a instanceof Banana.Control){a.onWindowResize();var a=a.getControls(),b,d;b=0;for(d=a.length;b<d;b++)this.onWindowResize(a[b])}};Banana.Page.prototype.clearIds=function(a){a||(a=this);Banana.Util.DomHelper.clearIdsFrom(a.getClientId())};Banana.PageTemplate={};
namespace("Banana").PageTemplate=Banana.Page.extend({init:function(){this._super();this.addCssClass("BPageTemplate");this.content=new Banana.Controls.Panel;this.content.addCssClass("BPageTemplateContent")},createComponents:function(){this.addControl(this.content)},run:function(){this.isRendered?this.triggerEvent("renderComplete",this):this._super();this.pageControl.setApplication(this.getApplication());this.pageControl.run(this.content)},addPageControl:function(a){a.setContentPlaceHolder(this);this.pageControl=
a}});Banana.Controls.StatusBar={};
namespace("Banana.Controls").StatusBar=Banana.Controls.Panel.extend({init:function(){this._super();this.addCssClass("BStatusBar");this.defaultTimeout=1E4},updateDisplay:function(){var a=jQuery("#"+this.getClientId()).detach();jQuery("body").append(a)},setSuccesMessage:function(a,b){var d={type:"ok"};d.timeout=b;d.message=a;this.setMessage(d);return this},setErrorMessage:function(a,b,d){var e={type:"error"};e.message=a;e.timeout=b;e.errors=d;this.setMessage(e);return this},setWarningMessage:function(a,
b){var d={type:"warning"};d.message=a;d.timeout=b;this.setMessage(d);return this},setInfoMessage:function(a,b){var d={type:"info"};d.message=a;d.timeout=b;this.setMessage(d);return this},setMessage:function(a){this.timeout&&clearTimeout(this.timeout);this.setCss({display:"block"});this.clear();this.removeCssClass("BStatusBarError");this.removeCssClass("BStatusBarSuccess");this.removeCssClass("BStatusBarWarning");this.removeCssClass("BStatusBarInfo");this.messageBar=new Banana.Controls.Panel;switch(a.type){case "ok":this.addCssClass("BStatusBarSuccess");
break;case "warning":this.addCssClass("BStatusBarWarning");break;case "error":this.addCssClass("BStatusBarError");break;case "info":this.addCssClass("BStatusBarInfo")}var b=new Banana.Controls.Label;b.addCssClass("title");b.setData(a.message);this.messageBar.addControl(b);this.addControl(this.messageBar);b=new Banana.Controls.Panel;b.addCssClass("messages");if(a.errors&&a.errors.length)for(var d=0;d<a.errors.length;d++)a.errors[d].message&&b.addControl("<li>"+a.errors[d].message+" </li>");this.messageBar.addControl(b);
this.invalidateDisplay();0!==a.timeout&&void 0!==a.timeout&&(this.timeout=setTimeout(this.getProxy(this.hide),a.timeout||this.defaultTimeout));return this},hide:function(){this.setCss({display:"none"});this.messageBar&&this.messageBar.setVisible(!1);return this}});Banana.Controls.DataControls={};Banana.Controls.DataControls.DataControl={};namespace("Banana.Controls").DataControl=Banana.Controls.Panel.extend({init:function(){this._super();this.addCssClass("BDataControl");this.isChanged=!1},updateDisplay:function(){this._super();this.setDomData(this.data)}});Banana.Controls.DataControl.prototype.setData=function(a,b,d){this.data=a;b||this.triggerEvent("dataChanged",a);d||this.setDomData(a);return this};Banana.Controls.DataControl.prototype.getData=function(){return this.data};
Banana.Controls.DataControl.prototype.setDomData=function(a){this.isRendered&&void 0!==this.data&&Banana.Util.DomHelper.setData(a,this)};Banana.Controls.DataControl.prototype.getDomData=function(){if(this.isRendered)return Banana.Util.DomHelper.getData(this)};
Banana.Controls.DataControl.prototype.dataSetBind=function(a,b){this.bindedData=[a,b];a instanceof Banana.Data.DataSet?a.bindControlToData(this):this.isRendered&&this.getPage().getDataSet(bd[0])&&this.getPage().getDataSet(bd[0]).bindControlToData(this);return this};Banana.Controls.DataControl.prototype.unDataSetBind=function(a){this.bindedData=null;a instanceof Banana.Data.DataSet?a.bindControlToData(this):a=this.getPage().getDataSet(a);a.unBindControl(this);return this};Banana.Controls.DataControls.InputControl={};namespace("Banana.Controls").InputControl=Banana.Controls.DataControl.extend({init:function(){this._super();this.bind("change",this.getProxy(this.onChange))}});Banana.Controls.InputControl.prototype.focus=function(){jQuery("#"+this.clientId).focus();return this};Banana.Controls.InputControl.prototype.onChange=function(){this.setData(this.getDomData(),!1,!0);this.isChanged=!0};Banana.Controls.InputControl.prototype.getTagName=function(){return"input"};
Banana.Controls.InputControl.prototype.setValue=function(a){this.value=a;return this};Banana.Controls.InputControl.prototype.getValue=function(){return this.value};Banana.Controls.InputControl.prototype.setName=function(a){this.name=a;return this};Banana.Controls.InputControl.prototype.getName=function(){return this.name};Banana.Controls.DataControls.TextBox={};namespace("Banana.Controls").TextBox=Banana.Controls.InputControl.extend({init:function(){this.data="";this._super();this.setAttribute("type","text");this.addCssClass("BTextbox");this.bind("keyup",this.getProxy(this.onChange));this.bind("keypress",function(a){return 13!=a.keyCode})}});Banana.Controls.DataControls.Password={};namespace("Banana.Controls").Password=Banana.Controls.TextBox.extend({init:function(){this._super();this.setAttribute("type","password")}});Banana.Controls.DataControls.TextArea={};namespace("Banana.Controls").TextArea=Banana.Controls.InputControl.extend({init:function(){this.data="";this._super();this.setAttribute("type","text");this.addCssClass("BTextbox");this.bind("keyup",this.getProxy(function(){this.setData(Banana.Util.DomHelper.getData(this),!1,!0)}))}});Banana.Controls.TextArea.prototype.getTagName=function(){return"textarea"};Banana.Controls.DataControls.CheckBox={};namespace("Banana.Controls").CheckBox=Banana.Controls.InputControl.extend({init:function(){this._super();this.setAttribute("type","checkbox");this.addCssClass("BCheckbox");this.setData(!1);this.bind("change",this.getProxy(this.onChange))},setDomData:function(a){this.isRendered&&Banana.Util.DomHelper.setCheckBoxData(a,this)},getDomData:function(){if(this.isRendered)return Banana.Util.DomHelper.getCheckBoxData(this)}});Banana.Controls.DataControls.Table={};namespace("Banana.Controls").Table=Banana.Controls.DataControl.extend({init:function(){this._super();this.addCssClass("table")}});Banana.Controls.Table.prototype.getTagName=function(){return"table"};namespace("Banana.Controls").TableRow=Banana.Controls.DataControl.extend({init:function(){this._super()}});Banana.Controls.TableRow.prototype.getTagName=function(){return"tr"};namespace("Banana.Controls").TableCol=Banana.Controls.DataControl.extend({init:function(){this._super()}});
Banana.Controls.TableCol.prototype.getTagName=function(){return"td"};namespace("Banana.Controls").TableHeaderCol=Banana.Controls.TableCol.extend({init:function(){this._super()}});Banana.Controls.TableHeaderCol.prototype.getTagName=function(){return"th"};namespace("Banana.Controls").TableHead=Banana.Controls.Panel.extend({init:function(){this._super()}});Banana.Controls.TableHead.prototype.getTagName=function(){return"thead"};namespace("Banana.Controls").TableBody=Banana.Controls.Panel.extend({init:function(){this._super()}});
Banana.Controls.TableBody.prototype.getTagName=function(){return"tbody"};Banana.Controls.DataControls.Label={};namespace("Banana.Controls").Label=Banana.Controls.DataControl.extend({init:function(){this._super();this.addCssClass("BLabel");this.tagName="label"},setData:function(a,b,d){this._super(a,!0,d);this.addControl(a);return this},setTagName:function(a){this.tagName=a;return this},getTagName:function(){return this.tagName}});Banana.Controls.Label.prototype.setForControl=function(a){this.setAttribute("for",a.clientId)};
Banana.Controls.Label.prototype.setDomData=function(a){this.isRendered&&(void 0==a&&(a=""),Banana.Util.DomHelper.setTextData(a,this))};Banana.Controls.DataControls.LimitCharLabel={};namespace("Banana.Controls").LimitCharLabel=Banana.Controls.Label.extend({init:function(){this._super()},setCharLimit:function(a){this.charLimit=a;return this},setData:function(a,b,d){this.charLimit&&(a&&a.length>this.charLimit)&&(this.setAttribute("title",a),a=a.substr(0,this.charLimit)+"...");return this._super(a,b,d)}});Banana.Controls.DataControls.DatePicker={};
namespace("Banana.Controls").DatePicker=Banana.Controls.DataControl.extend({init:function(){this._super();this.addCssClass("BDatePicker");this.textBox=(new Banana.Controls.TextBox).addCssClass("BDatePickerTextBox")},createComponents:function(){this.addControl(this.textBox);this.textBox.bind("dataChanged",this.getProxy(function(){this.triggerEvent("dataChanged",this.textBox.getData())}))},setData:function(a,b,d){if(null==a)return this.textBox.setData(null),this;if(void 0==a)return this;if(isNaN(a))this.textBox.setData(a,
b,d),Banana.Util.DomHelper.setData("",this);else{var e=new Banana.Util.DateTimecode;e.setTimecode(a);this.textBox.setData(e.getLocalDate("%d-%m-%Y"),b,d)}return this},setMinimumDate:function(a){this.isRendered?jQuery("#"+this.textBox.clientId).datepicker("option","minDate",new Date(a.getTimecode())):this.minDate=a;return this},setReturnType:function(a){this.returnType=a;return this},getData:function(){var a=this.textBox.getData();if("timecode"==this.returnType){if(a){var b=new Banana.Util.DateTimecode;
b.setLocalDate(a);return b.getTimecode().toString()}}else return a},unload:function(){jQuery("#"+this.textBox.clientId).datepicker("hide");jQuery("#"+this.textBox.clientId).datepicker("destroy")},updateDisplay:function(){this._super();jQuery("#"+this.textBox.getClientId()).datepicker({dateFormat:"dd-mm-yy",minDate:this.minDate?new Date(this.minDate.getTimecode()):new Date(0),beforeShow:function(){setTimeout(function(){jQuery("#ui-datepicker-div").css("z-index","9999999")},200)}})}});Banana.Controls.DataControls.DateTimePicker={};
namespace("Banana.Controls").DateTimePicker=Banana.Controls.DataControl.extend({init:function(){this._super();this.addCssClass("BDateTimePicker");this.dateCtrl=(new Banana.Controls.DatePicker).addCssClass("BDateTimePickerDateControl");this.timeCtrl=(new Banana.Controls.MaskedTextBox).setMask("99:99:99").addCssClass("BDateTimePickerTimeControl");this.defaultTime="00:00:00:00";this.resultFormat="date"},updateDisplay:function(){!this.timeCtrl.getData()&&this.defaultTime&&this.timeCtrl.setData(this.defaultTime)},
setMinimumDate:function(a){this.dateCtrl.setMinimumDate(a);return this},getTimeControl:function(){return this.timeCtrl},getDateControl:function(){return this.dateCtrl},createComponents:function(){this.addControl(this.dateCtrl);this.addControl(this.timeCtrl);this.dateCtrl.bind("dataChanged",this.getProxy(function(){var a=this.getData();a!=this.previousData&&(this.previousData=a,this.triggerEvent("dataChanged"))}));this.timeCtrl.bind("dataChanged",this.getProxy(function(){var a=this.getData();a!=this.previousData&&
(this.previousData=a,this.triggerEvent("dataChanged"))}))},setData:function(a,b,d){this._super(a);a&&(a=a.split(" "),this.dateCtrl.setData(a[0],b,d),this.timeCtrl.setData(a[1],b,d));return this},setReturnType:function(a){this.resultFormat=a;return this},getData:function(){var a=this.dateCtrl.getData(),b=this.timeCtrl.getData();if(!a)return!1;b=b?b.match(/_/)?"00:00:00:00":b+":00":"00:00:00:00";this.data=[a,b].join(" ");return"tc"==this.resultFormat?(a=new Banana.Util.DateTimecode,a.setLocalDateTime(this._super()),
a.getTimecode()):this._super()},setDateFormat:function(a){this.resultFormat=a;return this}});Banana.Controls.DataControls.DateSpan={};
namespace("Banana.Controls").DateSpan=Banana.Controls.DataControl.extend({init:function(){this._super();this.addCssClass("BDateSpan");this.amount=(new Banana.Controls.DropDown).setDataSource({1:"1",2:"2",3:"3",4:"4",5:"5",6:"6",7:"7",8:"8",9:"9",10:"10"}).setStyle("width:45px;margin-right:4px;").bind("dataChanged",this.getProxy(function(){var a=1<this.amount.getData()?"s":"";this.unit.setDataSource({days:"day"+a,weeks:"week"+a,months:"month"+a})}));this.addControl(this.amount);this.unit=(new Banana.Controls.DropDown).setStyle("width:80px;");
this.addControl(this.unit);this.setData("1 day")},setData:function(a){if(a)return a=a.split(" "),this.amount.setData(a[0]),this.unit.setData(a[1]),this},getData:function(){return this.amount.getData()+" "+this.unit.getData()}});Banana.Controls.DataControls.Image={};namespace("Banana.Controls").Image=Banana.Controls.DataControl.extend({init:function(){this._super()}});Banana.Controls.Image.prototype.setImage=function(a){this.setAttribute("src",a);return this};Banana.Controls.Image.prototype.setTitle=function(a){this.setAttribute("title",a);return this};Banana.Controls.Image.prototype.getTagName=function(){return"img"};Banana.Controls.Image.prototype.setDomData=function(a){jQuery("#"+this.getClientId()).attr({src:a})};Banana.Controls.DataControls.RadioButton={};namespace("Banana.Controls").RadioButton=Banana.Controls.InputControl.extend({init:function(){this._super();this.setAttribute("type","radio");this.addCssClass("BRadioButton")},setName:function(a){this.setAttribute("name",a);return this},setDomData:function(a){this.isRendered&&Banana.Util.DomHelper.setCheckBoxData(a,this);return this},getDomData:function(){if(this.isRendered)return Banana.Util.DomHelper.getCheckBoxData(this)}});Banana.Controls.DataControls.ProgressBar={};
namespace("Banana.Controls").ProgressBar=Banana.Controls.DataControl.extend({init:function(){this._super();this.addCssClass("BProgressBar");this.data=0;this.bar=new Banana.Controls.Panel;this.bar.addCssClass("BProgressBarBar");this.addControl(this.bar);this.colorBlend=new Banana.Util.Color;this.color1||this.setBeginColor("#88ff88");this.color2||this.setEndColor("#ff8888")},setBeginColor:function(a){this.color1=new Banana.Util.Color(a);return this},setEndColor:function(a){this.color2=new Banana.Util.Color(a);
return this},updateDisplay:function(){var a=this.data/100;this.colorBlend.setH(a*this.color2.getH()+(1-a)*this.color1.getH());this.colorBlend.setS(a*this.color2.getS()+(1-a)*this.color1.getS());this.colorBlend.setV(a*this.color2.getV()+(1-a)*this.color1.getV());this.bar.setCss({width:this.data+"%","background-color":this.colorBlend.getValue()})},setData:function(a,b,d){a=Math.min(100,Math.max(0,Math.round(a)));this._super(a,b,d);this.updateDisplay();return this}});Banana.Controls.DataControls.Timecode={};namespace("Banana.Controls").Timecode=Banana.Controls.DataControl.extend({init:function(a){this._super();this.addCssClass("BTimecode");this.ctrl=(new Banana.Controls.MaskedTextBox).setMask(a||"99:99:99:99");this.addControl(this.ctrl)},setData:function(a){this.ctrl.setData(a);return this},getData:function(){return this.ctrl.getData()},setEnabled:function(a){this.ctrl.setEnabled(a);return this},getEnabled:function(){return this.ctrl.getEnabled()}});Banana.Controls.DataControls.ListControls={};Banana.Controls.DataControls.ListControls.ListControl={};namespace("Banana.Controls").ListControl=Banana.Controls.DataControl.extend({init:function(){this._super();this.dataKeyField="key";this.dataValueField="value";this.dataDepthField="depth"}});Banana.Controls.ListControl.prototype.setDataSource=function(a,b){this.datasource=a;this.invalidateDisplay();b||this.triggerEvent("dataSourceChanged",a);return this};
Banana.Controls.ListControl.prototype.getDataSource=function(){return this.datasource};Banana.Controls.ListControl.prototype.dataSetSourceBind=function(a,b){this.bindedDataSource=[a,b];a instanceof Banana.Data.DataSet&&a.bindControlToDataSource(this);return this};Banana.Controls.ListControl.prototype.setDataKeyField=function(a){this.dataKeyField=a;return this};Banana.Controls.ListControl.prototype.setDataValueField=function(a){this.dataValueField=a;return this};
Banana.Controls.ListControl.prototype.setDataDepthField=function(a){this.dataDepthField=a;return this};Banana.Controls.DataControls.ListControls.CustomListControl={};namespace("Banana.Controls").CustomListControl=Banana.Controls.ListControl.extend({init:function(){this._super()}});Banana.Controls.CustomListControl.prototype.setDomData=function(){};Banana.Controls.CustomListControl.prototype.createControls=function(){};
Banana.Controls.CustomListControl.prototype.setData=function(a,b,d){this.data="string"!=typeof a?a?newObject=JSON.parse(JSON.stringify(a)):a:a;d||(this.clear(),this.createControls(),this.invalidateDisplay());return this};Banana.Controls.CustomListControl.prototype.setDataSource=function(a){this.datasource=a;this.clear();this.createControls();this.invalidateDisplay();this.triggerEvent("onSetDataSource");return this};Banana.Controls.DataControls.ListControls.RadioButtonList={};
namespace("Banana.Controls").RadioButtonList=Banana.Controls.CustomListControl.extend({init:function(){this._super();this.addCssClass("BRadioButtonList")},createControls:function(){this.panel=new Banana.Controls.Panel;this.panel.addCssClass("BRadioButtonListItemContainer");for(var a in this.datasource)if("function"!=typeof this.datasource[a]){var b=new Banana.Controls.RadioButton;b.setId(a);b.setValue(a);this.getGroupName()&&b.setName(this.getGroupName());b.bind("change",this.getProxy(function(a){this.onCheckBoxChanged(a.data);
this.triggerEvent("dataChanged",this.getData())}),b);null!=this.data&&a==this.data&&b.setData(!0);b=(new Banana.Controls.Decorators.LabelDecoratorRight(b)).setData(this.datasource[a]);this.panel.addControl(b)}this.addControl(this.panel);this.addControl('<div style="clear:both;"></div>')},setGroupName:function(a){this.groupName=a;return this},getGroupName:function(){return this.groupName},onCheckBoxChanged:function(a){this.data=a.getValue();this.isChanged=!0}});Banana.Controls.DataControls.ListControls.CheckBoxList={};namespace("Banana.Controls").CheckboxList=Banana.Controls.CustomListControl.extend({init:function(){this._super();this.addCssClass("BCheckBoxList")}});
Banana.Controls.CheckboxList.prototype.createControls=function(){this.panel=new Banana.Controls.Panel;this.panel.addCssClass("BCheckBoxListItemContainer");this.checkboxReferences=[];for(var a in this.datasource)if("function"!=typeof this.datasource[a]){var b=new Banana.Controls.CheckBox;b.setEnabled(this.enabled);this.checkboxReferences.push(b);this.datasource[a][this.dataKeyField]?b.setValue(this.datasource[a][this.dataKeyField]):b.setValue(a);b.setId(a);b.bind("change",this.getProxy(function(){this.isChanged=
!0;this.data=this.getData();this.triggerEvent("dataChanged",this.data)}),b);if(this.data)for(var d=0,e=this.data.length;d<e;d++)if(this.datasource[a][this.dataKeyField])if(this.datasource[a][this.dataKeyField]==this.data[d][this.dataKeyField]){b.setData(!0);break}else{if(this.datasource[a][this.dataKeyField]==this.data[d]){b.setData(!0);break}}else if(a==this.data[d]){b.setData(!0);break}b=new Banana.Controls.Decorators.LabelDecoratorRight(b);this.datasource[a][this.dataValueField]?b.setData(this.datasource[a][this.dataValueField]):
b.setData(this.datasource[a]);this.panel.addControl(b)}this.addControl(this.panel);this.addControl('<div style="clear:both;"></div>')};Banana.Controls.CheckboxList.prototype.getData=function(){for(var a=[],b=0,d=this.checkboxReferences.length;b<d;b++)this.checkboxReferences[b].data&&a.push(this.checkboxReferences[b].getValue());return a};/*
  xxx
 @version 0.0.1
 @package Banana.Controls

 Dropdown component

 use setDataSource() to create a a list
 use setData() to select indices

*/
Banana.Controls.DataControls.ListControls.DropDown={};
namespace("Banana.Controls").DropDown=Banana.Controls.ListControl.extend({init:function(){this._super();this.addCssClass("BDropDown");this.optGroupField="group";this.bind("change",this.getProxy(function(){this.setData(Banana.Util.DomHelper.getData(this)||[]);this.isChanged=!0;this.triggerEvent("selectionChanged")}));this.bind("mousedown",function(a){a.stopPropagation()})},updateDisplay:function(){this._super();if(this.getPromptText()&&this.isRendered){var a=jQuery("#"+this.getClientId())[0];a&&-1==
a.selectedIndex&&(a.selectedIndex=0)}},getData:function(){return"__prompt__"==this._super()?void 0:this._super()},setData:function(a){if((null===a||void 0===a)&&this.getPromptText())a="__prompt__";return this._super(a)},setDataByIndex:function(a){var b=0,d;for(d in this.datasource)if("function"!=typeof this.datasource[d]){if(b==a){this.datasource[d][this.dataKeyField]?this.setData(this.datasource[d][this.dataKeyField]):this.setData(d);break}b++}return this}});
Banana.Controls.DropDown.prototype.getTagName=function(){return"select"};
Banana.Controls.DropDown.prototype.getHtml=function(){var a=[];a.push("<"+this.getTagName()+" ");a.push(this.getHtmlAttributes());a.push(">");var b=this.datasource;this.getPromptText()&&a.push(this.getOption("__prompt__",this.getPromptText()));var d=null,e=!1,f;for(f in b)if("function"!=typeof b[f])if("object"==typeof b[f]){if(b[f]){for(var g=b[f].group,h=b[f][this.dataKeyField],j=b[f][this.dataValueField],m=0;m<b[f][this.dataDepthField];m++)j="&nbsp;&nbsp;&nbsp;&nbsp;"+j;g!=d&&(a.push('<optgroup label="'+
g+'">'),e=!0);a.push(this.getOption(h,j));!e&&g!=d&&(a.push("</optgroup>"),e=!1);d=g}}else j=f,b instanceof Array&&(j=b[f]),a.push(this.getOption(j,b[f]));a.push("</"+this.getTagName()+">");return a.join("")};Banana.Controls.DropDown.prototype.setPromptText=function(a){this.promptText=a;return this};Banana.Controls.DropDown.prototype.getPromptText=function(){return this.promptText};Banana.Controls.DropDown.prototype.setOptGroupField=function(a){this.optGroupField=a;return this};
Banana.Controls.DropDown.prototype.getOptGroupField=function(){return this.optGroupField};Banana.Controls.DropDown.useOptGrouping=function(){this.optGrouping=!0;return this};Banana.Controls.DropDown.prototype.getOption=function(a,b){var d="";if(this.data==a||"__prompt__"==a&&void 0==this.data)d="selected=selected";return"<option "+d+' class="BDropDownOption" value="'+a+'">'+b+"</option>"};
Banana.Controls.DropDown.prototype.getOptGroup=function(a,b){var d="";this.getData()==a&&(d="selected=selected");return"<option "+d+' class="BDropDownOption" value="'+a+'">'+b+"</option>"};Banana.Controls.DataControls.ListControls.MultiSelect={};namespace("Banana.Controls").MultiSelect=Banana.Controls.DropDown.extend({init:function(){this._super();this.addCssClass("BMultiSelect");this.optGroupField="group"},getAttributes:function(){var a=this._super();a.multiple="multiple";return a}});Banana.Controls.DataControls.Slider={};
namespace("Banana.Controls").Slider=Banana.Controls.DataControl.extend({init:function(){this._super();this.addCssClass("BSlider");this.min=this.stepSize=1;this.max=10;this.orientation="horizontal";this.bind("slide",this.getProxy(function(a,b){this.setData(b.value,!1,!0)}))},setData:function(a,b,d){this._super(a,b,d);d||this.updateElement();return this},getDomEventTypes:function(){var a=this._super();a.push("create");a.push("slide");a.push("change");a.push("slidestop");a.push("slidestart");return a},
updateElement:function(){if(this.isRendered){var a={};a.step=this.stepSize;a.min=this.min;a.max=this.max;this.getData()&&(a.value=this.getData());jQuery("#"+this.getClientId()).slider(a)}},updateDisplay:function(){this.updateElement()},setStepSize:function(a){this.stepSize=a;return this},setMin:function(a){this.min=a;return this},setMax:function(a){this.max=a;return this},setOrientation:function(a){this.orientation=a;return this}});Banana.Controls.DataControls.UnorderedList={};namespace("Banana.Controls").UnorderedList=Banana.Controls.DataControl.extend({init:function(){this._super()}});Banana.Controls.UnorderedList.prototype.getTagName=function(){return"ul"};namespace("Banana.Controls").ListItem=Banana.Controls.DataControl.extend({init:function(){this._super()}});Banana.Controls.ListItem.prototype.getTagName=function(){return"li"};Banana.Controls.DataGridBaseListRender={};
namespace("Banana.Controls").DataGridBaseListRender=Banana.Controls.CustomListControl.extend({init:function(){this._super();this.addCssClass("BDataGridListRender");this.indexItemRenderFactory=[];this.indexKey="id";this.useAutoIndexing=!1;this.autoIndexKey="__uid__";this.selectedIndices=new Banana.Util.ArrayBiCollection;this.indexDataMap=[];this.indexRenderedItemRenderMap=[]},getRenderedItemRenderByIndex:function(a){return this.indexRenderedItemRenderMap[a]},getRenderedItemRenders:function(){return this.indexRenderedItemRenderMap},
createComponents:function(){this.setupIndexing();this._super()},setupIndexing:function(){return!this.indexKey?(this.useAutoIndexing=!0,this.indexKey=this.autoIndexKey,!0):!1},getUid:function(){return(68719476736*(1+Math.random())|0).toString(16).substring(1)},applyUid:function(a){this.useAutoIndexing&&!a[this.indexKey]&&(a[this.indexKey]=this.getUid())},rerender:function(){this.clear();this.createControls();this.invalidateDisplay()},unload:function(){this._super();this.selectedIndices.clear();this.indexDataMap=
this.selectedIndices=void 0},setItemIndexKey:function(a){this.indexKey=a;return this},addSelectedIndex:function(a){this.selectIndex(a);this.selectedIndices.addItem(a,!0)},clearSelectedIndices:function(){this.selectedIndices.each(this.getProxy(function(a){a=this.selectedIndices.getKeyByIndex(a);this.deSelectIndex(a)}));this.selectedIndices.clear()},clearSelectedIndex:function(a){this.deSelectIndex(a);this.selectedIndices.remove(a)},getSelectedIndices:function(a){if(a){var b=[];this.selectedIndices.each(this.getProxy(function(a){a=
this.selectedIndices.getKeyByIndex(a);b.push(a)}));return b}return this.selectedIndices},getIndexIsSelected:function(a){return this.selectedIndices.getItemByKey(a)?!0:!1},setSelectedItems:function(a){i=0;for(len=a.length;i<len;i++){var b=0,d;for(d in this.datasource)"function"!==typeof this.datasource[d]&&(a[i]&&this.datasource[d][this.indexKey]===a[i][this.indexKey]&&this.addSelectedIndex(b),b++)}},moveSelectedItemsUp:function(){var a=[];this.selectedIndices.each(this.getProxy(function(b){a.push(this.selectedIndices.getKeyByIndex(b))}));
if(a.length){a.sort();var b=a.length,d=a[0]-1;if(!(0>d)){var e=this.datasource[d];this.datasource.splice(d,1);this.datasource.splice(d+b,0,e);this.setDataSource(this.datasource);return this}}},moveSelectedItemsDown:function(){var a=[];this.selectedIndices.each(this.getProxy(function(b){a.push(this.selectedIndices.getKeyByIndex(b))}));if(a.length){a.sort();var b=a[a.length-1]+1;if(!(b+1>this.datasource.length)){var d=this.datasource[b];this.datasource.splice(b,1);this.datasource.splice(a[0],0,d);this.setDataSource(this.datasource);
return this}}},selectPreviousFromList:function(){var a=this.listRender.getSelectedIndices(!0);this.listRender.clearSelectedIndices();a.length?(a=Math.max(0,a[0]-1),this.listRender.addSelectedIndex(a)):this.listRender.addSelectedIndex(a.length-1);return this},selectNextFromList:function(){var a=this.listRender.getSelectedIndices(!0);this.listRender.clearSelectedIndices();a.length?(a=Math.min(this.listRender.datasource.length-1,a[0]+1),this.listRender.addSelectedIndex(a)):this.listRender.addSelectedIndex(0);
return this},getSelectedKeys:function(){var a=[];this.selectedIndices.each(this.getProxy(function(b){b=this.selectedIndices.getKeyByIndex(b);a.push(this.indexDataMap[b][this.indexKey])}));return a},removeSelectedItems:function(){var a=this.getSelectedItems();this.clearSelectedIndices();var b,d;b=0;for(d=a.length;b<d;b++){var e=this.indexDataMap.indexOf(a[b]);this.indexDataMap.splice(e,1);this.removeItem(a[b],e)}},getSelectedItems:function(){var a=[];this.selectedIndices.each(this.getProxy(function(b){b=
this.selectedIndices.getKeyByIndex(b);a.push(this.indexDataMap[b])}));return a},addItem:function(a){var b=0;this.datasource?b=this.datasource.length:this.datagrid.setDataSource([]);this.datasource[b]=a;this.indexDataMap[b]=a;this.triggerEvent("dataSourceChanged");return b},removeItem:function(a){var b=null,d,e;d=0;for(e=this.datasource.length;d<e;d++)a[this.indexKey]===this.datasource[d][this.indexKey]&&(this.selectedIndices.remove(d),b=d);null!==b&&(this.datasource.splice(b,1),this.triggerEvent("dataSourceChanged"));
return b},hasItem:function(a){k=0;for(len=this.datasource.length;k<len;k++)if(a[this.indexKey]===this.datasource[k][this.indexKey])return!0;return!1},removeAllItems:function(){this.datasource=[];this.selectedIndices.clear()},selectIndex:function(){},deSelectIndex:function(){},createControls:function(){this.setupIndexing();var a,b;a=0;for(b=this.datasource.length;a<b;a++)this.indexDataMap[a]=this.datasource[a]},getObject:function(a){"function"===typeof a&&(a=new a);return a}});Banana.Controls.ItemRender={};namespace("Banana.Controls").DataGridItemRender=Banana.Control.extend({init:function(){this._super();this.listRender=null},setListRender:function(a){this.listRender=a},getListRender:function(){return this.listRender},setRowIndex:function(a){this.rowIndex=a},getRowIndex:function(){return this.listRender.getIndexByRow(this.parent)},getIsSelectable:function(){return!1},setData:function(a,b){this.data=a;b||this.triggerEvent("dataChanged",a);return this},getData:function(){return this.data}});Banana.Controls.DataGridTableItemRender={};namespace("Banana.Controls").DataGridTableItemRender=Banana.Controls.DataGridItemRender.extend({init:function(){this._super()}});Banana.Controls.DataGridTableHeaderItemRender={};
namespace("Banana.Controls").DataGridTableHeaderItemRender=Banana.Controls.DataGridTableItemRender.extend({init:function(){this._super()},createComponents:function(){for(var a=this.listRender.columns,b=0,d=a.length;b<d;b++){var e=new Banana.Controls.DataGridHeaderCol;!1!=a[b].visible&&(e.sortField=a[b].sortField,e.setStyle("text-align:left;"+a[b].getStyle()),a[b].sortField&&(e.setStyle("cursor:pointer;text-align:left;"+a[b].getHeaderStyle()),e.bind("click",this.getProxy(function(a){this.listRender.triggerEvent("sort",
a.data)}),a[b].sortField)),e.addControl(a[b].getHeaderText()),this.addControl(e))}}});Banana.Controls.DataGridTableContentItemRender={};
namespace("Banana.Controls").DataGridTableContentItemRender=Banana.Controls.DataGridTableItemRender.extend({init:function(){this._super()},createComponents:function(){this.createColumns(this)},createColumns:function(a){for(var b=this.listRender.columns,d=0,e=b.length;d<e;d++){var f=b[d];if(!1!=f.visible){var g=f.getControl();f.getDataField()&&g.setData(Banana.Util.getDataByPath(this.getData(),f.getDataField()));f.listRender=this.listRender;var h=new Banana.Controls.TableCol;h.setStyle(f.getStyle());
h.attributes=f.attributes;h.addControl(g);a.addControl(h);f.triggerEvent("onItemCreated",{control:g,data:this.getData()})}}},select:function(){this.getListRender().getRowByItemRender(this).addCssClass("BDataGridTableListRenderSelected")},deselect:function(){this.getListRender().getRowByItemRender(this).removeCssClass("BDataGridTableListRenderSelected")},mouseOver:function(){this.getListRender().getRowByItemRender(this).addCssClass("BDataGridTableListRenderMouseover")},mouseOut:function(){this.getListRender().getRowByItemRender(this).removeCssClass("BDataGridTableListRenderMouseover")},
getIsSelectable:function(){return!0}});Banana.Controls.DataGridTableFooterItemRender={};namespace("Banana.Controls").DataGridTableFooterItemRender=Banana.Controls.DataGridTableItemRender.extend({init:function(){this._super()},createComponents:function(){}});Banana.Controls.DataControls.ListControls.DataGrid={};Banana.Controls.DataControls.ListControls.DataGrid.ColumnControls={};Banana.Controls.DataControls.ListControls.DataGrid.ColumnControls.DataGridColumn={};namespace("Banana.Controls").DataGridColumn=Banana.Control.extend({init:function(){this._super();this.attributes={}},getControl:function(){return new Banana.Controls.Label},setCurrentIndexCreation:function(a){this.currentIndexCreation=a}});
Banana.Controls.DataGridColumn.prototype.setData=function(a){this.data=a;return this};Banana.Controls.DataGridColumn.prototype.getData=function(){return this.data};Banana.Controls.DataGridColumn.prototype.setSortField=function(a){this.sortField=a;return this};Banana.Controls.DataGridColumn.prototype.setHeaderText=function(a){this.headerText=a;return this};Banana.Controls.DataGridColumn.prototype.getHeaderText=function(){return this.headerText};
Banana.Controls.DataGridColumn.prototype.setDataField=function(a){this.dataField=a;return this};Banana.Controls.DataGridColumn.prototype.getDataField=function(){return this.dataField};Banana.Controls.DataGridColumn.prototype.setListRender=function(a){this.listRender=a;return this};Banana.Controls.DataGridColumn.prototype.getListRender=function(){return this.listRender};Banana.Controls.DataGridColumn.prototype.setOwnerRow=function(a){this.ownerRow=a;return this};
Banana.Controls.DataGridColumn.prototype.getOwnerRow=function(){return this.ownerRow};Banana.Controls.DataGridColumn.prototype.setHeaderStyle=function(a){this.headerStyle=a;return this};Banana.Controls.DataGridColumn.prototype.getHeaderStyle=function(){return this.headerStyle};Banana.Controls.DataGridColumn.prototype.setStyle=function(a){this.style=a;return this};Banana.Controls.DataGridColumn.prototype.getStyle=function(){return this.style};
Banana.Controls.DataGridColumn.prototype.setVisible=function(a){this.visible=a;return this};Banana.Controls.DataGridColumn.prototype.getVisible=function(){return this.visible};Banana.Controls.DataGridColumn.prototype.setAttribute=function(a,b){this.attributes[a]=b;return this};Banana.Controls.DataControls.ListControls.DataGrid.ColumnControls.DataGridControlColumn={};namespace("Banana.Controls").DataGridControlColumn=Banana.Controls.DataGridColumn.extend({init:function(a){this.control=a},getControl:function(){var a=Banana.Util.Clone(this.control);a.generateUniqueId();a.customId=!1;a.binds=[];a.controls=[];return a}});Banana.Controls.DataControls.ListControls.DataGrid.ColumnControls.DataGridCharLimitColumn={};namespace("Banana.Controls").DataGridCharLimitColumn=Banana.Controls.DataGridColumn.extend({init:function(){this._super()},getControl:function(){return(new Banana.Controls.LimitCharLabel).setCharLimit(this.charLimit)}});Banana.Controls.DataGridCharLimitColumn.prototype.setCharLimit=function(a){this.charLimit=a;return this};Banana.Controls.DataControls.ListControls.DataGrid.ColumnControls.DataGridImageButtonColumn={};namespace("Banana.Controls").DataGridImageButtonColumn=Banana.Controls.DataGridColumn.extend({init:function(){this._super()}});
Banana.Controls.DataGridImageButtonColumn.prototype.getControl=function(){var a=new Banana.Controls.Image;a.setCss({cursor:"pointer"});a.setImage(this.imageUrl);a.bind("click",this.getProxy(function(b){function d(a){return a instanceof Banana.Controls.DataGridTableItemRender?a:d(a.getParent())}var e=d(a),e=this.listRender.getIndexByItemRender(e);b.stopPropagation();this.listRender.triggerEvent("onCommand",{commandName:this.commandName,index:e,data:this.listRender.datasource[e]})}));return a};
Banana.Controls.DataGridImageButtonColumn.prototype.setImageUrl=function(a){this.imageUrl=a;return this};Banana.Controls.DataGridImageButtonColumn.prototype.setCommandName=function(a){this.commandName=a;return this};Banana.Controls.DataControls.ListControls.DataGrid.ColumnControls.DataGridLinkColumn={};namespace("Banana.Controls").DataGridLinkColumn=Banana.Controls.DataGridColumn.extend({init:function(){this._super()}});Banana.Controls.DataGridLinkColumn.prototype.getControl=function(){return this.link=new Banana.Controls.Link};Banana.Controls.DataGridLinkColumn.prototype.setHref=function(a){this.href=a;this.link&&this.link.setHref(a);return this};Banana.Controls.DataControls.ListControls.DataGrid.ColumnControls.DataGridImageColumn={};namespace("Banana.Controls").DataGridImageColumn=Banana.Controls.DataGridColumn.extend({init:function(){this._super()}});Banana.Controls.DataGridImageColumn.prototype.getControl=function(){this.image=new Banana.Controls.Image;this.imageStyle&&this.image.setStyle(this.imageStyle);return this.image};
Banana.Controls.DataGridImageColumn.prototype.setImageStyle=function(a){this.imageStyle=a;this.image&&this.image.setStyle(a);return this};Banana.Controls.DataControls.ListControls.DataGrid.ColumnControls.DataGridStatusColumn={};namespace("Banana.Controls").DataGridStatusColumn=Banana.Controls.DataGridColumn.extend({init:function(){this._super()}});Banana.Controls.DataGridStatusColumn.prototype.getControl=function(){return this.c=new Banana.Controls.DataControl};
Banana.Controls.DataGridStatusColumn.prototype.setStatus=function(a,b){var d="bluedot.png";switch(a){case 1:d="greendot.png";break;case 0:d="orangedot.png";break;case -1:d="reddot.png";break;case -2:d="blackdot.png"}var e=new Banana.Controls.Image;e.setCss({"float":"left","margin-top":"4px","margin-right":"4px"});e.setImage(Banana.Application.settings.imagedir+"/"+d);d=new Banana.Controls.Label;d.addCssClass("BDataGridStatusColumnText");d.setCss({"float":"left"});d.setData(b||"");this.c.addControl(e);
this.c.addControl(d)};Banana.Controls.DataControls.ListControls.DataGrid.ColumnControls.DataGridHeaderColumn={};namespace("Banana.Controls").DataGridHeaderCol=Banana.Controls.TableHeaderCol.extend({init:function(){this._super()},createComponents:function(){this._super();this.bind("click",this.getProxy(function(){this.triggerEvent("clicked",this)}))}});Banana.Controls.DataControls.ListControls.DataGrid.ColumnControls.DataGridButtonColumn={};namespace("Banana.Controls").DataGridButtonColumn=Banana.Controls.DataGridColumn.extend({init:function(){this._super();this.buttonText=""},setButtonText:function(a){this.buttonText=a;return this}});
Banana.Controls.DataGridButtonColumn.prototype.getControl=function(){var a=new Banana.Controls.Button;a.setText(this.buttonText);a.bind("click",this.getProxy(function(b){function d(a){return a instanceof Banana.Controls.DataGridTableItemRender?a:d(a.getParent())}var e=d(a),e=this.listRender.getIndexByItemRender(e);b.stopPropagation();this.listRender.triggerEvent("onCommand",{commandName:this.commandName,index:e,data:this.listRender.datasource[e]})}));return a};
Banana.Controls.DataGridButtonColumn.prototype.setCommandName=function(a){this.commandName=a;return this};Banana.Controls.DataGridTableListRender={};
namespace("Banana.Controls").DataGridTableListRender=Banana.Controls.DataGridBaseListRender.extend({init:function(){this._super();this.addCssClass("BDataGridTableListRender");this.columns=[];this.indexRowMap=[];this.dataItemRenderMap=new Banana.Util.ArrayBiCollection;this.defaultHeaderItemRender=Banana.Controls.DataGridTableHeaderItemRender;this.defaultContentItemRender=Banana.Controls.DataGridTableContentItemRender;this.defaultFooterItemRender=Banana.Controls.DataGridTableFooterItemRender;this.headerItemRender=
this.contentItemRender=this.headerItemRender=null},addItem:function(a,b){var d=this._super(a);b&&(this.indexItemRenderFactory[d]=b);this.createRowByIndex(d,!0);this.createItemRenderByIndex(d,!0);return d},removeItem:function(a){a=this._super(a);0<=a&&this.removeRowByIndex(a)},removeAllItems:function(){this._super();this.indexRowMap=[];this.indexItemRenderFactory=[];this.tableBody.clear()},getDefaultItemRender:function(){return this.defaultContentItemRender},setHeaderItemRender:function(a){this.headerItemRender=
a},getHeaderItemRender:function(){return this.headerItemRender||this.defaultHeaderItemRender},setItemRenderByIndex:function(a,b,d,e){this.indexItemRenderFactory[a]=b;!e&&this.datasource[a]&&this.datasource[a][this.indexKey]&&this.dataItemRenderMap.addItem(this.datasource[a][this.indexKey],b);d||(this.clearRowByIndex(a),this.createItemRenderByIndex(a,!0),this.triggerEvent("itemRenderChanged"))},setItemRenderByIndices:function(a,b){if(a)if(!a instanceof Array)log.error("Calling setItemRenderByIndices without indices specified in listrender "+
this.id);else{for(var d=4<a.length,e=0;e<a.length;e++)this.setItemRenderByIndex(a[e],b,d);d&&(this.triggerEvent("itemRenderChanged"),this.rerender())}},setItemRender:function(a){if(!this.isInitialized)return this.defaultContentItemRender=a,this;this.dataItemRenderMap.clear();for(var b=0,d=this.indexRenderedItemRenderMap.length;b<d;b++)this.setItemRenderByIndex(b,a,!0);this.tableBody.clear();this.createTableParts();this.isRendered&&this.tableBody.invalidateDisplay();this.triggerEvent("itemRenderChanged");
return this},hasItemRenderAt:function(a,b){return this.indexRenderedItemRenderMap[a]instanceof b?!0:!1},setFooterItemRender:function(a){this.footerItemRender=a},getFooterItemRender:function(){return this.footerItemRender},getRowByItemRender:function(a){return this.getRowByIndex([this.indexRenderedItemRenderMap.indexOf(a)])},getRowByIndex:function(a){return this.indexRowMap[a]},removeRowByIndex:function(a){this.indexRowMap[a].remove();this.selectedIndices.remove(i);this.indexRowMap.splice(a,1);this.indexItemRenderFactory.splice(a,
1);this.indexRenderedItemRenderMap.splice(a,1)},clearRowByIndex:function(a){this.indexRowMap[a].clear()},getIndexByRow:function(a){return this.indexRowMap.indexOf(a)},getIndexByItemRender:function(a){return this.indexRowMap.indexOf(a.parent)},getItemRenderByData:function(){},setColumns:function(a){this.columns=a},createControls:function(){(!this.columns||!this.columns.length)&&log.warning("Unable to render grid "+this.id+". No columns specified");for(var a=0;a<this.columns.length;a++)this.triggerEvent("onInitColumn",
this.columns[a]);this.previousSelectedItems=this.getSelectedItems();this.selectedIndices.clear();this._super();this.table=new Banana.Controls.Table;this.table.setAttribute("cellspacing","0");this.tableHead=new Banana.Controls.TableHead;this.tableHead.addCssClass("BDataGridTableListHead");this.table.addControl(this.tableHead);this.tableBody=new Banana.Controls.TableBody;this.tableBody.addCssClass("BDataGridTableListBody");this.table.addControl(this.tableBody);this.table.bind("mousedown",this.getProxy(function(a){(a.originalEvent.shiftKey||
a.originalEvent.ctrlKey)&&a.preventDefault()}));for(var a=0,b=this.columns.length;a<b;a++)this.columns[a].setListRender(this);this.createTableParts();this.addControl(this.table);this.setSelectedItems(this.previousSelectedItems)},createTableParts:function(){this.datasource.length&&(this.createHeader(),this.createRows(),this.createFooter())},createHeader:function(){var a=new Banana.Controls.TableRow,b=this.getObject(this.getHeaderItemRender());b.setListRender(this);a.addControl(b);this.tableHead.addControl(a)},
createRows:function(){for(var a=0,b=this.datasource.length;a<b;a++)this.createRowByIndex(a),this.createItemRenderByIndex(a)},createFooter:function(){if(this.getFooterItemRender()){var a=new Banana.Controls.TableRow,b=this.getObject(this.getFooterItemRender());b.setListRender(this);a.addControl(b);this.tableBody.addControl(a)}},createRowByIndex:function(a,b){var d=new Banana.Controls.TableRow;d.addCssClass(a%2?"BDataGridTableListRenderRow":"BDataGridTableListRenderRowAlt");d.bind("mouseover",this.getProxy(function(a){this.onRowMouseOver(a)}),
d);d.bind("mouseout",this.getProxy(function(a){this.onRowMouseOut(a)}),d);d.bind("click",this.getProxy(function(b){this.triggerEvent("onRowClicked",{data:this.datasource[a],index:a});this.onRowMouseClick(b)}),d);this.tableBody.addControl(d,b);b&&this.tableBody.invalidateDisplay();this.indexRowMap[a]=d;this.triggerEvent("onRowCreated",{index:a,row:d,data:this.datasource[a]})},createItemRenderByIndex:function(a,b){this.currentIndexCreation=a;var d=null,d=this.datasource[a][this.indexKey]&&this.dataItemRenderMap.getItem(this.datasource[a][this.indexKey])?
this.dataItemRenderMap.getItem(this.datasource[a][this.indexKey]):this.indexItemRenderFactory[a]?this.indexItemRenderFactory[a]:this.defaultContentItemRender,e=this.getObject(d);e.setData(this.datasource[a]);e.bind("dataChanged",this.getProxy(function(a){this.getDataSource()[parseInt(a.data)]=a.currentTarget.getData();this.triggerEvent("dataSourceChanged")}),a.toString());this.dataItemRenderMap.addItem(this.datasource[a][this.indexKey],d);this.indexRenderedItemRenderMap[a]=e;e.setListRender(this);
d=this.indexRowMap[a];d.addControl(e);b&&d.invalidateDisplay();this.currentIndexCreation=void 0},onRowMouseOver:function(a){a=this.indexRowMap.indexOf(a.data);a=this.indexRenderedItemRenderMap[a];a.getIsSelectable()&&a.mouseOver()},onRowMouseOut:function(a){a=this.indexRowMap.indexOf(a.data);a=this.indexRenderedItemRenderMap[a];a.getIsSelectable()&&a.mouseOut()},onRowMouseClick:function(a){var b=this.indexRowMap.indexOf(a.data);if(this.indexRenderedItemRenderMap[b].getIsSelectable()&&!(0>b)){var d=
a.ctrlKey,a=a.shiftKey;if(this.getIndexIsSelected(b))!d&&!a?this.clearSelectedIndices():this.clearSelectedIndex(b);else if("single"==this.selectionType)this.clearSelectedIndices(),this.addSelectedIndex(b);else if(!d&&!a&&(this.clearSelectedIndices(),this.addSelectedIndex(b)),d&&this.addSelectedIndex(b),a){(d=parseInt(this.selectedIndices.getKeyByIndex(0)))||(d=0);b>d||(d=b,b=parseInt(this.selectedIndices.getKeyByIndex([this.selectedIndices.getLength()-1])));this.clearSelectedIndices();for(d=parseInt(d);d<=
parseInt(b);d++)this.addSelectedIndex(d)}this.triggerEvent("onItemSelect")}},selectIndex:function(a){(a=this.getRenderedItemRenderByIndex(a))&&("function"==typeof a.select&&a.getIsSelectable())&&a.select()},deSelectIndex:function(a){(a=this.getRenderedItemRenderByIndex(a))&&"function"==typeof a.deselect&&a.deselect()}});Banana.Controls.DataGridTileItemRender={};
namespace("Banana.Controls").DataGridTileItemRender=Banana.Controls.DataGridItemRender.extend({init:function(){this._super()},createComponents:function(){if("string"==typeof this.data){var a=new Banana.Controls.Panel;a.addControl(this.data);this.addControl(a)}},select:function(){this.getListRender().getItemRenderPlaceHolderByItemRender(this).addCssClass("BDataGridTileTilePlaceHolderSelected")},deselect:function(){this.getListRender().getItemRenderPlaceHolderByItemRender(this).removeCssClass("BDataGridTileTilePlaceHolderSelected")},mouseOver:function(){},
mouseOut:function(){}});Banana.Controls.DataGridTileListRender={};
namespace("Banana.Controls").DataGridTileListRender=Banana.Controls.DataGridBaseListRender.extend({init:function(){this._super();this.addCssClass("BDataGridTileListRender");this.indexKey=null;this.indexTilePlaceHolderMap=[];this.dataItemRenderMap=new Banana.Util.ArrayBiCollection;this.defaultContentItemRender=Banana.Controls.DataGridTileItemRender;this.contentItemRender=null},addItem:function(a,b){this.applyUid(a);var d=this._super(a);b&&(this.indexItemRenderFactory[d]=b);this.clearSelectedIndices();
this.createDivPlaceHolder(this.datasource.length-1,!0);this.createItemRenderByIndex(this.datasource.length-1,!0);return d},addItems:function(a){var b;b=0;for(len=a.length;b<len;b++)this.addItem(a[b])},addItemAt:function(a,b,d,e){this.applyUid(a);this.clearSelectedIndices();this.datasource.splice(b,0,a);this.indexDataMap.splice(b,0,a);d&&this.indexItemRenderFactory.splice(b,0,a);this.indexTilePlaceHolderMap.splice(b,0,null);this.indexItemRenderFactory.splice(b,0,null);this.indexRenderedItemRenderMap.splice(b,
0,null);e||(this.setDataSource(this.datasource),this.triggerEvent("dataSourceChanged"))},addItemsAt:function(a,b,d){var e;e=0;for(len=a.length;e<len;e++)this.addItemAt(a[e],b,d,!0);this.setDataSource(this.datasource)},removeItem:function(a){a=this.datasource.indexOf(a);-1!=a&&this.removeItemRenderPlaceHolderByIndex(a)},removeItemByItemRender:function(a){a=this.indexRenderedItemRenderMap.indexOf(a);this.removeItemRenderPlaceHolderByIndex(a)},removeAllItems:function(){this._super()},getDefaultItemRender:function(){return this.defaultContentItemRender},
setItemRenderByIndex:function(a,b,d,e){this.indexItemRenderFactory[a]=b;!e&&this.datasource&&this.datasource[a]&&this.datasource[a][this.indexKey]&&this.dataItemRenderMap.addItem(this.datasource[a][this.indexKey],b);d||(this.clearItemRenderPlaceHolderByIndex(a),this.createItemRenderByIndex(a,!0),this.triggerEvent("itemRenderChanged"))},setItemRenderByIndices:function(a,b){if(a.length){var d=4<a.length,e;for(e=0;e<a.length;e++)this.setItemRenderByIndex(a[e],b,d);d&&(this.triggerEvent("itemRenderChanged"),
this.rerender())}},setItemRender:function(a){this.dataItemRenderMap.clear();var b;b=0;for(clen=this.indexRenderedItemRenderMap.length;b<clen;b++)this.setItemRenderByIndex(b,a,!0);this.mainContainer?(this.mainContainer.clear(),this.createItems(),this.isRendered&&this.mainContainer.invalidateDisplay()):this.defaultContentItemRender=a;this.triggerEvent("itemRenderChanged")},rerenderIndex:function(a){this.previousSelectedItems=this.getSelectedItems();this.indexTilePlaceHolderMap[a].clear();this.createItemRenderByIndex(a,
!0);this.setSelectedItems(this.previousSelectedItems)},getRenderedItemRenderByData:function(){},hasItemRenderAt:function(a,b){return this.indexRenderedItemRenderMap[a]instanceof b?!0:!1},removeItemRenderPlaceHolderByIndex:function(a){this.datasource.splice(a,1);this.indexTilePlaceHolderMap[a].remove();this.selectedIndices.remove(i);this.indexTilePlaceHolderMap.splice(a,1);this.indexItemRenderFactory.splice(a,1);this.indexRenderedItemRenderMap.splice(a,1);this.triggerEvent("dataSourceChanged")},clearItemRenderPlaceHolderByIndex:function(a){this.indexTilePlaceHolderMap[a].clear()},
getIndexByItemRenderPlaceHolder:function(a){return this.indexTilePlaceHolderMap.indexOf(a)},getItemRenderPlaceHolderByIndex:function(a){return this.indexTilePlaceHolderMap[a]},getItemRenderPlaceHolderByItemRender:function(a){return this.indexTilePlaceHolderMap[this.indexRenderedItemRenderMap.indexOf(a)]},getIndexByItemRender:function(a){return this.indexTilePlaceHolderMap.indexOf(a.parent)},createControls:function(){this.setupIndexing();this.previousSelectedItems=this.getSelectedItems();this.selectedIndices.clear();
this._super();this.mainContainer=new Banana.Controls.Panel;this.mainContainer.bind("mousedown",this.getProxy(function(a){(a.originalEvent.shiftKey||a.originalEvent.ctrlKey)&&a.preventDefault()}));this.createItemsLater=!1;this.horizontalItemCount&&this.isRendered?this.createItems():this.horizontalItemCount&&!this.isRendered?this.createItemsLater=!0:this.createItems();this.addControl(this.mainContainer);this.setSelectedItems(this.previousSelectedItems)},updateDisplay:function(){this.createItemsLater&&
this.getDemensions().width&&(this.createItemsLater=!1,this.createItems(),this.mainContainer.invalidateDisplay())},createItems:function(){if(this.datasource.length){var a;a=0;for(len=this.datasource.length;a<len;a++)this.applyUid(this.datasource[a]),this.createDivPlaceHolder(a),this.triggerEvent("onPreCreateItemRender",{index:a,data:this.datasource[a]}),this.createItemRenderByIndex(a);this.mainContainer.addControl("<div style='clear:both'></div>");this.cachedDemensions=null}},setHorizontalTileCount:function(){log.warning("set horizontalTileCount datagridTileListRender is depricated. use setPlaceHolderWidth instead");
return this},setTilePadding:function(){log.warning("set tile padding in datagridTileListRender is depricated. apply style manualy in css");return this},createDivPlaceHolder:function(a,b){var d=new Banana.Controls.Panel;d.addCssClass("BDataGridTilePlaceHolder");this.placeHolderWidth&&d.setCss({width:this.placeHolderWidth});d.bind("mouseenter",this.getProxy(function(a){this.onRowMouseOver(a);return!0}),d);d.bind("mouseleave",this.getProxy(function(a){this.onRowMouseOut(a);return!0}),d);d.bind("click",
this.getProxy(function(a){this.onRowMouseClick(a);return!0}),d);this.mainContainer.addControl(d,b);b&&this.mainContainer.invalidateDisplay();this.indexTilePlaceHolderMap[a]=d},setPlaceHolderWidth:function(a){this.placeHolderWidth=a},createItemRenderByIndex:function(a,b){this.currentIndexCreation=a;var d=null,e=this.datasource[a][this.indexKey],d=e&&this.dataItemRenderMap.getItem(e)?this.dataItemRenderMap.getItem(e):this.indexItemRenderFactory[a]?this.indexItemRenderFactory[a]:this.defaultContentItemRender,
e=this.getObject(d);e.setData(this.datasource[a]);e.bind("dataChanged",this.getProxy(function(a){this.getDataSource()[parseInt(a.data,10)]=a.currentTarget.getData();this.triggerEvent("dataSourceChanged")}),a.toString());this.dataItemRenderMap.addItem(this.datasource[a][this.indexKey],d);this.indexRenderedItemRenderMap[a]=e;e.setListRender(this);d=this.indexTilePlaceHolderMap[a];d.addControl(e);b&&d.invalidateDisplay();this.currentIndexCreation=void 0},onRowMouseOver:function(a){a=this.indexTilePlaceHolderMap.indexOf(a.data);
this.indexRenderedItemRenderMap[a].mouseOver()},onRowMouseOut:function(a){a=this.indexTilePlaceHolderMap.indexOf(a.data);this.indexRenderedItemRenderMap[a].mouseOut()},onRowMouseClick:function(a){var b=this.indexTilePlaceHolderMap.indexOf(a.data);if(this.indexRenderedItemRenderMap[b].getIsSelectable()&&!(0>b)){var d=a.ctrlKey,a=a.shiftKey;if(this.getIndexIsSelected(b))!d&&!a?this.clearSelectedIndices():this.clearSelectedIndex(b);else if("single"===this.selectionType)this.clearSelectedIndices(),this.addSelectedIndex(b);
else if(!d&&!a&&(this.clearSelectedIndices(),this.addSelectedIndex(b)),d&&this.addSelectedIndex(b),a){(d=parseInt(this.selectedIndices.getKeyByIndex(0),10))||(d=0);b>d||(d=b,b=parseInt(this.selectedIndices.getKeyByIndex([this.selectedIndices.getLength()-1]),10));this.clearSelectedIndices();for(d=parseInt(d,10);d<=parseInt(b,10);d++)this.addSelectedIndex(d)}this.triggerEvent("onItemSelect")}},selectIndex:function(a){(a=this.getRenderedItemRenderByIndex(a))&&("function"==typeof a.select&&a.getIsSelectable())&&
a.select()},deSelectIndex:function(a){(a=this.getRenderedItemRenderByIndex(a))&&"function"==typeof a.deselect&&a.deselect()}});
namespace("Banana.Controls").DataGridTileListRender2=Banana.Controls.DataGridBaseListRender.extend({init:function(){this._super();this.addCssClass("BDataGridTileListRender");this.indexKey=null;this.indexTilePlaceHolderMap=[];this.dataItemRenderMap=new Banana.Util.ArrayBiCollection;this.defaultContentItemRender=Banana.Controls.DataGridTileItemRender;this.contentItemRender=null},addItem:function(a,b){this.applyUid(a);var d=this._super(a);b&&(this.indexItemRenderFactory[d]=b);this.clearSelectedIndices();
this.createDivPlaceHolder(this.datasource.length-1,!0);this.createItemRenderByIndex(this.datasource.length-1,!0);return d},addItems:function(a){var b;b=0;for(len=a.length;b<len;b++)this.addItem(a[b])},addItemAt:function(a,b,d,e){this.applyUid(a);this.clearSelectedIndices();this.datasource.splice(b,0,a);this.indexDataMap.splice(b,0,a);d&&this.indexItemRenderFactory.splice(b,0,a);this.indexTilePlaceHolderMap.splice(b,0,null);this.indexItemRenderFactory.splice(b,0,null);this.indexRenderedItemRenderMap.splice(b,
0,null);e||(this.setDataSource(this.datasource),this.triggerEvent("dataSourceChanged"))},addItemsAt:function(a,b,d){var e;e=0;for(len=a.length;e<len;e++)this.addItemAt(a[e],b,d,!0);this.setDataSource(this.datasource)},removeItem:function(a){a=this.datasource.indexOf(a);-1!=a&&this.removeItemRenderPlaceHolderByIndex(a)},removeItemByItemRender:function(a){a=this.indexRenderedItemRenderMap.indexOf(a);this.removeItemRenderPlaceHolderByIndex(a)},removeAllItems:function(){this._super()},getDefaultItemRender:function(){return this.defaultContentItemRender},
setItemRenderByIndex:function(a,b,d,e){this.indexItemRenderFactory[a]=b;!e&&this.datasource&&this.datasource[a]&&this.datasource[a][this.indexKey]&&this.dataItemRenderMap.addItem(this.datasource[a][this.indexKey],b);d||(this.clearItemRenderPlaceHolderByIndex(a),this.createItemRenderByIndex(a,!0),this.triggerEvent("itemRenderChanged"))},setItemRenderByIndices:function(a,b){if(a.length){var d=4<a.length,e;for(e=0;e<a.length;e++)this.setItemRenderByIndex(a[e],b,d);d&&(this.triggerEvent("itemRenderChanged"),
this.rerender())}},setItemRender:function(a){this.dataItemRenderMap.clear();var b;b=0;for(clen=this.indexRenderedItemRenderMap.length;b<clen;b++)this.setItemRenderByIndex(b,a,!0);this.mainContainer?(this.mainContainer.clear(),this.createItems(),this.isRendered&&this.mainContainer.invalidateDisplay()):this.defaultContentItemRender=a;this.triggerEvent("itemRenderChanged")},rerenderIndex:function(a){this.previousSelectedItems=this.getSelectedItems();this.indexTilePlaceHolderMap[a].clear();this.createItemRenderByIndex(a,
!0);this.setSelectedItems(this.previousSelectedItems)},getRenderedItemRenderByData:function(){},hasItemRenderAt:function(a,b){return this.indexRenderedItemRenderMap[a]instanceof b?!0:!1},removeItemRenderPlaceHolderByIndex:function(a){this.datasource.splice(a,1);this.indexTilePlaceHolderMap[a].remove();this.selectedIndices.remove(i);this.indexTilePlaceHolderMap.splice(a,1);this.indexItemRenderFactory.splice(a,1);this.indexRenderedItemRenderMap.splice(a,1);this.triggerEvent("dataSourceChanged")},clearItemRenderPlaceHolderByIndex:function(a){this.indexTilePlaceHolderMap[a].clear()},
getIndexByItemRenderPlaceHolder:function(a){return this.indexTilePlaceHolderMap.indexOf(a)},getItemRenderPlaceHolderByIndex:function(a){return this.indexTilePlaceHolderMap[a]},getItemRenderPlaceHolderByItemRender:function(a){return this.indexTilePlaceHolderMap[this.indexRenderedItemRenderMap.indexOf(a)]},getIndexByItemRender:function(a){return this.indexTilePlaceHolderMap.indexOf(a.parent)},createControls:function(){this.setupIndexing();this.previousSelectedItems=this.getSelectedItems();this.selectedIndices.clear();
this._super();this.mainContainer=new Banana.Controls.Panel;this.mainContainer.bind("mousedown",this.getProxy(function(a){(a.originalEvent.shiftKey||a.originalEvent.ctrlKey)&&a.preventDefault()}));this.createItemsLater=!1;this.horizontalItemCount&&this.isRendered?this.createItems():this.horizontalItemCount&&!this.isRendered?this.createItemsLater=!0:this.createItems();this.addControl(this.mainContainer);this.setSelectedItems(this.previousSelectedItems)},updateDisplay:function(){this.createItemsLater&&
this.getDemensions().width&&(this.createItemsLater=!1,this.createItems(),this.mainContainer.invalidateDisplay())},createItems:function(){if(this.datasource.length){var a;a=0;for(len=this.datasource.length;a<len;a++)this.applyUid(this.datasource[a]),this.createDivPlaceHolder(a),this.triggerEvent("onPreCreateItemRender",{index:a,data:this.datasource[a]}),this.createItemRenderByIndex(a);this.mainContainer.addControl("<div style='clear:both'></div>");this.cachedDemensions=null}},setTilePadding:function(){log.warning("set tile padding in datagridTileListRender is depricated. apply style manualy in css");
return this},createDivPlaceHolder:function(a,b){var d=new Banana.Controls.Panel;d.bind("mouseenter",this.getProxy(function(a){this.onRowMouseOver(a);return!0}),d);d.bind("mouseleave",this.getProxy(function(a){this.onRowMouseOut(a);return!0}),d);d.bind("click",this.getProxy(function(a){this.onRowMouseClick(a);return!0}),d);this.mainContainer.addControl(d,b);b&&this.mainContainer.invalidateDisplay();this.indexTilePlaceHolderMap[a]=d},setPlaceHolderWidth:function(a){this.placeHolderWidth=a},createItemRenderByIndex:function(a,
b){this.currentIndexCreation=a;var d=null,e=this.datasource[a][this.indexKey],d=e&&this.dataItemRenderMap.getItem(e)?this.dataItemRenderMap.getItem(e):this.indexItemRenderFactory[a]?this.indexItemRenderFactory[a]:this.defaultContentItemRender,e=this.getObject(d);e.setData(this.datasource[a]);e.bind("dataChanged",this.getProxy(function(a){this.getDataSource()[parseInt(a.data,10)]=a.currentTarget.getData();this.triggerEvent("dataSourceChanged")}),a.toString());this.dataItemRenderMap.addItem(this.datasource[a][this.indexKey],
d);this.indexRenderedItemRenderMap[a]=e;e.setListRender(this);d=this.indexTilePlaceHolderMap[a];d.addControl(e);b&&d.invalidateDisplay();this.currentIndexCreation=void 0},onRowMouseOver:function(a){a=this.indexTilePlaceHolderMap.indexOf(a.data);this.indexRenderedItemRenderMap[a].mouseOver()},onRowMouseOut:function(a){a=this.indexTilePlaceHolderMap.indexOf(a.data);this.indexRenderedItemRenderMap[a].mouseOut()},onRowMouseClick:function(a){var b=this.indexTilePlaceHolderMap.indexOf(a.data);if(this.indexRenderedItemRenderMap[b].getIsSelectable()&&
!(0>b)){var d=a.ctrlKey,a=a.shiftKey;if(this.getIndexIsSelected(b))!d&&!a?this.clearSelectedIndices():this.clearSelectedIndex(b);else if("single"===this.selectionType)this.clearSelectedIndices(),this.addSelectedIndex(b);else if(!d&&!a&&(this.clearSelectedIndices(),this.addSelectedIndex(b)),d&&this.addSelectedIndex(b),a){(d=parseInt(this.selectedIndices.getKeyByIndex(0),10))||(d=0);b>d||(d=b,b=parseInt(this.selectedIndices.getKeyByIndex([this.selectedIndices.getLength()-1]),10));this.clearSelectedIndices();
for(d=parseInt(d,10);d<=parseInt(b,10);d++)this.addSelectedIndex(d)}this.triggerEvent("onItemSelect")}},selectIndex:function(a){(a=this.getRenderedItemRenderByIndex(a))&&("function"==typeof a.select&&a.getIsSelectable())&&a.select()},deSelectIndex:function(a){(a=this.getRenderedItemRenderByIndex(a))&&"function"==typeof a.deselect&&a.deselect()}});Banana.Controls.DataGridTreeListHolder={};
namespace("Banana.Controls").DataGridTreeListHolder=Banana.Controls.Panel.extend({init:function(){this._super();this.maximizeAutoWidth=!1;this.toggleHolder=(new Banana.Controls.Panel).setStyle("float:left;clear:both;height:20px;width:20px;");this.itemRenderHolder=(new Banana.Controls.Panel).setStyle("float:left;");this.childsHolder=(new Banana.Controls.Panel).setStyle("float:left;clear:both;");this.buttonHolder=(new Banana.Controls.Panel).setStyle("float:left;clear:both;");this.addControl(this.toggleHolder);
this.addControl(this.itemRenderHolder);this.addControl(this.childsHolder);this.addControl(this.buttonHolder)},getItemRenderHolder:function(){return this.itemRenderHolder},getToggleHolder:function(){return this.toggleHolder},getChildHolder:function(){return this.childsHolder},getButtonHolder:function(){return this.buttonHolder},updateDisplay:function(){if(this.maximizeAutoWidth){var a=this.listRender.getDimensions();if(a.offset){var b=a.offset.left,a=a.width,b=this.itemRenderHolder.getDimensions().offset.left-
b;this.itemRenderHolder.setCss({width:a-b-20+"px"})}}},getItemRender:function(){return!this.itemRenderHolder?null:this.itemRenderHolder.controls[0]},getToggle:function(){return this.toggleHolder.controls[0]}});
namespace("Banana.Controls").DataGridTreeListRootHolder=Banana.Controls.Panel.extend({init:function(){this._super();this.childsHolder=(new Banana.Controls.Panel).setStyle("float:left;clear:both;");this.buttonHolder=(new Banana.Controls.Panel).setStyle("float:left;clear:both;");this.addControl(this.itemRenderHolder);this.addControl(this.childsHolder);this.addControl(this.buttonHolder)},getItemRender:function(){return null}});/*
   xxx
 @version   0.0.1
 @package   Banana

 Node toggle used in advanced datagrid tree list

*/
Banana.Controls.DataGridTreeListNodeToggle={};
namespace("Banana.Controls").DataGridTreeListNodeToggle=Banana.Controls.Panel.extend({createComponents:function(){this.createImage();this.bind("click",this.getProxy(function(){this.on=this.on?!1:!0;this.triggerEvent("toggle",this.on);this.createImage()}))},createImage:function(){this.on?(this.removeCssClass("BDataGridTreeNodeClosed"),this.addCssClass("BDataGridTreeNodeOpen")):(this.removeCssClass("BDataGridTreeNodeOpen"),this.addCssClass("BDataGridTreeNodeClosed"))},setOn:function(a){this.on=a;return this}});Banana.Controls.DataGridTreeItemRender={};
namespace("Banana.Controls").DataGridTreeItemRender=Banana.Controls.DataGridItemRender.extend({init:function(){this._super()},createComponents:function(){this.panel=(new Banana.Controls.Panel).setStyle("float:left;");this.panel.addCssClass("BDataGridTreeItemRender");this.label=(new Banana.Controls.Label).setStyle("float:left;");this.panel.addControl(this.label);this.addControl(this.panel)},updateDisplay:function(){this.listRender.getNodeDataByData(this.data);this.data&&(this.data.name&&this.label)&&
this.label.setData(this.data.name)},select:function(){this.panel.addCssClass("BDataGridTreeItemRenderSelected")},deselect:function(){this.panel.removeCssClass("BDataGridTreeItemRenderSelected")},getIsSelectable:function(){return!0}});Banana.Controls.DataGridTreeListRender={};
namespace("Banana.Controls").DataGridTreeListRender=Banana.Controls.DataGridBaseListRender.extend({init:function(){this._super();this.addCssClass("BDataGridTree");this.indexKey=null;this.nodeData=[];this.columns=[];this.dataItemRenderMap=new Banana.Util.ArrayBiCollection;this.keyDataIndex=[];this.dataKeyIndex=[];this.indexHolderMap=[];this.indexOrder=[];this.sortFunc=null;this.childRequestSizeLimit=20;this.childKey="children";this.rootNodeVisible=!0;this.defaultContentItemRender=Banana.Controls.DataGridTreeItemRender},
setDefaultItemRender:function(a){this.defaultContentItemRender=a},setIndexItemRender:function(a,b){if("function"!==typeof b)throw"Item render should be a factory";this.indexItemRenderFactory[a]=b;return this},setDefaultOpen:function(a){this.defaultOpen=a;return this},toLogger:function(){this.debug&&console.log(arguments)},setSortfunction:function(a){this.sortFunc=a;return this},setItemRenderByIndex:function(a,b,d,e){this.indexItemRenderFactory[a]=b;var f=this.getDataSourceByIndex(a);!e&&f&&this.dataItemRenderMap.addItem(f[this.indexKey],
b);!d&&this.getHolder(a)&&(this.createItemRenderByIndex(a,!0,!0),this.triggerEvent("itemRenderChanged"))},setMaximizeNodeWidth:function(a){this.maximizeNodeWidth=a;return this},setChildProperty:function(a){this.childKey=a;return this},setChildRequestSizeLimit:function(a){this.childRequestSizeLimit=a;return this},hasItemIndexKey:function(a){return this.keyDataIndex[a]?!0:!1},getDataSourceByKey:function(a){(a=this.keyDataIndex[a])||(a=this.getDataSourceByIndex(0));return a},getNodeDataByData:function(a){return this.nodeData[a[this.indexKey]]},
ensureRootData:function(){if(!this.rootData){this.setupIndexing();var a={};a[this.indexKey]=this.getUid();a[this.childKey]=this.datasource;this.rootData=a;this.setNodeDataByData({addedChildren:[],isRoot:!0,open:!0},a)}},setNodeData:function(a){this.ensureRootData();this.setNodeDataByData(a,this.rootData)},getNodeData:function(){return this.getNodeDataByData(this.rootData)},setNodeDataByData:function(a,b){if(b){this.applyUid(b);var d=b[this.indexKey]}else d="__root__";this.nodeData[d]=a},getRenderedItemRenderByData:function(a){a=
this.getNodeDataByData(a);return!a?null:this.getRenderedItemRenderByIndex(a.index)},getDataSourceByIndex:function(a){if(!this.datasource)return null;var a=a.toString(),a=a.split("-"),b=null,d=this.datasource,e;for(e=0;e<a.length;e++){b=d[a[e]];d=b[this.indexKey];if(!b||!this.nodeData[d])break;d=b[this.childKey];if(!d)break}return b},getIndexByDataSource:function(a){return this.dataKeyIndex[a[this.indexKey]]},getParentIndex:function(a){a=a.toString().split("-");a.pop();return a.length?a.join("-"):
null},getHolder:function(a){return this.indexHolderMap[a]},getParentHolder:function(a){return(a=this.getParentIndex(a))?this.indexHolderMap[a]:null},createControls:function(){try{this.setupIndexing(),this.ensureRootData(),this.getNodeDataByData(this.nodeData),this.rootData[this.childKey]=this.datasource,this.datasource=[this.rootData],this.toLogger("create Controls",this.datasource),this.toLogger("determined key index as",this.indexKey),this.bind("mousedown",this.getProxy(function(a){(a.originalEvent.shiftKey||
a.originalEvent.ctrlKey)&&a.preventDefault()})),this.createNodeInfo(this.datasource,null,this.getProxy(function(a){this.defaultOpen&&(this.nodeData[a[this.indexKey]].open=!0)})),this.createNodes(),this.restoreSelectedIndices(),this.addControl('<div style="clear:both"></div>')}catch(a){console.log(a.message)}},restoreSelectedIndices:function(){var a=0,b,d=this.getSelectedIndices(!0),a=0;for(b=d.length;a<b;a++){var e=this.getRenderedItemRenderByIndex(d[a]);e&&e.select()}},createNodeInfo:function(a,
b,d){this.sortFunc&&a.sort(this.sortFunc);var e,f;e=0;for(f=a.length;e<f;e++){var g=a[e];this.applyUid(g);var h=g[this.indexKey];this.toLogger("create nodeinfo for key ",h,this.indexKey);this.nodeData[h]||(this.nodeData[h]=[]);"function"===typeof d&&d(g);this.nodeData[h].addedChildren||(this.nodeData[h].addedChildren=[]);null!==b&&void 0!==b?(currentIndex=b+"-"+e,this.nodeData[h].hasParent=!0,1===b.toString().split("-").length&&(this.nodeData[h].parentIsRoot=!0)):(currentIndex=e,this.nodeData[h].hasParent=
!1);this.keyDataIndex[g[this.indexKey]]=g;if(this.tempIndexHolderMap){var j=this.tempIndexHolderMap[this.nodeData[h].index];j&&(this.indexHolderMap[currentIndex]=j)}this.indexOrder.push(currentIndex);this.indexDataMap[currentIndex]=g;this.dataKeyIndex[g[this.indexKey]]=currentIndex;this.nodeData[h].index=currentIndex;g[this.childKey]&&g[this.childKey].length?(this.toLogger(h,"has childs on",this.childKey," default open = ",this.defaultOpen),this.nodeData[h].hasChilds=!0,this.nodeData[h].childProperty=
this.childKey,(!this.nodeData[h].hasParent||this.nodeData[h].open||void 0==this.nodeData[h].open&&this.defaultOpen)&&this.createNodeInfo(g[this.childKey],currentIndex,d)):(delete this.nodeData[h].childProperty,this.nodeData[h].hasChilds=!1)}},createNodes:function(a){a||(a=this.datasource);var b,d;b=0;for(d=a.length;b<d;b++){var e=a[b],f=e[this.indexKey],g=this.nodeData[f];this.toLogger("create node from ",f,e,"with child property ",g);"function"!==typeof e&&(this.createItemRenderByIndex(g.index),
g&&"object"===typeof e[g.childProperty]&&e[g.childProperty].length&&g.open&&this.createNodes(e[g.childProperty],currentIndex),this.determineLoadNextButton(g.index))}this.toLogger("create node complete")},addItem:function(a){if(!this.datasource||!this.datasource.length){this.setupIndexing();this.toLogger("add item as dummy ",this.indexKey,a,this.datasource);var b={};b[this.childKey]=[a];b.nodeinfo={};b.nodeinfo.childProperty=this.childKey;b.nodeinfo.open=!0;b.hide=!1;b[this.indexKey]="root";this.datagrid.setDataSource([b])}else source=
this.datasource[this.datasource.length-1],this.addDataSource(source,a,!0)},removeSelectedItems:function(){this._super();(!this.datasource||!this.datasource.length||!this.datasource[0][this.childKey]||!this.datasource[0][this.childKey].length)&&this.datagrid.setDataSource([])},addDataSource:function(a,b,d){try{if(!a&&(!this.datasource||!this.datasource.length))return this.createRootNode(),this.addDataSource(null,b,d);a||(a=this.datasource[0],this.toLogger("addDatasource no source, pick",a));a[this.childKey]||
(a[this.childKey]=[]);b instanceof Array||(b=[b]);var e=this.getNodeDataByData(a),f=0,g=a[this.childKey].length-e.addedChildren.length-1,h,j;h=0;for(j=b.length;h<j;h++){var m=b[h];this.toLogger("addDataSource",m,this.indexKey);var p=this.keyDataIndex[m[this.indexKey]];this.toLogger("addDataSource","use index",p);if(void 0!==p){this.toLogger("found existing remove from added, and add childcount");var n=e.addedChildren.indexOf(p);if(0<=n){e.addedChildren.splice(e.addedChildren.indexOf(n,1));f++;continue}}d||
e.addedChildren.push(m);if(this.sortFunc&&a[this.childKey][g]){var q=this.sortFunc(m,a[this.childKey][g]);this.toLogger("sort result of "+m.name+" and "+a[this.childKey][g].name+" ",q);0>q&&(this.toLogger("remove "+m.name+" from addedChildren, we are before the last one"),e.addedChildren.splice(e.addedChildren.indexOf(m),1),f++)}a[this.childKey].push(m)}this.toLogger("current childcount prop",e.childCount,"children",a[this.childKey].length);this.prepareSourceToRender(a)}catch(r){console.log(r)}},
createRootNode:function(){var a={};a[this.childKey]=[];a.nodeinfo=[];a.open=!0;this.datasource||(this.datasource=[]);this.datasource.push(a);this.triggerEvent("dataSourceChanged");this.setDataSource(this.datasource)},prepareSourceToRender:function(a){this.toLogger("PrepareSourceToRender",a);this.indexOrder=[];this.keyDataIndex=[];var b=this.getNodeDataByData(a);this.createNodeInfo(this.datasource,null,this.getProxy(function(a){var b=this.getNodeDataByData(a);this.toLogger("PrepareSourceToRender callback",
a);this.defaultOpen&&void 0===b.open&&(b.open=!0)}));this.indexHolderMap[b.index].childsHolder.clear();0!=b.index&&this.createToggleControl(b.index);this.createNodes(a[this.childKey],b.index);this.hideLoaderInNode(b.index);this.indexHolderMap[b.index].buttonHolder.clear();this.determineLoadNextButton(b.index);this.indexHolderMap[b.index].invalidateDisplay()},removeChildDataRecursivly:function(a){if(a){var b=this.getNodeDataByData(a);b.removedItems||(b.removedItems=[]);if(a[this.childKey]&&a[this.childKey].length){var d,
e;d=0;for(e=a[this.childKey].length;d<e;d++){var f=a[this.childKey][d];b.removedItems.push(f);this.removeChildDataRecursivly(f);a[this.childKey]=[]}}a[this.childKey]=[]}},removeNodeByKey:function(a){(a=this.keyDataIndex[a])&&this.removeItem(a)},removeItem:function(a){this._super(a);var b=this.getNodeDataByData(a);this.removeChildDataRecursivly(a);var d=this.getParentIndex(b.index);if((d=this.getDataSourceByIndex(d))&&d[this.childKey]){var e=d[this.childKey].indexOf(a);if(-1!==e){d[this.childKey].splice(e,
1);var f=this.getNodeDataByData(d),a=f.addedChildren.indexOf(a);0<=a&&f.addedChildren.splice(a,1);f.childCount--}}this.indexHolderMap[b.index].remove();this.indexOrder=[];this.keyDataIndex=[];this.tempIndexHolderMap=Banana.Util.Clone(this.indexHolderMap);this.createNodeInfo(this.datasource);this.tempIndexHolderMap=null;d&&!d[this.childKey].length&&(this.removeToggleControl(f.index,!0),this.indexHolderMap[f.index].invalidateDisplay())},showLoaderInNode:function(a){this.showingLoader=!0;var b=new Banana.Controls.Panel;
b.setId("loader-"+a);b.addCssClass("BDataGridTreeLoader");this.indexHolderMap[a].addControl(b);this.indexHolderMap[a].invalidateDisplay()},hideLoaderInNode:function(a){this.showingLoader=!1;(a=this.indexHolderMap[a].findControl("loader-"+a))&&a.remove()},openNode:function(a,b){var d=this.nodeData[b[this.indexKey]];this.createNodeInfo(this.datasource);this.showingLoader||(d.needsChilds?(d={},d.targetIndex=a,d.datasource=b,d.limit=this.childRequestSizeLimit,d.offset=0,this.triggerEvent("onRequestChilds",
d)):(this.createNodes(b[this.childKey],a),this.determineLoadNextButton(a),this.indexHolderMap[a].invalidateDisplay()),this.indexOrder=[],this.keyDataIndex=[],this.triggerEvent("onItemOpened"))},closeNode:function(a){this.indexHolderMap[a].childsHolder.clear();this.indexHolderMap[a].buttonHolder.clear();this.indexOrder=[];this.keyDataIndex=[];this.createNodeInfo(this.datasource);this.triggerEvent("onItemClosed")},nodeClicked:function(a,b){if(!this.showingLoader){var d=this.getDataSourceByIndex(a),
e=this.nodeData[d[this.indexKey]];e.open=b?!0:!1;e.open?this.openNode(a,d):this.closeNode(a,d)}},determineLoadNextButton:function(a){var b=this.getDataSourceByIndex(a),d=this.getNodeDataByData(b);this.toLogger("determine load next button ",this.indexKey);if(d){if(b[this.childKey]&&d.open){var e=d.childCount,b=b[this.childKey].length,f=d.addedChildren.length;this.toLogger("server",e,"client",b,"added",f);b-=f;if(b<e)return e-=b,e>this.childRequestSizeLimit&&(e=this.childRequestSizeLimit),d.loadnext=
!0,this.createLoadMoreButton(a,e,d)}d.loadnext=!1}},createItemRenderByIndex:function(a,b,d){var e=this.getDataSourceByIndex(a),f=this.nodeData[e[this.indexKey]];this.toLogger("create item render by index ",a,e);this.triggerEvent("onPreCreateItem",{index:a,data:e});if(f){this.currentIndexCreation=a;var g=null,h=e[this.indexKey],g=h&&this.dataItemRenderMap.getItem(h)?this.dataItemRenderMap.getItem(h):this.indexItemRenderFactory[a]?this.indexItemRenderFactory[a]:this.defaultContentItemRender,j=this.getObject(g);
j.setData(e);j.bind("dataChanged",this.getProxy(function(a){this.getDataSource()[parseInt(a.data,10)]=a.currentTarget.getData();this.triggerEvent("dataSourceChanged")}),a.toString());this.dataItemRenderMap.addItem(h,g);this.indexRenderedItemRenderMap[a]=j;j.setListRender(this);var g=this.getParentHolder(a),m=null;d?(m=this.getHolder(a),m.getItemRenderHolder().clear()):g?(m=this.getHolder(a),m=new Banana.Controls.DataGridTreeListHolder):(this.rootHolder=new Banana.Controls.DataGridTreeListRootHolder,
this.addControl(this.rootHolder),m=this.rootHolder);m.listRender=this;m.maximizeAutoWidth=this.maximizeNodeWidth;m.setId(h);this.indexHolderMap[a]=m;if(g=this.getParentHolder(a))f.parentIsRoot?m.addCssClass("BDataGridTreeItemHolderRoot"):m.addCssClass("BDataGridTreeItemHolder"),d||g.childsHolder.addControl(m),m.itemRenderHolder.addControl(j),f.childProperty||f.needsChilds?this.createToggleControl(a):g&&this.removeToggleControl(a),this.selectedIndices.getItem(a)&&this.selectIndex(a),this.bindMouseHandler(m,
e),this.triggerEvent("onPostCreateIndex",{index:a,data:e,holder:m});this.currentIndexCreation=void 0;b&&(g?m.invalidateDisplay():this.rootHolder.invalidateDisplay())}else this.toLogger("no nodeinfo. dont render")},bindMouseHandler:function(a,b){a.itemRenderHolder.bind("click",this.getProxy(function(a){this.onRowMouseClick(a);this.triggerEvent("onItemMouseClick",a)}),b);a.itemRenderHolder.bind("mouseenter",this.getProxy(function(a){this.triggerEvent("onItemMouseEnter",a)}),b);a.itemRenderHolder.bind("mouseleave",
this.getProxy(function(a){this.triggerEvent("onItemMouseOut",a)}),b)},createToggleControl:function(a,b){var d=this.getDataSourceByIndex(a),e=this.nodeData[d[this.indexKey]],f=this.indexHolderMap[a];f.toggleHolder.clear();var g=(new Banana.Controls.DataGridTreeListNodeToggle).addCssClass("BDataGridTreeToggle");g.index=a;g.setOn(e.open);g.bind("toggle",this.getProxy(function(a,b){var d=this.getIndexByDataSource(a.data);this.nodeClicked(d,b)}),d);f.toggleHolder.addControl(g);b&&f.toggleHolder.invalidateDisplay()},
removeToggleControl:function(a,b){var d=this.indexHolderMap[a],e=this.getDataSourceByIndex(a),e=this.getNodeDataByData(e);d.toggleHolder.clear();if(this.rootNodeVisible||e.hasParent)e=(new Banana.Controls.Panel).addCssClass("BDataGridTreeEmptyNode"),d.toggleHolder.addControl(e),b&&d.toggleHolder.invalidateDisplay()},createLoadMoreButton:function(a,b,d){var e=this.indexHolderMap[a],f=new Banana.Controls.Button;0!=a?f.addCssClass("BDataGridTreeLoadNextButton"):f.addCssClass("BDataGridTreeLoadNextButtonRoot");
var g=this.getDataSourceByIndex(a),d=this.getNodeDataByData(g);f.setText("Load next "+b+"/"+(d.childCount-g.children.length));f.bind("click",this.getProxy(function(){if(!this.showingLoader){var e=this.getDataSourceByIndex(a),f=0,g=e[this.childKey].length-d.addedChildren.length;g&&(f=g);g={};g.targetIndex=a;g.datasource=e;g.limit=b;g.offset=f;this.triggerEvent("onRequestChilds",g)}}));e.buttonHolder.addControl(f);e.buttonHolder.addControl('<div style="clear:both"></div>')},selectIndex:function(a,b){var d=
this.getRenderedItemRenderByIndex(a);d&&(d.select(),b||this.triggerEvent("onSelectIndex",a))},deSelectIndex:function(a){var b=this.getRenderedItemRenderByIndex(a);b&&(b.deselect(),this.triggerEvent("onDeselectIndex",a))},selectAllFromIndex:function(a,b){b||(b=this.getDataSourceByIndex(a));if(b){var d=this.getNodeDataByData(b);if(d){var e,f;e=0;for(f=b[this.childKey].length;e<f;e++){var g=b[this.childKey][e],a=d.index,h=this.getRenderedItemRenderByIndex(e);if(!h||h.getIsSelectable())this.selectedIndices.addItem(a,
!0),this.selectIndex(a,!0),g[this.childKey]&&this.selectAllFromIndex(a,g)}}}},indexBeforeIndex:function(a,b){var d;for(d=0;d<this.indexOrder.length;d++){if(this.indexOrder[d]===a)return!0;if(this.indexOrder[d]===b)break}return!1},getRenderedItemRenderByIndex:function(a){a=this.indexHolderMap[a];return!a?null:a.getItemRender()},onRowMouseClick:function(a){var b=this.getNodeDataByData(a.data).index;if(this.getRenderedItemRenderByIndex(b).getIsSelectable()){var d=a.ctrlKey,a=a.shiftKey;if(this.getIndexIsSelected(b))!d&&
!a?(this.previousShiftFirstItem=null,this.clearSelectedIndices()):(this.previousShiftFirstItem=null,this.clearSelectedIndex(b));else if("single"===this.selectionType)this.clearSelectedIndices(),this.addSelectedIndex(b);else if(!d&&!a&&(this.previousShiftFirstItem=null,this.clearSelectedIndices(),this.addSelectedIndex(b)),d&&(this.previousShiftFirstItem=null,this.addSelectedIndex(b)),a){this.previousShiftFirstItem||(this.previousShiftFirstItem=this.selectedIndices.getKeyByIndex(0));d=this.previousShiftFirstItem;
-1===this.indexOrder.indexOf(d)&&(d=this.indexOrder[0]);if(!d)return;this.indexBeforeIndex(b,d)&&(a=b,b=d,d=a);a=!1;this.clearSelectedIndices();var e,f;e=0;for(f=this.indexOrder.length;e<f;e++)if("function"!==typeof this.indexOrder[e]&&(this.indexOrder[e]===d&&(a=!0),a)){this.indexOrder[e]===b&&(a=!1);var g=this.getRenderedItemRenderByIndex(this.indexOrder[e]);(!g||g.getIsSelectable())&&this.addSelectedIndex(this.indexOrder[e])}}this.triggerEvent("onItemSelect")}}});Banana.Controls.DataGridTreeDataItemRender={};
namespace("Banana.Controls").DataGridTreeDataItemRender=Banana.Controls.DataGridTreeItemRender.extend({init:function(){this._super()},createComponents:function(){this.panel=new Banana.Controls.Panel;this.wrapper=(new Banana.Controls.Panel).setStyle("position:relative;float:left;width:20px;heigth:20px;display:inline-block;");this.clickable=(new Banana.Controls.Panel).setStyle("z-index:12;width:20px; height:20px;position:absolute;top:0;");this.cb=(new Banana.Controls.CheckBox).setStyle("z-index:1;position:absolute;top:0;");this.wrapper.addControl('<div style="clear:both;height:20px;width:20px;"></div>');
this.clickable.bind("click",this.getProxy(function(){this.isChecked()?(this.setChecked(!1),this.triggerEvent("userUnchecked")):(this.setChecked(!0),this.triggerEvent("userChecked"))}));this.wrapper.addControl(this.cb);this.wrapper.addControl(this.clickable);this.label=(new Banana.Controls.Label).setStyle("float:left;");this.panel.addControl(this.wrapper);this.panel.addControl(this.label);this.addControl(this.panel)},updateDisplay:function(){this.data&&this.data.name&&this.label.setData(this.data.name)},
setData:function(a){this._super(a);return this},setChecked:function(a){this.cb.setData(a)},isChecked:function(){return this.cb.getData()},isEnabled:function(){return this.enabled},setEnabled:function(a){(this.disabled=a)?(this.cb.setEnabled(!0),jQuery("#"+this.cb.clientId).attr("disabled",!1)):(this.cb.setEnabled(!1),jQuery("#"+this.cb.clientId).attr("disabled","disabled"))},isSelectable:function(){return!1}});Banana.Controls.DataGridDataTreeListRender={};
namespace("Banana.Controls").DataGridDataTreeListRender=Banana.Controls.DataGridTreeListRender.extend({init:function(){this._super();this.data=[];this.defaultContentItemRender=Banana.Controls.DataGridTreeDataItemRender;this.bind("onPostCreateIndex",this.getProxy(function(a,b){this.bindClickHandler(b.holder,b.data)}))},onRowMouseClick:function(){},bindClickHandler:function(a){a=a.getItemRender();a.bind("userChecked",this.getProxy(function(a){this.alterData(a.currentTarget.data[this.indexKey]);var d=
this.getNodeDataByData(a.currentTarget.data);d.checked=!0;a.currentTarget.getData();this.toggleCheckStateFrom(d.index,null,!0);this.determineCheckboxState()}));a.bind("userUnchecked",this.getProxy(function(a){this.alterData(a.currentTarget.data[this.indexKey]);var d=this.getNodeDataByData(a.currentTarget.data);d.checked=!1;a.currentTarget.getData();this.toggleCheckStateFrom(d.index,null,!1);this.determineCheckboxState()}))},alterData:function(a,b){this.data||(this.data=[]);var d=this.data.indexOf(a);
if(b){if(-1<d)return;this.data.push(a)}else{if(0>d)return;this.data.splice(d,1)}this.triggerEvent("dataChanged")},toggleCheckStateFrom:function(a,b,d){b||(b=this.getDataSourceByIndex(a));if(b){a=this.getNodeDataByData(b);a.checked=d;this.alterData(b[this.indexKey],d);if(a=this.getHolder(a.index))(a=a.getItemRender())&&a.setChecked(d);if(b.children&&b.children.length){var e,a=0;for(e=b.children.length;a<e;a++)this.toggleCheckStateFrom(null,b.children[a],d)}}},openNode:function(a,b){this._super(a,b);
this.determineCheckboxData();this.determineCheckboxState()},closeNode:function(a,b){this._super(a,b);this.determineCheckboxData();this.determineCheckboxState()},setData:function(a){this.data=a;this.determineCheckboxData();this.determineCheckboxState();return this},updateDisplay:function(){this._super();this.determineCheckboxData();this.determineCheckboxState()},determineCheckboxData:function(a){if(this.isRendered&&this.data&&this.data.length){a||(a=this.datasource);var b,d;b=0;for(d=a.length;b<d;b++){var e=
a[b],f=this.getNodeDataByData(e);if(!e.children||!e.children.length){if(-1!==this.data.indexOf(e[this.indexKey])&&(e=this.getHolder(f.index)))if(e=e.getItemRender())e.setChecked(!0),f.checked=!0}else{var g,f=0;for(g=e.children.length;f<g;f++)this.determineCheckboxData([e.children[f]])}}}},determineCheckboxState:function(a){if(this.isRendered&&this.data&&this.data.length){a||(a=this.datasource);var b=!0,d=!0,e,f;e=0;for(f=a.length;e<f;e++){var g=a[e],d=b=!0;if(g.children&&g.children.length){var h,
j;h=0;for(j=g.children.length;h<j;h++){var m=g.children[h],p=this.getNodeDataByData(m);this.determineCheckboxState([m]);p.checked?d=!1:b=!1;p.indeterminate&&(d=b=!1)}itemNodeData=this.getNodeDataByData(g);g=this.getHolder(itemNodeData.index);h=null;g&&(h=g.getItemRender());b?(h&&(h.setChecked(!0),h.setEnabled(!0)),itemNodeData.checked=!0,itemNodeData.indeterminate=!1):d?(h&&h.setChecked(!1),itemNodeData.checked=!1,itemNodeData.indeterminate=!1):(h&&(h.setChecked(!0),h.setEnabled(!1)),itemNodeData.checked=
!0,itemNodeData.indeterminate=!0)}}}}});Banana.Controls.DataGridFilterManager={};
namespace("Banana.Controls").DataGridFilterManager=Banana.Control.extend({init:function(){this._super();this.enableCookie=!0;this.showBindedFiltersOnly=!1;this.forcedInvisibleFilters=[];this.filters=[];this.filterKeys=[];this.urlPreFix=""},ignoreAutoVisible:function(){this.ignoreAutoVisible=!0;return this},showBindedOnly:function(){this.showBindedFiltersOnly=!0;return this},setKeepAllValueInUrl:function(a){this.keepAllValueVisible=a;return this},setUrlPreFix:function(a){this.urlPreFix=a;return this},
disableHistory:function(){this.enableCookie=!1;return this},setFilters:function(a){for(var b=this.enableCookie,d=this.urlPreFix,e=0,f=a.length;e<f;e++){var g=a[e];var h=g;if(!h.data){var j=void 0;b&&Banana.Application.loadingWithHistory?(j=Banana.Util.StateManager.getState(d+h.filterField),Banana.Util.UrlManager.registerModule(d+h.filterField),Banana.Util.UrlManager.setModule(d+h.filterField,j,!0)):j=Banana.Util.UrlManager.getModule(d+h.filterField);j&&h instanceof Banana.Controls.DropDown&&(j=j.split(","));
h.setData(j||g.getAllKey()||g.promptText)}g.bind("filterDataChanged",this.getProxy(this.filterDataChanged));g.bind("filterDataSourceChanged",this.getProxy(this.filterDataSourceChanged));g.bind("onSetVisible",this.getProxy(this.filterVisibilityChanged));Banana.Util.UrlManager.listenModule(d+g.filterField,this.getProxy(this.filterUrlChanged),g);this.filterKeys.push(d+g.filterField);!this.ignoreAutoVisible&&(g instanceof Banana.Controls.ListControl&&this.showBindedFiltersOnly&&!g.datasource)&&g.setVisible(!1);
this.filters.push(a[e])}Banana.Util.UrlManager.updateUrl();return this},getFilters:function(){return this.filters},getFilterById:function(a){if("string"==typeof a)for(var b=0,d=this.filters.length;b<d;b++)if(this.filters[b].id==a)return this.filters[b];return null},filterUrlChanged:function(a,b){if(!this.ignoreUrlChanges){var d=a.data;d.setData(b);!this.keepAllValueVisible&&(null===d.getData()||void 0==d.getData()||d.getData()==d.allKey)&&this.removeFilterValues(d);this.enableCookie&&Banana.Util.StateManager.setState(this.urlPreFix+
d.filterField,d.getData());this.triggerEvent("filtersChanged",{data:this.getFilterData(a),filter:d})}},filterDataSourceChanged:function(a){this.ignoreAutoVisible||a.currentTarget.datasource&&a.currentTarget.setVisible(!0)},filterDataChanged:function(a,b){this.clearCache();!this.keepAllValueVisible&&(null===a.currentTarget.getData()||void 0==a.currentTarget.getData()||0==a.currentTarget.getData().length||a.currentTarget.getData()==a.currentTarget.allKey)?this.removeFilterValues(a.currentTarget):this.registerFilterValues(a.currentTarget);
b||this.triggerEvent("filtersChanged",{data:this.getFilterData(a),filter:a.currentTarget})},filterVisibilityChanged:function(a,b){a.currentTarget.isRendered&&!b&&this.removeFilterValues(a.currentTarget)},removeFilterValues:function(a){"string"==typeof a&&(a=this.getFilterById(a));Banana.Util.UrlManager.removeModule(this.urlPreFix+a.filterField);this.enableCookie&&Banana.Util.StateManager.removeState(this.urlPreFix+a.filterField)},setFilterValue:function(a,b){"string"==typeof a&&(a=this.getFilterById(a));
b==a.allKey?this.removeFilterValues(a):a.setData(b)},registerFilterValues:function(a){this.ignoreUrlChanges=!0;Banana.Util.UrlManager.registerModule(this.urlPreFix+a.filterField);Banana.Util.UrlManager.setModule(this.urlPreFix+a.filterField,a.getData());this.enableCookie&&Banana.Util.StateManager.setState(this.urlPreFix+a.filterField,a.getData());this.ignoreUrlChanges=!1},clearCache:function(){this.filtersData=void 0},getFilterData:function(a,b){if(!this.filters)return null;if(!a&&this.filtersData)return this.filtersData;
for(var d={},e=0,f=this.filters.length;e<f;e++){var g=this.filters[e];if(g.getData()&&(!g.isRendered||g.visible))func=g.filterMethod||null,d[g.name||g.filterField]={filterMethod:func,filterField:g.filterField,data:g.getData(),dataChanged:g.isChanged}}this.filtersData=d;if(b){d={};e=0;for(f=this.filters.length;e<f;e++)if(g=this.filters[e],g.getData()&&(!g.isRendered||g.visible))d[g.filterField]=g.getData();return d}return this.filtersData}});Banana.Controls.DataGridControlPanel={};
namespace("Banana.Controls").DataGridControlPanel=Banana.Control.extend({init:function(){this._super();this.createLayout();this.buttons=[];this.topButtons=[]},updateDisplay:function(){this.top.setVisible(this.top.controls.length);this.middle.setVisible(this.middle.controls.length);this.bottom.setVisible(this.bottom.controls.length-1)},setFilters:function(a){for(var b=0,d=a.length;b<d;b++)a[b]instanceof Banana.Controls.DataGridPagerFilter?this.setPagerFilter(a[b]):a[b]instanceof Banana.Controls.DataGridDropDownFilter?
this.setDropDownFilter(a[b]):a[b]instanceof Banana.Controls.DataGridSearchFilter?this.setSearchFilter(a[b]):a[b]instanceof Banana.Controls.DataGridDateFilter?this.setDateFilter(a[b]):a[b]instanceof Banana.Controls.DataGridCheckboxFilter?this.setCheckboxFilter(a[b]):log.error("Filter "+a[b]+" not supported by datagrid control panel!")},setSearchFilter:function(a){this.top.addControl(a)},setPagerFilter:function(a){this.bottom.addControl(a)},setCheckboxFilter:function(a){a.setStyle("float:left;");this.top.addControl(a)},
setDateFilter:function(a){this.top.addControl(a)},setDropDownFilter:function(a){a.setStyle("float:left;");this.middle.addControl(a)},setTopButtons:function(a){this.topButtons=a;var b,d;b=0;for(d=a.length;b<d;b++)this.top.addControl(a[b]),a[b].setStyle("float:right;margin-right:2px;")},setButtons:function(a){this.buttons=a;buttondownadded=!1;for(var b=0,d=a.length;b<d;b++)buttondownadded=!0,this.bottom.addControl(a[b]);buttondownadded&&this.arrow.setVisible(!0)},createLayout:function(){this.top=(new Banana.Controls.Panel).addCssClass("BDataGridControlPanelTop");
this.middle=(new Banana.Controls.Panel).addCssClass("BDataGridControlPanelCenter");this.bottom=(new Banana.Controls.Panel).addCssClass("BDataGridControlPanelBottom");this.addControl(this.top);this.addControl(this.middle);this.addControl(this.bottom);this.arrow=(new Banana.Controls.Panel).addCssClass("BDataGridControlArrow");this.arrow.setVisible(!1);this.bottom.addControl(this.arrow)}});Banana.Controls.BaseDataGridFilter={};namespace("Banana.Controls").BaseDataGridFilter=Banana.Controls.Panel.extend({init:function(){this._super();this.addCssClass("BDataGridFilter");this.allKey="%";this.allTitle=null},setDataSource:function(a,b){var d={};d[this.allKey]=this.allTitle||"All "+this.filterField;for(var e in a)"function"!=typeof a[e]&&(d[e]=a[e]);this._super(d,b);return this},setData:function(a){this.data=a;return this},getData:function(){return this.data}});
Banana.Controls.BaseDataGridFilter.prototype.setAllTitle=function(a,b){this.allTitle=a;b&&(this.allKey=b);return this};Banana.Controls.BaseDataGridFilter.prototype.setFilterField=function(a){this.filterField=a;return this};Banana.Controls.BaseDataGridFilter.prototype.getFilterfield=function(){return this.filterField};Banana.Controls.BaseDataGridFilter.prototype.setName=function(a){this.name=a;return this};Banana.Controls.DataGridCheckboxFilter={};
namespace("Banana.Controls").DataGridCheckboxFilter=Banana.Controls.BaseDataGridFilter.extend({init:function(){this._super();this.checkbox=new Banana.Controls.CheckBox;this.addCssClass("BDataGridPagerFilter");this.checkbox.bind("change",this.getProxy(function(){this.triggerEvent("filterDataChanged")}));this.checkbox.bind("dataChanged",this.getProxy(function(){this.triggerEvent("filterDataChanged")}));this.label=new Banana.Controls.Label},createComponents:function(){this.addControl(this.checkbox);this.addControl(this.label)},
updateDisplay:function(){this.label.setForControl(this.checkbox)},setData:function(a,b,d){this.checkbox.setData(a,b,d)},getData:function(){return this.checkbox.getData()},setTitle:function(a){this.label.setData(a);return this},getTitle:function(){return this.label.getData()},getAllKey:function(){return null}});Banana.Controls.DataGridDropDownFilter={};
namespace("Banana.Controls").DataGridDropDownFilter=Banana.Controls.DropDown.extend({init:function(){this._super();this.allKey="%";this.allTitle=null;this.addCssClass("BDataGridFilter");this.bind("dataChanged",this.getProxy(function(){this.triggerEvent("filterDataChanged")}));this.bind("dataSourceChanged",this.getProxy(function(){this.triggerEvent("filterDataSourceChanged")}))},setDataSource:function(a,b){if(a instanceof Array&&"object"==typeof a[0]){var d=this.dataValueField||"value",e={};e[this.dataKeyField||
"key"]=this.allKey;e[d]=this.allTitle||"All "+this.filterField;a.unshift(e)}else{d={};d[this.allKey]=this.allTitle||"All "+this.filterField;for(e in a)"function"!=typeof a[e]&&(d[a[e]]=a[e]);a=d}this._super(a,b);return this}});Banana.Controls.DataGridDropDownFilter.prototype.getAllKey=function(){return this.allKey};Banana.Controls.DataGridDropDownFilter.prototype.setAllTitle=function(a,b){this.allTitle=a;b&&(this.allKey=b);return this};
Banana.Controls.DataGridDropDownFilter.prototype.setFilterField=function(a){this.filterField=a;return this};Banana.Controls.DataGridDropDownFilter.prototype.setName=function(a){this.name=a;return this};Banana.Controls.DataGridDropDownFilter.prototype.getFilterfield=function(){return this.filterField};Banana.Controls.DataGridDropDownFilter.prototype.getData=function(){return this.data};Banana.Controls.DataGridSearchFilter={};
namespace("Banana.Controls").DataGridSearchFilter=Banana.Controls.TextBox.extend({init:function(){this.untouched=!0;this._super();this.addCssClass("BDataGridFilter");this.addCssClass("BDataGridSearchFilter");this.promptText="Search Games";this.allKey="%";this.bind("dataChanged",this.getProxy(this.handleChange))},getData:function(){return this.data==this.promptText?this.allKey:this.data||this.allKey},handleChange:function(){this.getData()!=this.previousSearch&&(this.timer&&clearTimeout(this.timer),
this.timer=setTimeout(this.getProxy(function(){this.untouched||(this.previousSearch=this.getData(),this.triggerEvent("filterDataChanged"),clearTimeout(this.timer))}),400))},setFilterField:function(a){this.filterField=a;return this},getFilterField:function(){return this.filterField}});Banana.Controls.DataGridSearchFilter.prototype.getAllKey=function(){return null};
Banana.Controls.DataGridSearchFilter.prototype.createComponents=function(){this.bind("mousedown",this.getProxy(this.searchClicked));if(!this.getData()){var a=Banana.Util.UrlManager.getModule("search");a?this.setData(a):this.setData(this.promptText)}};Banana.Controls.DataGridSearchFilter.prototype.searchClicked=function(){this.untouched&&this.setData("",!0);this.untouched=!1};Banana.Controls.DataGridPagerFilter={};
namespace("Banana.Controls").DataGridPagerFilter=Banana.Controls.ListControl.extend({init:function(){this._super();this.addCssClass("BDataGridFilter");this.addCssClass("BDataGridPagerFilter");this.pagerLinks=(new Banana.Controls.Panel).addCssClass("BDataGridPagerFilterButtonContainer");this.addControl(this.pagerLinks);this.bind("dataChanged",this.getProxy(function(){this.onSetData();this.createDropDownDataSource();null!=this.datasource&&this.createPageLinks();this.triggerEvent("filterDataChanged",
!0)}));this.bind("dataSourceChanged",this.getProxy(function(){1E3<this.datasource&&(this.datasource=1E3);null==this.data&&(this.data=0);null!=this.data&&(this.createPageLinks(),this.createDropDownDataSource());this.triggerEvent("filterDataSourceChanged")}));this.bind("indexChanged",this.getProxy(function(){this.createDropDownDataSource();this.triggerEvent("filterDataChanged")}))}});Banana.Controls.DataGridPagerFilter.prototype.getAllKey=function(){return null};
Banana.Controls.DataGridPagerFilter.prototype.setFilterField=function(a){this.filterField=a;return this};Banana.Controls.DataGridPagerFilter.prototype.getFilterField=function(){return this.filterField};Banana.Controls.DataGridPagerFilter.prototype.nextClick=function(){this.getDataSource()<=parseInt(this.getData())+1||(this.setData(parseInt(this.getData())+1),jQuery(this).trigger("indexChanged",this.getData()))};
Banana.Controls.DataGridPagerFilter.prototype.nextnextClick=function(){this.getDataSource()<=parseInt(this.getData())+1||(this.setData(parseInt(this.getDataSource())-1),jQuery(this).trigger("indexChanged",this.getData()))};Banana.Controls.DataGridPagerFilter.prototype.previousClick=function(){0>=this.getData()||(this.setData(parseInt(this.getData())-1),jQuery(this).trigger("indexChanged",this.getData()))};
Banana.Controls.DataGridPagerFilter.prototype.previouspreviousClick=function(){0>=this.getData()||(this.setData(0),jQuery(this).trigger("indexChanged",this.getData()))};Banana.Controls.DataGridPagerFilter.prototype.pagerDropDownChanged=function(){jQuery(this).trigger("indexChanged",this.dropDown.getData());this.createPageLinks()};Banana.Controls.DataGridPagerFilter.prototype.setDataGridOwner=function(a){this.datagridowner=a};Banana.Controls.DataGridPagerFilter.prototype.onSetData=function(){};
Banana.Controls.DataGridPagerFilter.prototype.createPageLinks=function(){this.pagerLinks.clear();if(!(1>=this.datasource)){var a=parseInt(this.datasource),b=parseInt(this.data),d=1;2<b&&(d=3>a-b?a-4:b-1);1>d&&(d=1);var e=d+5;e>a&&(e=a+1);a=(new Banana.Controls.Button).addCssClass("BDataGridPagerFilterButton");a.setText("<< ");this.pagerLinks.addControl(a);var f=(new Banana.Controls.Button).addCssClass("BDataGridPagerFilterButton");f.setText("< ");this.pagerLinks.addControl(f);for(i=d;i<e&&!(i>this.datasource);i++)d=
(new Banana.Controls.Button).addCssClass("BDataGridPagerFilterButton"),d.setText(i),i-1==b&&d.addCssClass("BDataGridPagerFilterButtonSelected"),this.pagerLinks.addControl(d),d.bind("click",this.getProxy(this.onPageNavigate),i);b=(new Banana.Controls.Button).addCssClass("BDataGridPagerFilterButton");b.setText(">");e=(new Banana.Controls.Button).addCssClass("BDataGridPagerFilterButton");e.setText(">>");b.bind("click",this.getProxy(this.nextClick));e.bind("click",this.getProxy(this.nextnextClick));f.bind("click",
this.getProxy(this.previousClick));a.bind("click",this.getProxy(this.previouspreviousClick));this.pagerLinks.addControl(b);this.pagerLinks.addControl(e);0==this.data?(f.setStyle("visibility:hidden"),a.setStyle("visibility:hidden")):this.data+1>=this.datasource&&(b.setStyle("visibility:hidden"),e.setStyle("visibility:hidden"));this.pagerLinks.invalidateDisplay()}};
Banana.Controls.DataGridPagerFilter.prototype.onPageNavigate=function(a){this.setData(parseInt(a.data)-1);jQuery(this).trigger("indexChanged",this.getData())};
Banana.Controls.DataGridPagerFilter.prototype.createDropDownDataSource=function(){if(this.getDataSource()){var a=parseInt(this.datasource),b=parseInt(this.data),d=a,e=Math.floor(d/20),f=b-10,g=b+10,a=[];if(50>d)for(b=1;b<=d;b++)a.push(b);else{for(b=1;5>=b;b++)a.push(b);var h;for(h=d-5;h<=d;h++)a.push(h);h=5;for(var d=d-5,j=!1;h<=d;)h>=f&&h<=g?(h++,j=!0):(h+=e,h>f&&!j&&(h=f)),0<h&&h<=d&&a.push(h);sortfunc=function(a,b){return parseInt(a,10)-parseInt(b,10)};a.sort(sortfunc)}e=[];for(b in a)"function"!=
typeof a[b]&&(f={},f.key=a[b]-1,f.value=a[b],e.push(f))}};Banana.Controls.DataGridDateFilter={};namespace("Banana.Controls").DataGridDateFilter=Banana.Controls.DatePicker.extend({init:function(){this._super();this.addCssClass("BDataGridPagerFilter");this.bind("dataChanged",this.getProxy(this.triggerEvent("filterDataChanged")))},setTitle:function(a){this.title=a;return this},getTitle:function(){return this.title},getAllKey:function(){return null}});Banana.Controls.DataGridDateFilter.prototype.setFilterField=function(a){this.filterField=a;return this};
Banana.Controls.DataGridDateFilter.prototype.getFilterfield=function(){return this.filterField};Banana.Controls.DataGridDateFilter.prototype.setName=function(a){this.name=a;return this};Banana.Controls.DataGrid={};
namespace("Banana.Controls").DataGrid=Banana.Controls.ListControl.extend({init:function(){this._super();this.addCssClass("BDataGrid");this.datasource=[];this.listRender=null;this.listRenderCreated=!1;this.createBasicControls()},createComponents:function(){this.triggerEvent("datagridReady")},updateDisplay:function(){this.listRenderCreated||this.createEmptyTemplate()},setDataSource:function(a){this.datasource=a;this.triggerEvent("onSetDataSource",a);return this},setData:function(a){this.setDataSource(a);return this},
getData:function(){return this.datasource},setControlPanel:function(a){if(!(a instanceof Banana.Controls.DataGridControlPanel))return this;this.controlPanelHolder.addControl(a);return this},getControlPanel:function(){return this.controlPanelHolder.controls[0]},setEmptyTemplate:function(a){this.emptyTemplate=a;this.clearEmptyTemplate();this.createEmptyTemplate();return this},createBasicControls:function(){this.controlPanelHolder=new Banana.Control;this.listHolder=new Banana.Controls.Panel;this.infoHolder=
(new Banana.Controls.Panel).addCssClass("BDataGridInfoHolder");this.loaderHolder=new Banana.Controls.Panel;this.addControl(this.loaderHolder);this.addControl(this.controlPanelHolder);this.addControl(this.listHolder);this.addControl(this.infoHolder)},setListRender:function(a){this.clearListRender();this.listRender=a;this.listRender.datagrid=this;this.datasource&&this.datasource.length&&this.setDataSource(this.datasource);return this},getListRender:function(){this.listRender||(this.listRender=new Banana.Controls.DataGridTableListRender);
return this.listRender},clearListRender:function(){this.listHolder.clear();return this},createListRender:function(){if(!this.listRender||!this.listRender.id)this.listRender=this.getListRender();-1===this.listHolder.controls.indexOf(this.listRender)&&(this.listHolder.addControl(this.listRender),this.listRender.datagrid=this,this.listRenderCreated=!0,this.listRender.bind("dataSourceChanged",this.getProxy(function(){this.datasource=this.listRender.datasource;if(!this.emptyTemplateCleared||!this.datasource.length)this.emptyTemplateCleared=
!1,this.datasource.length?(this.clearEmptyTemplate(),this.emptyTemplateCleared=!0):this.createEmptyTemplate()})))},onSetDataSource:function(){this.datasource||(this.datasource=[]);this.datasource.length?this.infoHolder.setVisible(!1):this.createEmptyTemplate();this.listRender&&this.listRender.clear();this.createListRender();this.listRender.setDataSource(this.datasource);this.isRendered&&this.listHolder.invalidateDisplay()},showInitLoader:function(){},renderList:function(){},showLoader:function(){},
createEmptyTemplate:function(){this.infoHolder.clear();this.emptyTemplate?this.infoHolder.addControl(this.emptyTemplate(),!0).setVisible(!0):this.infoHolder.addControl("No data found",!0).setVisible(!0)},clearEmptyTemplate:function(){this.infoHolder.clear();return this}});Banana.Controls.SwitchButton={};
namespace("Banana.Controls").SwitchButton=Banana.Controls.Panel.extend({init:function(){this._super();this.status=!1},createComponents:function(){this.image=new Banana.Controls.Image;this.addControl(this.image);this.bind("click",this.getProxy(function(){this.status=this.status?!1:!0;this.triggerEvent("switched",this.status);this.bindImage();this.image.invalidateDisplay()}));this.bindImage()},bindImage:function(){this.status?this.image.setImage(this.onImage):this.image.setImage(this.offImage)},setOnImage:function(a){this.onImage=
a;this.isRendered&&this.bindImage();return this},setOffImage:function(a){this.offImage=a;this.isRendered&&this.bindImage();return this},on:function(){this.status=!0;this.isRendered&&this.bindImage();return this},off:function(){this.status=!1;this.isRendered&&this.bindImage();return this}});Banana.Controls.Window={};
namespace("Banana.Controls").Window=Banana.Controls.Panel.extend({init:function(){this._super();this.addCssClass("BWindow");this.collapsed=!1;var a=new Banana.Controls.Panel;a.addCssClass("BWindowHeader");this.addControl(a,!0);this.switchButton=new Banana.Controls.SwitchButton;this.switchButton.addCssClass("BWindowSwitch");this.switchButton.on();this.switchButton.bind("switched",this.getProxy(this.switchCollapseState));a.addControl(this.switchButton);this.headerTitle=new Banana.Controls.Label;this.headerTitle.addCssClass("BWindowTitle");
a.addControl(this.headerTitle);this.content=new Banana.Controls.Panel;this.content.addCssClass("BWindowContent");this.addControl(this.content,!0);this.addControl('<div style="clear:both;"></div>')},clear:function(){this.content.clear();return this},switchCollapseState:function(a,b){this.setState("collapsed",b);b?(this.setState("collapsed",!0),this.close()):(this.setState("collapsed",!1),this.open())},addControl:function(a,b){b?this._super(a):this.content.addControl(a);return this},setTitle:function(a){this.title=
a;return this},getTitle:function(){return this.title},createComponents:function(){this.headerTitle.setData(this.getTitle());this.switchButton.setOnImage(Banana.Application.getSettings().imagedir+"/arrowclose.png");this.switchButton.setOffImage(Banana.Application.getSettings().imagedir+"/arrowopen.png");var a=!1,a=this.getState("collapsed");(a=null===a?this.collapsed?!1:!0:a?!1:!0)?(this.collapsed=!0,this.switchButton.off()):(this.content.setCss({display:"none"}),this.collapsed=!1,this.switchButton.on());
this.addCssClass("BWindow")},open:function(){this.collapsed=!1;jQuery("#"+this.content.getClientId()).show();return this},close:function(){this.collapsed=!0;jQuery("#"+this.content.getClientId()).hide();return this}});Banana.Controls.Button={};
namespace("Banana.Controls").Button=Banana.Controls.Panel.extend({init:function(){this._super();this.addCssClass("BButton");this.addCssClass("BButtonHover");this.bind("click",this.getProxy(function(a){void 0!==this.enabled&&!1===this.enabled&&(a.stopImmediatePropagation(),a.stopPropagation());return!1}))},getTagName:function(){return"button"},createComponents:function(){this.imageUrl?(this.image=new Banana.Controls.Image,this.image.setImage(this.imageUrl),this.addControl(this.image)):(this.label=
(new Banana.Controls.Label).addCssClass("BButtonLabel"),this.labelStyle&&this.label.setStyle(this.labelStyle),this.labelClass&&this.label.addCssClass(this.labelClass),this.label.setData(this.text),this.addControl(this.label))},setEnabled:function(a){a?(this.removeCssClass("BButtonDisabled"),this.addCssClass("BButtonHover")):(this.addCssClass("BButtonDisabled"),this.removeCssClass("BButtonHover"));this.enabled=a;return this},setLabelStyle:function(a){this.labelStyle=a;return this},setLabelCssClass:function(a){this.labelClass=
a;return this},setText:function(a){this.text=a;this.isRendered&&this.label&&this.label.setData(this.text);return this},setImage:function(a){this.imageUrl=a;this.isRendered&&this.image.setImage(this.imageUrl);return this}});Banana.Controls.Link={};namespace("Banana.Controls").Link=Banana.Controls.DataControl.extend({init:function(){this._super();this.addCssClass("BLink")},updateDisplay:function(){this.text&&Banana.Util.DomHelper.renderHtml(this.text,this)},setTarget:function(a){this.setAttribute("target",a)},setHref:function(a){this.setAttribute("href",a);return this},setText:function(a){this.text=a;this.isRendered&&Banana.Util.DomHelper.renderHtml(this.text,this,!0);return this},getTagName:function(){return"a"}});Banana.Controls.LinkButton={};namespace("Banana.Controls").LinkButton=Banana.Controls.Button.extend({init:function(){this._super();this.addCssClass("BLinkButton")}});Banana.Controls.Canvas={};namespace("Banana.Controls").Canvas=Banana.UiControl.extend({init:function(a){this._super();this.type=a}});Banana.Controls.Canvas.prototype.getContext=function(){this.context||(console.log(this.type),this.context=document.getElementById(this.getClientId()).getContext(this.type||"2d"));return this.context};Banana.Controls.Canvas.prototype.clear=function(){var a=this.getParent().getDemensions(),b=this.getContext();b.clearRect(0,0,a.width,a.height);b.beginPath()};
Banana.Controls.Canvas.prototype.getTagName=function(){return"canvas"};Banana.Controls.Modal={};
namespace("Banana.Controls").Modal=Banana.Controls.Panel.extend({init:function(){this.keepFixed=!0;this._super();this.antiPaddingBug=new Banana.Controls.Panel;this.antiPaddingBug.addCssClass("BModalAntiPadding");this.contentContainer=new Banana.Controls.Panel;this.contentContainer.addCssClass("BModalContent");this.contentContainer.setId("content");this.titleLabel=(new Banana.Controls.Label).addCssClass("BModalTitle");this.buttonContainer=(new Banana.Controls.Panel).addCssClass("BModalButtonContainer")},setKeepFixed:function(a){this.keepFixed=
a;return this},updateDisplay:function(){this.center();this.keepFixed&&this.container.setCss({position:"fixed",top:this.getPage().getDimensions().offset.top+20})},setButtonsEnabled:function(a){for(var b=this.buttonContainer.getControls(),d=0;d<b.length;d++)b[d].setEnabled(a);return this},setButtons:function(a){this.isRendered&&this.buttonContainer.clear();if(a.length){i=0;for(len=a.length;i<len;i++)if(a[i]instanceof Banana.Controls.Button)this.buttonContainer.addControl(a[i]);else{var b=new Banana.Controls.Button;
b.addCssClass("BButtonGray");b.setStyle("margin-left:5px;float:left;");b.bind("click",a[i][1]);b.setText(a[i][0]);this.buttonContainer.addControl(b)}}else for(var d in a)a[i]instanceof Banana.Controls.Button?this.buttonContainer.addControl(a[d]):(b=new Banana.Controls.Button,b.addCssClass("BButtonGray"),b.setStyle("margin-left:5px;float:left;"),b.bind("click",a[d]),b.setText(d),this.buttonContainer.addControl(b));this.isRendered&&this.buttonContainer.invalidateDisplay();return this},createComponents:function(){this.cover=
new Banana.Controls.Panel;this.cover.addCssClass("BModalCover");this.container=new Banana.Controls.Panel;this.container.addCssClass("BModal");this.container.setStyle(this.style);var a=(new Banana.Controls.Panel).addCssClass("BModalControlBar");a.addControl(this.titleLabel);this.antiPaddingBug.addControl(this.contentContainer);this.antiPaddingBug.addControl(this.buttonContainer);this.container.addControl(a).addControl(this.antiPaddingBug);this.addControl(this.cover,!0);this.addControl(this.container,
!0);this.bind("renderComplete",this.getProxy(this.center))},center:function(){if(this.isRendered){var a=this.getPage().getDimensions();this.container.setCss({"margin-left":a.width/2-this.container.getDimensions().width/2+"px","margin-top":"40px"})}return this},hide:function(){this.setVisible(!1);this.triggerEvent("close");return this},show:function(){this.titleLabel.setVisible(this.titleLabel.getData());this.setVisible(!0,50,"fadeIn");this.center();this.triggerEvent("onShow");return this},setTitle:function(a){this.titleLabel.setData(a);
return this},addControl:function(a,b){b?this._super(a):this.contentContainer.addControl(a);return this}});Banana.Controls.ConfirmModal={};
namespace("Banana.Controls").ConfirmModal=Banana.Controls.Modal.extend({init:function(){this._super();this.text=new Banana.Controls.Label;this.text.addCssClass("BConfirmModalText");this.textTitle=new Banana.Controls.Label;this.textTitle.addCssClass("BConfirmModalTitle")},createComponents:function(){this._super();this.container.addCssClass("BConfirmModal");var a=new Banana.Controls.Panel;a.addCssClass("BConfirmModalImage");var b=new Banana.Controls.Panel;b.addCssClass("BConfirmModalContainer");b.addControl(this.textTitle);
b.addControl(this.text);this.addControl(a);this.addControl(b);a={Ok:this.getProxy(function(){this.triggerEvent("onOk");this.hide()}),Cancel:this.getProxy(function(){this.hide()})};this.setButtons(a)},setTextTitle:function(a){this.textTitle.setData(a);return this},setText:function(a){this.text.setData(a);return this},show:function(){this.textTitle.setVisible(this.textTitle.getData());this.text.setVisible(this.text.getData());this._super()}});Banana.Controls.Fieldset={};namespace("Banana.Controls").Fieldset=Banana.UiControl.extend({init:function(){this._super();this.addCssClass("BFieldset")},getTagName:function(){return"fieldset"}});Banana.Controls.Legend={};namespace("Banana.Controls").Legend=Banana.UiControl.extend({init:function(){this._super();this.addCssClass("BLegend")},getTagName:function(){return"legend"}});Banana.Controls.Title={};namespace("Banana.Controls").Title=Banana.UiControl.extend({init:function(a){this._super();this.addCssClass("BTitle");this.tag="h2";a&&(this.tag=a)},setTagName:function(a){this.tag=a;return this},getTagName:function(){return this.tag}});Banana.Controls.Loader={};
namespace("Banana.Controls").Loader=Banana.Control.extend({init:function(){this._super();this.text=(new Banana.Controls.Label).addCssClass("BLoaderTextLabel");this.loader=(new Banana.Controls.Panel).addCssClass("BLoader").addCssClass("BLoaderContainer").setVisible(!1);this.loaderTrans=(new Banana.Controls.Panel).addCssClass("BLoader").addCssClass("BLoaderTransparantContainer").setVisible(!1);this.cover=(new Banana.Controls.Panel).addCssClass("BLoaderCover").setVisible(!1)},createComponents:function(){var a=
(new Banana.Controls.Panel).addCssClass("BLoaderImage");this.addControl(this.loaderTrans);this.addControl(this.loader);this.loader.addControl(a);this.loader.addControl(this.text);this.addControl(this.cover)},updateDisplay:function(){this.getFirstUiControl().getDimensions();var a=jQuery(document).height(),b=this.loader.getDimensions().height,a=a/3-b;this.loaderTrans.setCss({"margin-top":a});this.loader.setCss({"margin-top":a});this.setVisibleLater&&this.setVisibleControls()},setVisibleControls:function(){this.cover&&
(this.cover.setVisible(!0),this.loaderTrans.setVisible(!0),this.loader.setVisible(!0))},show:function(a){this.text.setData(a);this.isRendered?this.setVisibleControls():this.setVisibleLater=!0;return this},hide:function(){if(this.cover)return this.setVisibleLater=!1,this.cover.setVisible(!1),this.loaderTrans.setVisible(!1),this.loader.setVisible(!1),this}});Banana.Controls.Form={};namespace("Banana.Controls").Form=Banana.UiControl.extend({init:function(){this._super()},getTagName:function(){return"form"}});Banana.Controls.FileInput={};namespace("Banana.Controls").FileInput=Banana.Controls.InputControl.extend({init:function(){this._super();this.setAttribute("type","file")},setMultiple:function(a){this.setAttribute("multiple",a);return this},getFiles:function(){return document.getElementById(this.getClientId()).files}});Banana.Controls.TabSlider={};
namespace("Banana.Controls").TabSlider=Banana.Controls.Panel.extend({init:function(){this._super();this.addCssClass("BTabSlider");this.content=[];this.slideSpeed=this.activatedTab=0;this.easing="swing";this.useAutoHeight=!1;this.useLeftRightNav=!0;this.useUrlHistory=!1;this.linkPreviousText=this.linkNextText="&nbsp;"},onWindowResize:function(){this.repositionPanels()},addContent:function(a,b){if(!b||"string"!=typeof b)return log.error("cannot add content without tabname");this.content.push({content:a,
tabname:b});return this},setSlideSpeed:function(a){this.slideSpeed=a;return this},setUseAutoHeight:function(a){this.useAutoHeight=a;return this},setEasing:function(a){this.easing=a;return this},setUseUrlHistory:function(a){this.useUrlHistory=a;return this},setLinkNextText:function(a){this.linkNextText=a;return this},setLinkPreviousText:function(){this.linkPreviousText=text;return this},createComponents:function(){this.buttonContainer=(new Banana.Controls.Panel).addCssClass("BTabSliderButtonContainer");
var a=(new Banana.Controls.Panel).addCssClass("BTabSliderContentWrapper");this.contentContainer=(new Banana.Controls.Panel).addCssClass("BTabSliderContentContainer");a.addControl(this.contentContainer);this.addControl(this.buttonContainer);this.addControl(a);if(this.useUrlHistory&&(this.urlKey="tabSlidePos"+this.getClientId().replace(/-/g,""),this.registerUrlHistory(),a=Banana.Util.UrlManager.getModule(this.urlKey)))this.activatedTab=a},updateDisplay:function(){this.buttonContainer.clear();this.contentContainer.clear();
var a=this.getDimensions();this.contentContainer.setCss({width:a.width*this.content.length+"px"});var b=(a.width-80)/this.content.length;if(this.useLeftRightNav){var d=(new Banana.Controls.Panel).setCss({width:100*(40/a.width)+"%"}).addCssClass("BTabSliderlinkWrapper");this.buttonContainer.addControl(d);var e=(new Banana.Controls.Link).addCssClass("BTabSliderLink BTabSliderLinkPrevious");e.addControl(this.linkPreviousText);e.setHref("#previous tab");d.addControl(e);e.bind("click",this.getProxy(function(){this.activatedTab=
this.ensureValidTab(--this.activatedTab);this.repositionPanels(this.slideSpeed);return!1}))}d=0;for(e=this.content.length;d<e;d++){var f=(new Banana.Controls.Panel).addCssClass("BTabSliderlinkWrapper");this.useLeftRightNav&&f.setCss({width:100*(b/a.width)+"%"});this.buttonContainer.addControl(f);var g=(new Banana.Controls.Link).addCssClass("BTabSliderLink");g.addControl(this.content[d].tabname);g.setHref("#"+this.content[d].tabname);f.addControl(g);g.bind("click",this.getProxy(function(a){this.activatedTab=
parseInt(a.data,10);this.repositionPanels(this.slideSpeed);return!1}),d.toString());f=(new Banana.Controls.Panel).addCssClass("BTabSliderContentItemContainer");f.setCss({width:a.width+"px"});f.addControl(this.content[d].content);this.contentContainer.addControl(f)}this.useLeftRightNav&&(a=(new Banana.Controls.Panel).setCss({width:100*(40/a.width)+"%"}).addCssClass("BTabSliderlinkWrapper"),this.buttonContainer.addControl(a),b=(new Banana.Controls.Link).addCssClass("BTabSliderLink BTabSliderLinkNext"),
b.addControl(this.linkNextText),b.setHref("#previous tab"),a.addControl(b),b.bind("click",this.getProxy(function(){this.activatedTab=this.ensureValidTab(++this.activatedTab);this.repositionPanels(this.slideSpeed);return!1})));this.buttonContainer.invalidateDisplay();this.contentContainer.invalidateDisplay();this.repositionPanels(0)},ensureValidTab:function(a){0>a?a=this.content.length-1:a>this.content.length-1&&(a=0);return a},applyAutoHeight:function(){var a=this.content[this.activatedTab].content.getDimensions().height;
this.setCss({height:a+this.buttonContainer.getDimensions().height})},registerUrlHistory:function(){Banana.Util.UrlManager.registerModule(this.urlKey);Banana.Util.UrlManager.listenModule(this.urlKey,this.getProxy(function(a,b){this.activatedTab=b;this.repositionPanels(this.slideSpeed)}))},repositionPanels:function(a){if(this.contentContainer){this.triggerEvent("onSlide");var b=this.getDimensions();this.contentContainer.setCss({width:b.width*this.content.length+"px"});i=0;for(len=this.contentContainer.controls.length;i<
len;i++)this.contentContainer.controls[i].setCss({width:b.width+"px"});this.useAutoHeight&&this.applyAutoHeight();var b=this.getDimensions().width,b=-1*this.activatedTab*b,d=0;this.useLeftRightNav&&(d=1);jQuery("#"+this.buttonContainer.getClientId()+" .BTabSliderLink").removeClass("BTabSliderLinkActive");jQuery("#"+this.buttonContainer.getClientId()+" .BTabSliderLink:eq("+(parseInt(this.activatedTab)+d)+")").addClass("BTabSliderLinkActive");jQuery("#"+this.contentContainer.getClientId()).animate({left:b+
"px"},{duration:a,easing:this.easing,complete:this.getProxy(function(){this.useUrlHistory&&(Banana.Util.UrlManager.unlistenModule(this.urlKey),Banana.Util.UrlManager.setModule(this.urlKey,this.activatedTab.toString()),this.registerUrlHistory());this.triggerEvent("onSlideFinished")})})}}});Banana.Controls.Decorators={};Banana.Controls.Decorators.Decorator={};namespace("Banana.Controls.Decorators").Decorator=Banana.Controls.Panel.extend({init:function(a){this._super();this.decoratedControl=a},getDecoratedControl:function(){return this.decoratedControl instanceof Banana.Controls.Decorators.Decorator?this.decoratedControl.getDecoratedControl():this.decoratedControl}});Banana.Controls.Decorators.Validator={};
namespace("Banana.Controls.Decorators").Validator=Banana.Controls.Decorators.Decorator.extend({init:function(a){this._super(a);this.showIndicator=!0;this.validationGroup="default";var b=(new Banana.Controls.Panel).addCssClass("BValidatorIconPlaceHolder").setId("validator icon placeholder");this.addControl(b);a.addCssClass("BValidatorDecorated");this.controlToValidate=a;this.addControl(a);this.infoPlaceHolder=(new Banana.Controls.Panel).addCssClass("BValidatorInfoPlaceHolder");this.addControl(this.infoPlaceHolder);
this.star=(new Banana.Controls.Panel).setId("validator star");this.star.addCssClass("BValidatorStar");this.getInfoText()&&this.star.setAttribute("title",this.getInfoText());b.addControl(this.star);this.arrow=(new Banana.Controls.Panel).setId("validator arrow");this.arrow.addCssClass("BValidatorArrow");this.infoPlaceHolder.addControl(this.arrow);this.info=(new Banana.Controls.Panel).addCssClass("BValidatorInfo").setId("validator info placeholder");this.infoPlaceHolder.addControl(this.info);Banana.Util.ValidationManager.addValidator(this);
return this},createComponents:function(){this.info.setVisible(!1);this.arrow.setVisible(!1);this.createLabelText();this.star.setVisible(this.showIndicator);this.validateOnEventType?this.controls[1].bind(this.validateOnEventType,this.getProxy(this.isValid)):(this.controls[1].bind("dataChanged",this.getProxy(this.isValid)),this.controls[1].bind("focusout",this.getProxy(function(){})))},unload:function(){this._super();Banana.Util.ValidationManager.removeValidator(this)},createLabelText:function(){this.labelText||
(this.labelText=new Banana.Controls.Label,this.labelText.addCssClass("BValidatorLabel"),this.info.addControl(this.labelText));this.labelText.setData(this.getInfoText())},showIndicators:function(){this.info.setVisible(!0);this.arrow.setVisible(!0)},hideIndicators:function(){this.info.setVisible(!1);this.arrow.setVisible(!1)},setShowIndicator:function(a){this.showIndicator=a;return this},setValidateOnEventType:function(a){this.validateOnEventType=a;return this},getValidatedControl:function(){return this.controlToValidate},
updateDisplay:function(){this.orgBorder=this.controls[1].getStyleProperty("border")},markInvalid:function(a){this.markedInvalid=!0;a&&(this.oldInfoText=this.infoText,this.infoText=a);this.isValid();return this},removeMarkInvalid:function(){this.markedInvalid=void 0;this.oldInfoText&&(this.infoText=this.oldInfoText);this.isValid()},isValid:function(){if(!this.controls)return!1;var a=this.controls[1];if(!a.enabled)return!0;var b;b=this.markedInvalid?!1:this.validateData(a.getData(!0));if(!1==b)return this.createLabelText(),
a.addCssClass("BValidatorControlInvalidated"),a.removeCssClass("BValidatorControlValidated"),this.showIndicators(),!1;if(!0==b)return a.removeCssClass("BValidatorControlInvalidated"),a.addCssClass("BValidatorControlValidated"),this.hideIndicators(),!0},validateData:function(){return!0},getInfoText:function(){return this.infoText||""},setInfoText:function(a){this.infoText=a;return this},setValidationGroup:function(a){this.validationGroup=a;return this},getValidationGroup:function(){return this.validationGroup},
getData:function(){return this.controls[1].getData()},setData:function(a,b,d){this.controls[1].setData(a,b,d);return this},getHtml:function(){for(var a=[],b=this.getControls(),d=0,e=b.length;d<e;d++)b[d]instanceof Banana.Control?a.push(b[d].getHtml()):"string"==typeof b[d]&&a.push(b[d]);return a.join("")}});Banana.Controls.Decorators.TimecodeFieldValidator={};
namespace("Banana.Controls.Decorators").TimecodeFieldValidator=Banana.Controls.Decorators.Validator.extend({init:function(a){this._super(a);this.showIndicator=!1},setRequired:function(a){this.showIndicator=this.required=a;return this},validateData:function(a){return!a&&!this.required?!0:!a?!1:a.match(/^((0?[1-9]|[12][0-9]|3[01])[\- \/.](0?[1-9]|1[012])[\- \/.](19|20)?[0-9]{2})? ?((2[0-3]|[0-1][0-9]):(5[0-9]|[0-4][0-9]):(5[0-9]|[0-4][0-9])(:(2[0-4]|[0-1][0-9]))?)?$/)?!0:!1},getInfoText:function(){return"Valid timecode required"}});Banana.Controls.Decorators.RequiredFieldValidator={};namespace("Banana.Controls.Decorators").RequiredFieldValidator=Banana.Controls.Decorators.Validator.extend({init:function(a){this._super(a);this.setInfoText("Field required")},validateData:function(a){if(a instanceof Array)return 0<a.length?!0:!1;if(null==a||void 0==a)return!1;a=a.toString();return/^\s*$/.test(a)?!1:!0}});Banana.Controls.Decorators.RegExValidator={};namespace("Banana.Controls.Decorators").RegExValidator=Banana.Controls.Decorators.Validator.extend({init:function(a){this._super(a)},validateData:function(a){var b=RegExp(this.regExString);return a&&a.match(b)?!0:!1},setRegExString:function(a){this.regExString=a;return this}});Banana.Controls.Decorators.CharLimitFieldValidator={};namespace("Banana.Controls.Decorators").CharLimitFieldValidator=Banana.Controls.Decorators.Validator.extend({init:function(a){this._super(a);this.showIndicator=!1},validateData:function(a){return!a?!0:a.length<=this.maxChars},setMaxChars:function(a){this.maxChars=a;return this},getInfoText:function(){return this.infoText||"Max "+this.maxChars+" chars"}});Banana.Controls.Decorators.LabelDecorator={};
namespace("Banana.Controls.Decorators").LabelDecorator=Banana.Controls.Decorators.Decorator.extend({init:function(a){this._super(a);this.customControl=a;this.customControl.addCssClass("BLabelDecoratedControl");this.addCssClass("BLabelDecorator");this.label=(new Banana.Controls.Label).addCssClass("BLabelDecoratorLabel");this.position="left";this.addControl(this.label);this.addControl(a);a.bind("onSetVisible",this.getProxy(this.onSetVisible))},onSetVisible:function(a,b){this.setVisible(b)},updateDisplay:function(){this._super();
this.label.setForControl(this.customControl)},setLabelCss:function(a){this.label.setCss(a);return this},setData:function(a){this.label.setData(a);return this},getData:function(){return this.label.getData()}});Banana.Controls.Decorators.LabelDecoratorRight={};
namespace("Banana.Controls.Decorators").LabelDecoratorRight=Banana.Controls.Decorators.Decorator.extend({init:function(a){this._super(a);this.addCssClass("BLabelDecoratorRight");this.customControl=a;this.label=new Banana.Controls.Label;this.position="left";this.label.addCssClass("BLabelDecoratorRightLabel");this.addControl(a);this.addControl(this.label);a.bind("onSetVisible",this.getProxy(this.onSetVisible))},onSetVisible:function(a,b){this.setVisible(b)},updateDisplay:function(){this._super();this.label.setForControl(this.customControl)},
setLabelCss:function(a){this.label.setCss(a);return this},setData:function(a){this.label.setData(a);return this},getData:function(){return this.label.getData()}});Banana.Controls.Decorators.InfoDecorator={};
namespace("Banana.Controls.Decorators").InfoDecorator=Banana.Controls.Decorators.Decorator.extend({init:function(a){this._super(a);this.addCssClass("BInfoDecorator");this.infoImage=(new Banana.Controls.Image).addCssClass("BInfoDecoratorInfoImage");this.infoImage.setImage("banana/images/infodot.png");this.addControl(this.infoImage);this.addControl(a);a.bind("onSetVisible",this.getProxy(this.onSetVisible))},onSetVisible:function(a,b){this.setVisible(b)},setText:function(a){this.infoImage.setAttribute("title",a);
return this}});Banana.Controls.Decorators.EqualValidator={};
namespace("Banana.Controls.Decorators").EqualValidator=Banana.Controls.Decorators.Validator.extend({init:function(a){this._super(a);this.setInfoText("Fields should be equal")},setControlIdToMatch:function(a){this.controlIdToMatch=a;return this},setControlToMatch:function(a){this.controlIdToMatch=a.id;return this},validateData:function(a){if(control=this.getPage().findControl(this.controlIdToMatch))return a===control.getData()?!0:!1;log.error("Control "+this.getDecoratedControl().id+" Doesnt have control defined to check equality on")}});Banana.Controls.HBox={};
namespace("Banana.Control").HBox=Banana.Controls.Panel.extend({init:function(){this._super();this.setStyle("width:100%;position:relative;")},setSpacing:function(a){this.spacing=a;return this},updateDisplay:function(){this._super();for(var a=this.controls.length,b=this.getDemensions().width/a,d=0,e=a;d<e;d++){var f=this.controls[d];f.getDemensions();this.getDemensions()}b-=12;d=0;for(e=a;d<e;d++)f=this.controls[d],0!=d?f.setCss({width:b+"px","float":"left","margin-left":this.spacing+"px"}):f.setCss({width:b+
"px","float":"left"})}});Banana.Controls.VBox={};
namespace("Banana.Controls").VBox=Banana.Controls.Panel.extend({init:function(){this._super();this.spacing=0},setSpacing:function(a){this.spacing=a;return this},updateDisplay:function(){this._super();for(var a=0,b=this.controls.length;a<b;a++){var d=this.controls[a];d instanceof Banana.Control&&("none"==d.getStyleProperty("float")?d.setCss({clear:"both","float":"",width:"100%"}):d.setCss({clear:"both","float":""}),a<this.controls.length&&d.setCss({"margin-bottom":this.spacing+"px"}))}}});Array.prototype.indexOf||(Array.prototype.indexOf=function(a,b){var d,e;d=b||0;for(e=this.length;d<e;d++)if(this[d]===a)return d;return-1});namespace("Banana.Controls").EventTypes={DOM_EVENT:1,CUSTOM_EVENT:2};
namespace("Banana").Application=Banana.Control.extend({init:function(a){log=new Banana.Util.LogManager;log.addLogger(new Banana.Util.Logger.Console);log.setLevel("error",!0);log.setLevel("warning",!0);try{jQuery()}catch(b){log.error("JQuery is not found. JQuery required.")}a||(a={});this.settings=a;this.sectionVerticalScrollPosition={};this.id=0;a.applicationName?namespace("Banana")[a.applicationName]=this:namespace("Banana").Application=this;a.pageTemplate||(a.pageTemplate="PageTemplate");a.paths||
(a.paths={});a.paths.pages||(a.paths.pages="Application.Pages");this.prepareUnload()},prepareUnload:function(){jQuery(window).unload(this.getProxy(function(){jQuery("*").unbind();this.activePage&&this.activePage.remove();this.pageTemplate&&this.pageTemplate.remove();delete Banana}))},loadPageTemplate:function(){if(this.settings.paths.pageTemplates)var a=this.settings.paths.pageTemplates+"."+this.settings.pageTemplate,b=Banana.Util.NamespaceToFunction(a);else b=Banana.PageTemplate;if(b)try{this.pageTemplate=
new b}catch(d){log.error("Error: could not instantiate template: "+a)}else log.error("Error: could not find Template: "+a)},getSettings:function(){return this.settings},setSectionVerticalScrollPosition:function(a){this.sectionVerticalScrollPosition[a]=window.scrollY},getSectionVerticalScrollPosition:function(a){return this.sectionVerticalScrollPosition[a]},loadPage:function(a,b,d){Banana.Util.UrlManager.saveModuleHistory("section");this.setSectionVerticalScrollPosition(this.section);Banana.Util.UrlManager.clearUrl();
if(this.loadingWithHistory=!d){var e=Banana.Util.UrlManager.getModuleHistory(a),f;for(f in e)e.hasOwnProperty(f)&&(Banana.Util.UrlManager.registerModule(f),Banana.Util.UrlManager.setModule(f,e[f],!0))}if(b)for(var g in b)b.hasOwnProperty(g)&&(Banana.Util.UrlManager.registerModule(g),Banana.Util.UrlManager.setModule(g,b[g],!0));this.run(a);d||window.scrollTo(0,this.getSectionVerticalScrollPosition(a)||0)},instantiateSinglePage:function(){this.pageTemplate||this.loadPageTemplate();this.page.bind("renderComplete",
this.getProxy(function(){this.activePage&&(this.activePage.removeDom(),this.activePage.clearProps(),this.activePage=void 0);this.activePage=this.page;this.activePage.setVisible(!0)}));this.page.setVisible(!1);this.pageTemplate.addPageControl(this.page);this.pageTemplate.setApplication(this);this.pageTemplate.run(this)},run:function(a){a&&(this.page=a);if(a instanceof Banana.Page)return this.instantiateSinglePage();this.triggerEvent("onPreLoadPage");this.activePage||Banana.Util.UrlManager.autoRegisterModules();
this.pageTemplate||this.loadPageTemplate();var b=this.page||Banana.Util.UrlManager.getModule("section")||this.settings.defaultSection;this.section=b;this.page=void 0;this.registerUrlSection(b);this.loadingWithHistory||Banana.Util.UrlManager.updateUrl();var d=this.getProxy(function(){var a=Banana.Util.NamespaceToFunction(this.settings.paths.pages+"."+b);if(!a){if(this.settings.defaultSection===b){log.error("Error default page "+this.settings.defaultSection+" cannot be loaded");return}log.error("Page "+
b+" not found. Load default page "+this.settings.defaultSection);return this.loadPage(this.settings.defaultSection)}this.id++;var d=new a;d.bind("renderComplete",this.getProxy(function(){this.activePage&&(this.activePage.removeDom(),this.activePage.clearProps(),this.activePage=void 0);this.activePage=d;this.activePage.setVisible(!0)}));d.setVisible(!1);this.pageTemplate.addPageControl(d);this.pageTemplate.setApplication(this);this.pageTemplate.run();Banana.Util.UrlManager.updateUrl()});this.activePage?
(Banana.Util.UrlManager.stopChecking(),this.activePage.remove(!0,this.getProxy(function(){Banana.Util.UrlManager.startChecking();d();Banana.Util.UrlManager.listenModule("section",this.getProxy(function(){this.loadPage(Banana.Util.UrlManager.getModule("section"))}))}))):(d(),Banana.Util.UrlManager.listenModule("section",this.getProxy(function(){this.loadPage(Banana.Util.UrlManager.getModule("section"))})))},registerUrlSection:function(a){Banana.Util.UrlManager.registerModule("section",a);Banana.Util.UrlManager.setModule("section",
a,!0)}});Banana.App=Banana.Application;var Application={Pages:{}};Application.Pages.PageTemplates={};Application.Pages.PageTemplates.PageTemplate={};namespace("Application.Pages.PageTemplates").PageTemplate=Banana.PageTemplate.extend({createComponents:function(){this.addControl(this.content)}});Application.Pages.Home={};namespace("Application.Pages").Home=Banana.Page.extend({init:function(){this._super()},createComponents:function(){this.addControl("Banana works")},updateDisplay:function(){}});
